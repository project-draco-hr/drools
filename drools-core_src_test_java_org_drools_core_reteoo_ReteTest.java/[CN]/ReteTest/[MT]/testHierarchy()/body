{
  StatefulKnowledgeSessionImpl ksession=(StatefulKnowledgeSessionImpl)kBase.newStatefulKnowledgeSession();
  final Rete rete=kBase.getRete();
  final IdGenerator idGenerator=kBase.getReteooBuilder().getIdGenerator();
  final ObjectTypeNode listOtn=new ObjectTypeNode(idGenerator.getNextId(),this.entryPoint,new ClassObjectType(List.class),buildContext);
  listOtn.attach(buildContext);
  FactHandle handle=ksession.insert(new ArrayList());
  assertEquals(3,rete.getObjectTypeNodes().size());
  assertSame(listOtn,rete.getObjectTypeNodes(EntryPointId.DEFAULT).get(new ClassObjectType(List.class)));
  ClassObjectTypeConf arrayConf=(ClassObjectTypeConf)ksession.getObjectTypeConfigurationRegistry().getObjectTypeConf(this.entryPoint.getEntryPoint(),new ArrayList());
  final ObjectTypeNode arrayOtn=arrayConf.getConcreteObjectTypeNode();
  assertEquals(2,arrayConf.getObjectTypeNodes().length);
  List nodes=Arrays.asList(arrayConf.getObjectTypeNodes());
  assertEquals(2,nodes.size());
  assertTrue(nodes.contains(arrayOtn));
  assertTrue(nodes.contains(listOtn));
  ksession.retract(handle);
  final MockObjectSink listSink=new MockObjectSink();
  listOtn.addObjectSink(listSink);
  final MockObjectSink arraySink=new MockObjectSink();
  listOtn.addObjectSink(arraySink);
  ksession.insert(new ArrayList());
  assertEquals(1,listSink.getAsserted().size());
  assertEquals(1,arraySink.getAsserted().size());
  final ObjectTypeNode collectionOtn=new ObjectTypeNode(idGenerator.getNextId(),this.entryPoint,new ClassObjectType(Collection.class),buildContext);
  final MockObjectSink collectionSink=new MockObjectSink();
  collectionOtn.addObjectSink(collectionSink);
  collectionOtn.attach(new TestBuildContext(kBase));
  assertEquals(1,collectionSink.getAsserted().size());
  nodes=Arrays.asList(arrayConf.getObjectTypeNodes());
  assertEquals(3,nodes.size());
  assertTrue(nodes.contains(arrayOtn));
  assertTrue(nodes.contains(listOtn));
  assertTrue(nodes.contains(collectionOtn));
}
