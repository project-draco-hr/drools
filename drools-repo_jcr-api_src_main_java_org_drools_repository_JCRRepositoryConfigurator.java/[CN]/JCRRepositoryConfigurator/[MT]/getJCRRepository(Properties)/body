{
  try {
    String jcrImplementationClass=properties.getProperty(JCR_IMPL_CLASS);
    if (jcrImplementationClass == null) {
      jcrImplementationClass=defaultJCRImplClass;
    }
    Class jcrFactory=ClassUtil.forName(jcrImplementationClass,this.getClass());
    RepositoryFactory factory=(RepositoryFactory)jcrFactory.newInstance();
    Repository repo=factory.getRepository(properties);
    this.factory=factory;
    return repo;
  }
 catch (  Exception re) {
    throw new RepositoryException(re);
  }
}
