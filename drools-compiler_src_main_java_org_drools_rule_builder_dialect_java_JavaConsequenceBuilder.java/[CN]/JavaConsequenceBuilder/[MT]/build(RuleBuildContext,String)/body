{
  context.getBuildStack().push(context.getRule().getLhs());
  final String className=consequenceName + "Consequence";
  Map<String,Declaration> decls=context.getDeclarationResolver().getDeclarations(context.getRule());
  JavaAnalysisResult analysis=createJavaAnalysisResult(context,consequenceName,decls);
  if (analysis == null) {
    return;
  }
  List<JavaBlockDescr> blocks=new ArrayList<JavaBlockDescr>();
  buildBlockDescrs(blocks,analysis.getBlockDescrs());
  String fixedConsequence=this.fixBlockDescr(context,analysis.getAnalyzedExpr(),blocks,analysis.getBoundIdentifiers(),decls);
  if (fixedConsequence == null) {
    return;
  }
  fixedConsequence=((JavaDialect)context.getDialect()).getKnowledgeHelperFixer().fix(fixedConsequence);
  Map<String,Object> map=createConsequenceContext(context,consequenceName,className,fixedConsequence,decls,analysis.getBoundIdentifiers());
  generatTemplates("consequenceMethod","consequenceInvoker",context,className,map,context.getRule(),context.getRuleDescr());
  context.getBuildStack().pop();
}
