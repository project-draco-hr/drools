{
  String interfaceName=BusinessRuleProvider.class.getName();
  try {
    URL systemResource=null;
    for (Enumeration<URL> systemResources=ClassLoader.getSystemResources("META-INF/services/" + interfaceName); systemResources.hasMoreElements(); ) {
      if (null != systemResource)       throwMultipleImplementationsDetected();
      systemResource=systemResources.nextElement();
    }
    if (systemResource == null) {
      throwNoImplementationFound();
    }
    BufferedReader reader=new BufferedReader(new InputStreamReader(systemResource.openStream()));
    String className=null;
    for (String currentName; (currentName=reader.readLine()) != null; ) {
      if (className != null) {
        throwMultipleImplementationsDetected();
      }
      className=currentName;
    }
    if (null == className) {
      throwNoImplementationFound();
    }
    ServiceRegistryImpl.getInstance().addDefault(BusinessRuleProvider.class,className);
    return ServiceRegistryImpl.getInstance().get(BusinessRuleProvider.class);
  }
 catch (  IOException e) {
    throw new CheckedDroolsException("Error obtaining " + interfaceName,e);
  }
}
