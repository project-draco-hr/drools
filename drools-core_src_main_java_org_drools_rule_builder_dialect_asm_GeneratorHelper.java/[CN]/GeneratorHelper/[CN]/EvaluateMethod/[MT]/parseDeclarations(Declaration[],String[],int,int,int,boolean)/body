{
  int[] declarationsParamsPos=new int[declarations.length];
  for (int i=0; i < declarations.length; i++) {
    declarationsParamsPos[i]=objAstorePos;
    mv.visitVarInsn(ALOAD,declarReg);
    push(i);
    mv.visitInsn(AALOAD);
    mv.visitVarInsn(ALOAD,wmReg);
    cast(InternalWorkingMemory.class);
    if (readLocalsFromTuple) {
      mv.visitVarInsn(ALOAD,tupleReg);
      mv.visitVarInsn(ALOAD,declarReg);
      push(i);
      mv.visitInsn(AALOAD);
      invokeInterface(Tuple.class,"get",InternalFactHandle.class,Declaration.class);
      invokeInterface(InternalFactHandle.class,"getObject",Object.class);
    }
 else {
      mv.visitVarInsn(ALOAD,1);
    }
    String readMethod=declarations[i].getNativeReadMethod().getName();
    boolean isObject=readMethod.equals("getValue");
    String returnedType=isObject ? "Ljava/lang/Object;" : typeDescr(declarationTypes[i]);
    mv.visitMethodInsn(INVOKEVIRTUAL,"org/drools/rule/Declaration",readMethod,"(Lorg/drools/common/InternalWorkingMemory;Ljava/lang/Object;)" + returnedType);
    if (isObject) {
      mv.visitTypeInsn(CHECKCAST,internalName(declarationTypes[i]));
    }
    objAstorePos+=store(objAstorePos,declarationTypes[i]);
  }
  return declarationsParamsPos;
}
