{
  AnalyticsData data=AnalyticsDataFactory.getAnalyticsData();
  Field field=data.getFieldByClassAndFieldName(currentClass.getName(),descr.getFieldName());
  if (field == null) {
    field=createField(descr.getFieldName(),descr.getLine(),currentClass.getId(),currentClass.getName());
    data.save(field);
  }
  currentField=field;
  Constraint constraint=new Constraint();
  constraint.setRuleId(currentRule.getId());
  constraint.setFieldId(currentField.getId());
  constraint.setPatternId(currentPattern.getId());
  constraint.setPatternIsNot(currentPattern.isPatternNot());
  constraint.setFieldId(field.getId());
  data.save(constraint);
  currentConstraint=constraint;
  flatten(descr.getRestriction());
}
