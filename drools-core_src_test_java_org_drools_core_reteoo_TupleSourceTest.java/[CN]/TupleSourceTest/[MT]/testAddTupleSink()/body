{
  final MockTupleSource source=new MockTupleSource(15);
  final Field field=LeftTupleSource.class.getDeclaredField("sink");
  field.setAccessible(true);
  LeftTupleSinkPropagator sink=(LeftTupleSinkPropagator)field.get(source);
  assertSame(EmptyLeftTupleSinkAdapter.getInstance(),sink);
  final MockLeftTupleSink sink1=new MockLeftTupleSink();
  source.addTupleSink(sink1);
  sink=(LeftTupleSinkPropagator)field.get(source);
  assertSame(SingleLeftTupleSinkAdapter.class,sink.getClass());
  assertEquals(1,sink.getSinks().length);
  final MockLeftTupleSink sink2=new MockLeftTupleSink();
  source.addTupleSink(sink2);
  sink=(LeftTupleSinkPropagator)field.get(source);
  assertSame(CompositeLeftTupleSinkAdapter.class,sink.getClass());
  assertEquals(2,sink.getSinks().length);
  final MockLeftTupleSink sink3=new MockLeftTupleSink();
  source.addTupleSink(sink3);
  assertSame(CompositeLeftTupleSinkAdapter.class,sink.getClass());
  assertEquals(3,sink.getSinks().length);
  source.removeTupleSink(sink2);
  assertSame(CompositeLeftTupleSinkAdapter.class,sink.getClass());
  assertEquals(2,sink.getSinks().length);
  source.removeTupleSink(sink1);
  sink=(LeftTupleSinkPropagator)field.get(source);
  assertSame(SingleLeftTupleSinkAdapter.class,sink.getClass());
  assertEquals(1,sink.getSinks().length);
  source.removeTupleSink(sink3);
  sink=(LeftTupleSinkPropagator)field.get(source);
  assertSame(EmptyLeftTupleSinkAdapter.getInstance(),sink);
  assertEquals(0,sink.getSinks().length);
}
