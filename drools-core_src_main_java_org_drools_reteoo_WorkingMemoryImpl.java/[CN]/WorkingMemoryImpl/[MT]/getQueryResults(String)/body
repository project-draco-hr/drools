{
  FactHandle handle=assertObject(new DroolsQuery(query));
  QueryTerminalNode node=(QueryTerminalNode)this.queryResults.remove(query);
  if (node == null) {
    retractObject(handle);
    return null;
  }
  List list=(List)this.nodeMemories.remove(node.getId());
  retractObject(handle);
  if (list == null) {
    list=Collections.EMPTY_LIST;
  }
  return new QueryResults(list,(Query)node.getRule(),this);
}
