{
  if (shouldTryAtomicUpgrade && tryingLockUpgrade.get()) {
synchronized (lowPriotityMonitor) {
      try {
        lowPriotityMonitor.wait();
      }
 catch (      InterruptedException e) {
        throw new RuntimeException(e);
      }
    }
  }
  lock.writeLock().lock();
}
