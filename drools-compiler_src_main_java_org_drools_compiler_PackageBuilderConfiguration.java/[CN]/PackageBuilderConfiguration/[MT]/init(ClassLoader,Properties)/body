{
  if (classLoader == null) {
    classLoader=Thread.currentThread().getContextClassLoader();
    if (classLoader == null) {
      classLoader=this.getClass().getClassLoader();
    }
  }
  setClassLoader(classLoader);
  this.chainedProperties=new ChainedProperties(this.classLoader,"packagebuilder.conf");
  if (properties != null) {
    this.chainedProperties.addProperties(properties);
  }
  this.dialects=new HashMap();
  this.chainedProperties.mapStartsWith(this.dialects,"drools.dialect",false);
  setDefaultDialect((String)this.dialects.remove("drools.dialect.default"));
  this.dialectRegistry=buildDialectRegistry();
  buildAccumulateFunctionsMap();
}
