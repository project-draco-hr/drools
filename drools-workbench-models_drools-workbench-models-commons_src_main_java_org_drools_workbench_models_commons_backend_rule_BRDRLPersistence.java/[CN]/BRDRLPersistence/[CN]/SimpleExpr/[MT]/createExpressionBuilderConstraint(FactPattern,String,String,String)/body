{
  int dotPos=fieldName.lastIndexOf('.');
  SingleFieldConstraint con=createSingleFieldConstraint(dotPos > 0 ? fieldName.substring(dotPos + 1) : fieldName,operator,value);
  for (  FieldConstraint fieldConstraint : factPattern.getFieldConstraints()) {
    if (fieldConstraint instanceof SingleFieldConstraint) {
      SingleFieldConstraint sfc=(SingleFieldConstraint)fieldConstraint;
      if (sfc.getOperator().equals("!= null")) {
        int parentPos=fieldName.indexOf(sfc.getFieldName() + ".");
        if (parentPos >= 0 && !fieldName.substring(parentPos + sfc.getFieldName().length() + 1).contains(".")) {
          con.setParent(sfc);
          break;
        }
      }
    }
  }
  if (con.getParent() == null) {
    con.setParent(createParentFor(factPattern,fieldName));
  }
  return con;
}
