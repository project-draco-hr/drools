{
  for (  Declaration declaration : declarations) {
    if (localDeclarations == null || !localDeclarations.contains(declaration)) {
      InternalFactHandle fact=tuple.get(declaration);
      if (fact != null) {
        vars.put(declaration.getBindingName(),declaration.getExtractor().getValue(workingMemory,fact.getObject()));
      }
 else {
        if (localDeclarations == null) {
          localDeclarations=new ArrayList<Declaration>();
        }
        localDeclarations.add(declaration);
      }
    }
  }
  return vars;
}
