{
  ResourceChangeScannerConfiguration sconf=ResourceFactory.getResourceChangeScannerService().newResourceChangeScannerConfiguration();
  sconf.setProperty("drools.resource.scanner.interval","2");
  ResourceFactory.getResourceChangeScannerService().configure(sconf);
  KnowledgeAgentConfiguration aconf=KnowledgeAgentFactory.newKnowledgeAgentConfiguration();
  aconf.setProperty("drools.agent.scanDirectories","true");
  aconf.setProperty("drools.agent.scanResources","true");
  aconf.setProperty("drools.agent.newInstance","" + newInstance);
  aconf.setProperty("drools.agent.useKBaseClassLoaderForCompiling","" + useKBaseClassLoaderForCompiling);
  KnowledgeAgent kagent=KnowledgeAgentFactory.newKnowledgeAgent("test agent",kbase,aconf,builderConf);
  kagent.setSystemEventListener(new SystemEventListener(){
    public void info(    String message){
    }
    public void info(    String message,    Object object){
    }
    public void warning(    String message){
      kagentWarnings.add(message);
    }
    public void warning(    String message,    Object object){
      kagentWarnings.add(message);
    }
    public void exception(    String message,    Throwable e){
    }
    public void exception(    Throwable e){
    }
    public void debug(    String message){
    }
    public void debug(    String message,    Object object){
    }
  }
);
  assertEquals("test agent",kagent.getName());
  return kagent;
}
