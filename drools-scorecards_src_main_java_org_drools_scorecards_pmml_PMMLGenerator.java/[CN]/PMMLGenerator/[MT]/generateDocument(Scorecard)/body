{
  removeEmptyExtensions(pmmlScorecard);
  createAndSetPredicates(pmmlScorecard);
  createAndSetOutput(pmmlScorecard);
  repositionExternalClassExtensions(pmmlScorecard);
  Extension scorecardPackage=ScorecardPMMLUtils.getExtension(pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas(),PMMLExtensionNames.SCORECARD_PACKAGE);
  if (scorecardPackage != null) {
    pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas().remove(scorecardPackage);
  }
  Extension importsExt=ScorecardPMMLUtils.getExtension(pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas(),PMMLExtensionNames.SCORECARD_IMPORTS);
  if (importsExt != null) {
    pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas().remove(importsExt);
  }
  PMML pmml=new PMML();
  Header header=new Header();
  Timestamp timestamp=new Timestamp();
  timestamp.getContent().add(new SimpleDateFormat("yyyy.MM.dd 'at' HH:mm:ss z").format(new Date()));
  header.setTimestamp(timestamp);
  header.setDescription("generated by the drools-scorecards module");
  header.getExtensions().add(scorecardPackage);
  header.getExtensions().add(importsExt);
  pmml.setHeader(header);
  createAndSetDataDictionary(pmml,pmmlScorecard);
  pmml.getAssociationModelsAndBaselineModelsAndClusteringModels().add(pmmlScorecard);
  removeAttributeFieldExtension(pmmlScorecard);
  return pmml;
}
