{
  byte[] bytes=pm.getSnapshot();
  if (this.list.isEmpty() && this.nestedSavePointsAllowed) {
    pm.setLastSave(bytes);
  }
  if (this.nestedSavePointsAllowed || this.list.isEmpty()) {
    this.list.add(xid);
    this.data.put(xid,bytes);
  }
}
