{
  this.listener.debug("KnowledgeAgent rebuilding KnowledgeBase using ChangeSet");
synchronized (this.registeredResources) {
    if (this.newInstance) {
      rebuildResources(changeSetState);
    }
 else {
      incrementalBuildResources(changeSetState);
    }
    InternalRuleBase ruleBase=(InternalRuleBase)((KnowledgeBaseImpl)this.kbase).ruleBase;
    ruleBase.lock();
    try {
      if (ruleBase.getConfiguration().isSequential()) {
        ruleBase.getReteooBuilder().order();
      }
    }
  finally {
      ruleBase.unlock();
    }
  }
  this.eventSupport.fireKnowledgeBaseUpdated(this.kbase);
  this.listener.debug("KnowledgeAgent finished rebuilding KnowledgeBase using ChangeSet");
}
