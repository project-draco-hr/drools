{
  if (!this.newInstance) {
    listener.warning("KnowledgeAgent rebuilding KnowledgeBase when newInstance is false");
  }
  if (this.kbase != null) {
    this.kbase=KnowledgeBaseFactory.newKnowledgeBase(((InternalRuleBase)((KnowledgeBaseImpl)this.kbase).ruleBase).getConfiguration());
  }
 else {
    this.kbase=KnowledgeBaseFactory.newKnowledgeBase();
  }
  changeSetState.addedResources.clear();
  for (  Resource resource : this.registeredResources.getAllResources()) {
    if (!(resource instanceof ReaderResource) || ((ReaderResource)resource).getReader() != null) {
      changeSetState.addedResources.add(resource);
    }
  }
  addResourcesToKnowledgeBase(changeSetState);
  this.listener.info("KnowledgeAgent new KnowledgeBase now built and in use");
}
