{
  PackageBuilder pkgBuilder=new PackageBuilder();
  pkgBuilder.addPackageFromDrl(new InputStreamReader(DroolsSmookStatefulSessionTest.class.getResourceAsStream("test_SmooksDirectRoot.drl")));
  assertFalse(pkgBuilder.hasErrors());
  RuleBase ruleBase=RuleBaseFactory.newRuleBase();
  ruleBase.addPackage(pkgBuilder.getPackage());
  StatefulSession session=ruleBase.newStatefulSession();
  List list=new ArrayList();
  session.setGlobal("list",list);
  Smooks smooks=new Smooks(getClass().getResourceAsStream("smooks-config.xml"));
  DroolsSmooksConfiguration conf=new DroolsSmooksConfiguration("orderItem",null);
  DroolsSmooksStatefulSession dataLoader=new DroolsSmooksStatefulSession(session,smooks,conf);
  Map<FactHandle,Object> handles=dataLoader.insertFilter(new StreamSource(getClass().getResourceAsStream("SmooksDirectRoot.xml")));
  session.fireAllRules();
  assertEquals(1,handles.size());
  assertEquals(1,list.size());
  assertEquals("example.OrderItem",list.get(0).getClass().getName());
}
