{
  final Configuration config=parser.endConfiguration();
  final RuleDescr ruleDescr=(RuleDescr)parser.getCurrent();
  final AndDescr lhs=ruleDescr.getLhs();
  if (lhs == null) {
    throw new SAXParseException("<rule> requires a LHS",parser.getLocator());
  }
  final Configuration rhs=config.getChild("rhs");
  if (rhs == null) {
    throw new SAXParseException("<rule> requires a <rh> child element",parser.getLocator());
  }
  ruleDescr.setConsequence(rhs.getText());
  final Configuration[] attributes=config.getChildren("rule-attribute");
  for (int i=0, length=attributes.length; i < length; i++) {
    final String name=attributes[i].getAttribute("name");
    emptyAttributeCheck("rule-attribute","name",name,parser);
    final String value=attributes[i].getAttribute("value");
    ruleDescr.addAttribute(new AttributeDescr(name,value));
  }
  ((PackageDescr)parser.getData()).addRule(ruleDescr);
  return ruleDescr;
}
