{
  URLClassLoader projectClassLoader=null;
  try {
    projectClassLoader=new URLClassLoader(new URL[]{outputDirectory.toURI().toURL()});
  }
 catch (  MalformedURLException e) {
    throw new RuntimeException(e);
  }
  KnowledgeBuilderConfiguration kConf=KnowledgeBuilderFactory.newKnowledgeBuilderConfiguration(null,projectClassLoader);
  KnowledgeContainerImpl kbuilder=(KnowledgeContainerImpl)KnowledgeContainerFactory.newKnowledgeContainer(kConf);
  for (  KBaseUnit kBaseUnit : kbuilder.getKBaseUnits(rootFolder,sourceFolder)) {
    if (kBaseUnit.hasErrors()) {
      throw new MojoFailureException(kBaseUnit.getKBaseName() + " build failed!");
    }
    getLog().info(kBaseUnit.getKBaseName() + " correctly built!");
  }
  copyKBasesToOutput(rootFolder,outputDirectory);
}
