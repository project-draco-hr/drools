{
  RightTupleMemory rtm=bm.getRightTupleMemory();
  boolean resumeFromCurrent=!(betaNode.isIndexedUnificationJoin() || rtm.getIndexType().isComparison());
  for (RightTuple rightTuple=srcRightTuples.getUpdateFirst(); rightTuple != null; ) {
    RightTuple next=rightTuple.getStagedNext();
    if (rightTuple.getMemory() != null) {
      if (resumeFromCurrent) {
        rightTuple.setTempRightTupleMemory(rightTuple.getMemory());
        RightTuple tempRightTuple=rightTuple.getBlocked() != null ? (RightTuple)rightTuple.getPrevious() : null;
        while (tempRightTuple != null && tempRightTuple.getStagedType() != LeftTuple.NONE) {
          tempRightTuple=(RightTuple)tempRightTuple.getPrevious();
        }
        rightTuple.setTempNextRightTuple(tempRightTuple);
      }
      rtm.remove(rightTuple);
    }
    rightTuple=next;
  }
  for (RightTuple rightTuple=srcRightTuples.getUpdateFirst(); rightTuple != null; ) {
    RightTuple next=rightTuple.getStagedNext();
    if (rightTuple.getTempRightTupleMemory() != null) {
      rtm.add(rightTuple);
      if (resumeFromCurrent) {
        RightTuple tempRightTuple=rightTuple.getTempNextRightTuple();
        if (tempRightTuple == null && rightTuple.getMemory() == rightTuple.getTempRightTupleMemory()) {
          tempRightTuple=rightTuple;
        }
        rightTuple.setTempNextRightTuple(tempRightTuple);
      }
      for (LeftTuple childLeftTuple=rightTuple.getFirstChild(); childLeftTuple != null; ) {
        LeftTuple childNext=childLeftTuple.getRightParentNext();
        childLeftTuple.reAddLeft();
        childLeftTuple=childNext;
      }
    }
    rightTuple=next;
  }
}
