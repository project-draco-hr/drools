{
  BetaNode betaNode=(BetaNode)node;
  BetaMemory bm=null;
  AccumulateMemory am=null;
  if (NodeTypeEnums.AccumulateNode == node.getType()) {
    am=(AccumulateMemory)nodeMem;
    bm=am.getBetaMemory();
  }
 else {
    bm=(BetaMemory)nodeMem;
  }
  if (processRian && betaNode.isRightInputIsRiaNode()) {
    doRiaNode(wm,liaNode,pmem,srcTuples,betaNode,sink,smems,smemIndex,nodeMem,bm,stack,outerStack,visitedRules,executor);
    return true;
  }
  if (stagedLeftTuples != null) {
synchronized (stagedLeftTuples) {
      switchOnDoBetaNode(node,trgTuples,wm,srcTuples,stagedLeftTuples,sink,bm,am);
    }
  }
 else {
    switchOnDoBetaNode(node,trgTuples,wm,srcTuples,stagedLeftTuples,sink,bm,am);
  }
  return false;
}
