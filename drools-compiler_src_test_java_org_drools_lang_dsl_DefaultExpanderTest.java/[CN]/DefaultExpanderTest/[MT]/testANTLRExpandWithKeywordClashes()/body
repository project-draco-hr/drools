{
  DSLTokenizedMappingFile file=new DSLTokenizedMappingFile();
  String dsl="[when]Invoke rule executor=ruleExec: RuleExecutor()\n" + "[then]Execute rule \"{id}\"=ruleExec.ExecuteSubRule( new Long({id}));";
  file.parseAndLoad(new StringReader(dsl));
  assertEquals(0,file.getErrors().size());
  DefaultExpander ex=new DefaultExpander();
  ex.addDSLMapping(file.getMapping());
  String source="package something;\n\nrule \"1\"\nwhen\n    Invoke rule executor\nthen\n    Execute rule \"5\"\nend";
  String expected="package something;\n\nrule \"1\"\nwhen\n    ruleExec: RuleExecutor() \nthen\n    ruleExec.ExecuteSubRule( new Long(5)); \nend\n";
  String drl=ex.expand(source);
  assertFalse(ex.hasErrors());
  assertEquals(expected,drl);
}
