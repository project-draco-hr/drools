{
  if (!isBuilt() && gav != null && kModuleModel != null) {
    trgMfs=new MemoryFileSystem();
    writePomAndKModule();
    compileJavaClasses();
    addKBasesFilesToTrg();
    kModule=new MemoryKieModule(gav,kModuleModel,trgMfs);
    if (dependencies != null && !dependencies.isEmpty()) {
      Map<GAV,InternalKieModule> modules=new HashMap<GAV,InternalKieModule>();
      for (      KieModule kieModule : dependencies) {
        modules.put(kieModule.getGAV(),(InternalKieModule)kieModule);
      }
      kModule.setDependencies(modules);
    }
    buildKieModule(kModule,messages);
  }
  return new ResultsImpl(messages.getMessages(),null);
}
