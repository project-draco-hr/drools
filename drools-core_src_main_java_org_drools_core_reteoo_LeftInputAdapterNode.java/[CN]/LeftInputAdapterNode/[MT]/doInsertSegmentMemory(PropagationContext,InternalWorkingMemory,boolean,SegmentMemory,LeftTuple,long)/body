{
  if (pctx.getType() == PropagationContext.INSERTION || mask == Long.MAX_VALUE || intersect(pctx.getModificationMask(),mask)) {
    boolean stagedInsertWasEmpty=false;
    if (((BaseNode)sm.getRootNode()).isStreamMode()) {
      stagedInsertWasEmpty=sm.getTupleQueue().isEmpty();
      sm.getTupleQueue().add(new LeftTupleEntry(leftTuple,pctx,sm.getNodeMemories().getFirst()));
      if (log.isTraceEnabled()) {
        log.trace("LeftInputAdapterNode queue={} empty={}",System.identityHashCode(sm.getTupleQueue()),sm.getTupleQueue().isEmpty());
      }
    }
 else {
      stagedInsertWasEmpty=sm.getStagedLeftTuples().addInsert(leftTuple);
    }
    if (stagedInsertWasEmpty && linkOrNotify) {
      sm.notifyRuleLinkSegment(wm);
    }
  }
}
