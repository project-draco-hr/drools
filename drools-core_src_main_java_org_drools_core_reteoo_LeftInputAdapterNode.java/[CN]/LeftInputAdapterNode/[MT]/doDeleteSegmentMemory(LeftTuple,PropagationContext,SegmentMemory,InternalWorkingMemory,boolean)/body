{
  LeftTupleSets leftTuples=sm.getStagedLeftTuples();
switch (leftTuple.getStagedType()) {
case LeftTuple.INSERT:
    leftTuples.removeInsert(leftTuple);
  break;
case LeftTuple.UPDATE:
leftTuples.removeUpdate(leftTuple);
break;
}
if (linkOrNotify && sm.getStagedLeftTuples().deleteSize() == 0) {
sm.notifyRuleLinkSegment(wm);
}
leftTuple.setPropagationContext(context);
leftTuples.addDelete(leftTuple);
}
