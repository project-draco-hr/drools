{
  if (this.kieContainer != null) {
    throw new RuntimeException("Cannot change KieContainer on an already initialized KieScanner");
  }
  this.kieContainer=(InternalKieContainer)kieContainer;
  ReleaseId containerReleaseId=this.kieContainer.getContainerReleaseId();
  if (containerReleaseId == null) {
    throw new RuntimeException("The KieContainer's ReleaseId cannot be null. Are you using a KieClasspathContainer?");
  }
  artifactResolver=getResolverFor(kieContainer.getReleaseId(),true);
  if (!isFixedVersion(containerReleaseId.getVersion())) {
    usedDependencies.put(containerReleaseId,new DependencyDescriptor(this.kieContainer.getReleaseId(),this.kieContainer.getCreationTimestamp()));
  }
  indexAtifacts();
  KieScannersRegistry.register(this);
  status=Status.STOPPED;
  if (MBeanUtils.isMBeanEnabled()) {
    mbean=new KieScannerMBeanImpl(this);
  }
}
