{
  final NLGrammar g=new NLGrammar();
  g.addNLItem(new NLMappingItem("foo {bar}","if ({bar}) { doSomething(); }","when"));
  final NLExpressionCompiler compiler=new NLExpressionCompiler(g);
  final String result=compiler.compile("foo bar","when");
  assertEquals("if (bar) { doSomething(); }",result);
}
