{
  try {
    Map originalMap=new HashMap();
    originalMap.put("name","Edson");
    originalMap.put("surname","Tirelli");
    originalMap.put("age","28");
    final Class proxy=ShadowProxyFactory.getProxy(originalMap.getClass());
    final Map mapProxy=(Map)proxy.getConstructor(new Class[]{originalMap.getClass()}).newInstance(new Object[]{originalMap});
    ((ShadowProxy)mapProxy).setShadowedObject(originalMap);
    Assert.assertEquals("Edson",mapProxy.get("name"));
    Assert.assertTrue(mapProxy.containsKey("age"));
    Assert.assertSame(originalMap,((ShadowProxy)mapProxy).getShadowedObject());
    Assert.assertEquals(mapProxy,originalMap);
    originalMap.remove("age");
    originalMap.put("hair","brown");
    Assert.assertTrue(mapProxy.containsKey("age"));
    Assert.assertFalse(mapProxy.containsKey("hair"));
    ((ShadowProxy)mapProxy).updateProxy();
    Assert.assertFalse(mapProxy.containsKey("age"));
    Assert.assertTrue(mapProxy.containsKey("hair"));
    Assert.assertEquals(mapProxy,originalMap);
  }
 catch (  final Exception e) {
    e.printStackTrace();
    fail("Error: " + e.getMessage());
  }
}
