{
  KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newClassPathResource("test_TestMapVariableRef.drl",getClass()),ResourceType.DRL);
  KnowledgeBuilderErrors errors=kbuilder.getErrors();
  if (errors.size() > 0) {
    for (    KnowledgeBuilderError error : errors) {
      logger.warn(error.toString());
    }
    throw new IllegalArgumentException("Could not parse knowledge.");
  }
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());
  StatefulKnowledgeSession ksession=createKnowledgeSession(kbase);
  List<Map<String,Object>> list=new ArrayList<Map<String,Object>>();
  Map mapOne=new HashMap<String,Object>();
  Map mapTwo=new HashMap<String,Object>();
  mapOne.put("MSG","testMessage");
  mapTwo.put("MSGTWO","testMessage");
  list.add(mapOne);
  list.add(mapTwo);
  ksession.insert(list);
  ksession.fireAllRules();
  assertEquals(3,list.size());
}
