{
  DecisionTableConfiguration dtableconfiguration=KnowledgeBuilderFactory.newDecisionTableConfiguration();
  dtableconfiguration.setInputType(DecisionTableInputType.XLS);
  KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.addResource(new InputStreamReader(getSpreadsheetStream(),"windows-1252"),KnowledgeType.DTABLE,dtableconfiguration);
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());
  StatelessKnowledgeSession ksession=kbase.newStatelessKnowledgeSession();
  Driver driver=new Driver();
  Policy policy=new Policy();
  ksession.executeObject(new Object[]{driver,policy});
  System.out.println("BASE PRICE IS: " + policy.getBasePrice());
  System.out.println("DISCOUNT IS: " + policy.getDiscountPercent());
  return policy.getBasePrice();
}
