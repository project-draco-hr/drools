{
  DecisionTableConfiguration dtableconfiguration=KnowledgeBuilderFactory.newDecisionTableConfiguration();
  dtableconfiguration.setInputType(DecisionTableInputType.XLS);
  KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newClassPathResource("ExamplePolicyPricing.xls",getClass()),ResourceType.DTABLE,dtableconfiguration);
  if (kbuilder.hasErrors()) {
    System.err.print(kbuilder.getErrors());
    return -1;
  }
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());
  StatelessKnowledgeSession ksession=kbase.newStatelessKnowledgeSession();
  Driver driver=new Driver();
  Policy policy=new Policy();
  ksession.executeIterable(Arrays.asList(new Object[]{driver,policy}));
  System.out.println("BASE PRICE IS: " + policy.getBasePrice());
  System.out.println("DISCOUNT IS: " + policy.getDiscountPercent());
  return policy.getBasePrice();
}
