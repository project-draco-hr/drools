{
  try {
    new RulesRepositoryAdministrator(this.session).clearRulesRepository();
    this.session.getWorkspace().importXML("/",instream,ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
    session.save();
    MigrateDroolsPackage mig=new MigrateDroolsPackage();
    if (mig.needsMigration(this)) {
      mig.migrate(this);
    }
  }
 catch (  ItemExistsException e) {
    String message="Item already exists. At least two items with the path: " + e.getLocalizedMessage();
    log.error(message,e);
    throw new RulesRepositoryException(message);
  }
catch (  RepositoryException e) {
    log.error(e.getMessage(),e);
    throw new RulesRepositoryException("Repository error when importing from stream.",e);
  }
catch (  IOException e) {
    log.error(e.getMessage(),e);
    throw new RulesRepositoryException(e);
  }
}
