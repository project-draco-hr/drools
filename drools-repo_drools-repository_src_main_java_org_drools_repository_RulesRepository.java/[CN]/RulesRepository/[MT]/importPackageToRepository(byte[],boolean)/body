{
  try {
    if (importAsNew) {
      this.session.getWorkspace().importXML("/" + RULES_REPOSITORY_NAME + "/"+ RULE_PACKAGE_AREA+ "/",new ByteArrayInputStream(byteArray),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
    }
 else {
      this.session.getWorkspace().importXML("/" + RULES_REPOSITORY_NAME + "/"+ RULE_PACKAGE_AREA+ "/",new ByteArrayInputStream(byteArray),ImportUUIDBehavior.IMPORT_UUID_COLLISION_REPLACE_EXISTING);
    }
    session.save();
    MigrateDroolsPackage mig=new MigrateDroolsPackage();
    if (mig.needsMigration(this)) {
      mig.migrate(this);
    }
  }
 catch (  RepositoryException e) {
    log.error(e.getMessage(),e);
    throw new RulesRepositoryException(e);
  }
catch (  IOException e) {
    log.error(e.getMessage(),e);
    throw new RulesRepositoryException(e);
  }
}
