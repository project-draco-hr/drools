{
  final AccumulateMemory memory=(AccumulateMemory)workingMemory.getNodeMemory(this);
  final InternalFactHandle origin=(InternalFactHandle)context.getFactHandleOrigin();
  if (context.getType() == PropagationContext.EXPIRATION) {
    ((PropagationContextImpl)context).setFactHandle(null);
  }
  behavior.retractRightTuple(memory.betaMemory.getBehaviorContext(),rightTuple,workingMemory);
  memory.betaMemory.getRightTupleMemory().remove(rightTuple);
  for (LeftTuple childTuple=rightTuple.getBetaChildren(); childTuple != null; ) {
    LeftTuple tmp=childTuple.getRightParentNext();
    if (this.accumulate.supportsReverse()) {
      this.modifyTuple(false,childTuple.getParent(),rightTuple,context,workingMemory,memory);
    }
 else {
      LeftTuple match=childTuple.getParent();
      childTuple.unlinkFromLeftParent();
      childTuple.unlinkFromRightParent();
      this.retractLeftTuple(match,context,workingMemory);
      this.assertLeftTuple(match,context,workingMemory);
    }
    childTuple=tmp;
  }
  if (context.getType() == PropagationContext.EXPIRATION) {
    ((PropagationContextImpl)context).setFactHandle(origin);
  }
}
