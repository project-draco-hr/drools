{
  String rule="package org.drools.test\n" + "import org.drools.StockTick\n" + "rule R1 when\n"+ "   StockTick()\n"+ "then\n"+ "end\n";
  PackageBuilder pkgbuilder=new PackageBuilder();
  pkgbuilder.addPackageFromDrl(new StringReader(rule));
  assertFalse(pkgbuilder.getErrors().toString(),pkgbuilder.hasErrors());
  Package pkg=pkgbuilder.getPackage();
  byte[] spkg=DroolsStreamUtils.streamOut(pkg);
  KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newByteArrayResource(spkg),ResourceType.PKG);
  assertFalse(kbuilder.getErrors().toString(),kbuilder.hasErrors());
  Collection<KnowledgePackage> kpkgs=kbuilder.getKnowledgePackages();
  assertEquals(1,kpkgs.size());
  KnowledgePackage kpkg=kpkgs.iterator().next();
  assertEquals(1,kpkg.getRules().size());
}
