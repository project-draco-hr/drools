{
  Class<?> cls=findLoadedClass(name);
  if (cls == null) {
    final byte[] clazzBytes=this.map.get(convertClassToResourcePath(name));
    if (clazzBytes != null) {
      int lastDotPos=name.lastIndexOf('.');
      String pkgName=lastDotPos > 0 ? name.substring(0,lastDotPos) : "";
      if (getPackage(pkgName) == null) {
        definePackage(pkgName,"","","","","","",null);
      }
      cls=defineClass(name,clazzBytes,0,clazzBytes.length,PROTECTION_DOMAIN);
    }
    if (cls != null) {
      resolveClass(cls);
    }
  }
  return cls;
}
