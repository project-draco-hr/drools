{
  Map<String,Object> vars=new HashMap<String,Object>();
  Foo foo=new Foo();
  vars.put("foo",foo);
  Map<String,Macro> macros=new HashMap<String,Macro>();
  macros.put("modify",new Macro(){
    public String doMacro(){
      return "drools.modify";
    }
  }
);
  assertEquals("",foo.aValue);
  ExpressionCompiler compiler=new ExpressionCompiler(parseMacros("\"This is an modify()\"",macros));
  ParserContext ctx=new ParserContext(null,null,null);
  ctx.setSourceFile("test.mv");
  ctx.setDebugSymbols(true);
  assertEquals("\"This is an modify()\"",executeExpression(compiler.compile(ctx),null,vars));
}
