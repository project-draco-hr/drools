{
  String rule="";
  rule+="package org.drools;\n";
  rule+="import org.drools.Pet;\n";
  rule+="rule \"Test Rule\"\n";
  rule+="  when\n";
  rule+="    $pet: Pet()\n";
  rule+="    Pet( \n";
  rule+="      ownerName == $pet.attributes[\"key\"] \n";
  rule+="    )\n";
  rule+="  then\n";
  rule+="    System.out.println(\"hi pet\");\n";
  rule+="end";
  final PackageBuilder builder=new PackageBuilder();
  builder.addPackageFromDrl(new StringReader(rule));
  final org.drools.rule.Package pkg=builder.getPackage();
  final RuleBase ruleBase=getSinglethreadRuleBase();
  ruleBase.addPackage(pkg);
  StatefulSession session=ruleBase.newStatefulSession();
  assertNotNull(session);
  Pet pet1=new Pet("Toni");
  pet1.getAttributes().put("key","value");
  Pet pet2=new Pet("Toni");
  session.insert(pet1);
  session.insert(pet2);
  session.fireAllRules();
}
