{
  String str="package org.kie\n" + "rule Aaa when then end\n" + "rule Bbb when then end\n";
  KnowledgeBase kbase=loadKnowledgeBaseFromString(str);
  StatefulKnowledgeSession ksession=createKnowledgeSession(kbase);
  org.kie.event.rule.AgendaEventListener ael=mock(org.kie.event.rule.AgendaEventListener.class);
  ksession.addEventListener(ael);
  RuleNameStartsWithAgendaFilter af=new RuleNameStartsWithAgendaFilter("B");
  int rules=ksession.fireAllRules(af);
  assertEquals(1,rules);
  ArgumentCaptor<org.kie.event.rule.AfterActivationFiredEvent> arg=ArgumentCaptor.forClass(org.kie.event.rule.AfterActivationFiredEvent.class);
  verify(ael).afterActivationFired(arg.capture());
  assertThat(arg.getValue().getActivation().getRule().getName(),is("Bbb"));
}
