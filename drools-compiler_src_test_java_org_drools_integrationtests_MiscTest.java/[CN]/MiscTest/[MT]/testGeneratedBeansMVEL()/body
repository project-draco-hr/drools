{
  final KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newInputStreamResource(getClass().getResourceAsStream("test_GeneratedBeansMVEL.drl")),ResourceType.DRL);
  assertFalse(kbuilder.getErrors().toString(),kbuilder.hasErrors());
  KnowledgePackage kpkg=kbuilder.getKnowledgePackages().toArray(new KnowledgePackage[1])[0];
  assertEquals(1,kpkg.getRules().size());
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());
  kbase=SerializationHelper.serializeObject(kbase);
  FactType pf=kbase.getFactType("mortgages","Applicant");
  FactType af=kbase.getFactType("mortgages","LoanApplication");
  Object person=pf.newInstance();
  pf.set(person,"creditRating","OK");
  Object application=af.newInstance();
  StatefulKnowledgeSession ksession=kbase.newStatefulKnowledgeSession();
  ksession.insert(person);
  ksession.insert(application);
  ksession.fireAllRules();
}
