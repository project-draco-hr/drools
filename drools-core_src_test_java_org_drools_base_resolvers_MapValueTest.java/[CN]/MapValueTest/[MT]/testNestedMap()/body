{
  final RuleBase rb=RuleBaseFactory.newRuleBase();
  final WorkingMemory wm=rb.newWorkingMemory();
  final LiteralValue literalKey1=new LiteralValue("literalKey1");
  final LiteralValue literalValue1=new LiteralValue("literalValue1");
  final MapValue.KeyValuePair literalPair=new MapValue.KeyValuePair(literalKey1,literalValue1);
  final MapValue nestedMapValue=new MapValue(new MapValue.KeyValuePair[]{literalPair});
  final LiteralValue literalKey2=new LiteralValue("literalKey2");
  final MapValue.KeyValuePair nestedMapPair=new MapValue.KeyValuePair(literalKey2,nestedMapValue);
  final MapValue mapValue=new MapValue(new MapValue.KeyValuePair[]{nestedMapPair});
  final Cheese stilton=new Cheese("stilton",20);
  final FactHandle stiltonHandle=wm.assertObject(stilton);
  final Tuple tuple=new ReteTuple((DefaultFactHandle)stiltonHandle);
  final Map map=(Map)mapValue.getValue(tuple,wm);
  final Map nestedMap=(Map)map.get("literalKey2");
  assertEquals("literalValue1",nestedMap.get("literalKey1"));
}
