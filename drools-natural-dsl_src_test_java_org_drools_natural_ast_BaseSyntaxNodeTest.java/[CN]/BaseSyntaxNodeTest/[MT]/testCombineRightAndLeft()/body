{
  SubstitutionNode today=new SubstitutionNode("Today","new Date()");
  LeftRightInfix before=new LeftRightInfix("before","${left}.before(${right})",1,1);
  RightInfix dateOf=new RightInfix("date of","parseDate(${right}",1);
  LiteralNode myBirthday=new LiteralNode("10-Jul-1974");
  LiteralNode irrelevant=new LiteralNode("something irrelevant");
  today.next=before;
  before.prev=today;
  before.next=dateOf;
  dateOf.prev=before;
  dateOf.next=myBirthday;
  myBirthday.prev=dateOf;
  myBirthday.next=irrelevant;
  irrelevant.prev=myBirthday;
  assertFalse(today.isAllSatisfied(RightInfix.class));
  assertFalse(today.isAllSatisfied(LeftRightInfix.class));
  today.processLeftToRight(RightInfix.class);
  today.processLeftToRight(LeftRightInfix.class);
  assertTrue(today.isAllSatisfied(RightInfix.class));
  assertTrue(today.isAllSatisfied(LeftRightInfix.class));
  assertEquals(null,today.next);
  assertEquals(irrelevant,before.next);
  assertEquals(today,before.getArgumentsLeft().get(0));
  assertEquals(dateOf,before.getArgumentsRight().get(0));
  assertEquals(myBirthday,dateOf.getArguments().get(0));
  assertEquals(before,myBirthday.findStartNode());
  assertEquals(before,irrelevant.findStartNode());
  assertEquals(before,today.findStartNode());
}
