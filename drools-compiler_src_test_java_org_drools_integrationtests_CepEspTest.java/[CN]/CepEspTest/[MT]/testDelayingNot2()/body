{
  String str="package org.drools\n" + "declare A @role(event) symbol : String end\n" + "declare B @role(event) symbol : String end\n"+ "rule Setup when\n"+ "then\n"+ "    insert( new A() );\n"+ "end\n"+ "rule X\n"+ "when\n"+ "    $a : A() and not( B( this after $a ) )\n"+ "then\n"+ "end\n";
  KnowledgeBaseConfiguration conf=KnowledgeBaseFactory.newKnowledgeBaseConfiguration();
  conf.setOption(EventProcessingOption.STREAM);
  KnowledgeBase kbase=loadKnowledgeBase(new StringReader(str),conf);
  StatefulKnowledgeSession ksession=createKnowledgeSession(kbase);
  int rules=ksession.fireAllRules();
  assertEquals(2,rules);
}
