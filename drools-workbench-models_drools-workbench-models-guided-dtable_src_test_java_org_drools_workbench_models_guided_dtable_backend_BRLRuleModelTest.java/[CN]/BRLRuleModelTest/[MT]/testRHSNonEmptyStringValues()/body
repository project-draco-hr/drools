{
  GuidedDecisionTable52 dt=new GuidedDecisionTable52();
  dt.setTableFormat(GuidedDecisionTable52.TableFormat.EXTENDED_ENTRY);
  dt.setTableName("extended-entry");
  Pattern52 p1=new Pattern52();
  p1.setBoundName("p1");
  p1.setFactType("Smurf");
  BRLActionColumn brlAction=new BRLActionColumn();
  ActionUpdateField auf1=new ActionUpdateField("p1");
  auf1.addFieldValue(new ActionFieldValue("name","$name",DataType.TYPE_STRING));
  auf1.getFieldValues()[0].setNature(BaseSingleFieldConstraint.TYPE_TEMPLATE);
  ActionUpdateField auf2=new ActionUpdateField("p1");
  auf2.addFieldValue(new ActionFieldValue("age","$age",DataType.TYPE_NUMERIC_INTEGER));
  auf2.getFieldValues()[0].setNature(BaseSingleFieldConstraint.TYPE_TEMPLATE);
  brlAction.getDefinition().add(auf1);
  brlAction.getDefinition().add(auf2);
  brlAction.getChildColumns().add(new BRLActionVariableColumn("$name",DataType.TYPE_STRING,"Smurf","name"));
  brlAction.getChildColumns().add(new BRLActionVariableColumn("$age",DataType.TYPE_NUMERIC_INTEGER,"Smurf","age"));
  dt.getActionCols().add(brlAction);
  dt.setData(DataUtilities.makeDataLists(new Object[][]{new Object[]{1l,"desc-row1",null,null}}));
  String drl1=GuidedDTDRLPersistence.getInstance().marshal(dt);
  final String expected1="//from row number: 1\n" + "//desc-row1\n" + "rule \"Row 1 extended-entry\"\n"+ "  dialect \"mvel\"\n"+ "  when\n"+ "  then\n"+ "end";
  assertEqualsIgnoreWhitespace(expected1,drl1);
  dt.setData(DataUtilities.makeDataLists(new Object[][]{new Object[]{2l,"desc-row2","   ",35l}}));
  String drl2=GuidedDTDRLPersistence.getInstance().marshal(dt);
  final String expected2="//from row number: 1\n" + "//desc-row2\n" + "rule \"Row 2 extended-entry\"\n"+ "  dialect \"mvel\"\n"+ "  when\n"+ "  then\n"+ "    modify( p1 ) {\n"+ "      setAge( 35 )\n"+ "    }\n"+ "end";
  assertEqualsIgnoreWhitespace(expected2,drl2);
  dt.setData(DataUtilities.makeDataLists(new Object[][]{new Object[]{3l,"desc-row3","",null}}));
  String drl3=GuidedDTDRLPersistence.getInstance().marshal(dt);
  final String expected3="//from row number: 1\n" + "//desc-row3\n" + "rule \"Row 3 extended-entry\"\n"+ "  dialect \"mvel\"\n"+ "  when\n"+ "  then\n"+ "end";
  assertEqualsIgnoreWhitespace(expected3,drl3);
  dt.setData(DataUtilities.makeDataLists(new Object[][]{new Object[]{4l,"desc-row4","",35l}}));
  String drl4=GuidedDTDRLPersistence.getInstance().marshal(dt);
  final String expected4="//from row number: 1\n" + "//desc-row4\n" + "rule \"Row 4 extended-entry\"\n"+ "  dialect \"mvel\"\n"+ "  when\n"+ "  then\n"+ "    modify( p1 ) {\n"+ "      setAge( 35 )\n"+ "    }\n"+ "end";
  assertEqualsIgnoreWhitespace(expected4,drl4);
}
