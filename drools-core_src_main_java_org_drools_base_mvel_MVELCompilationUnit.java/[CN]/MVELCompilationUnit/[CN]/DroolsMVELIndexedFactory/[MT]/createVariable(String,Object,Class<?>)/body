{
  VariableResolver vr=getResolver(name);
  if (vr != null) {
    if (vr.getType() != null) {
      throw new RuntimeException("variable already defined within scope: " + vr.getType() + " "+ name);
    }
 else {
      vr.setValue(value);
      return vr;
    }
  }
 else {
    if (nextFactory == null)     nextFactory=new MapVariableResolverFactory(new HashMap());
    return nextFactory.createVariable(name,value,type);
  }
}
