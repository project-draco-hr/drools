{
  final List<String> knownVariables=new ArrayList<String>();
  MVELRuntime.resetDebugger();
  MVELDebugHandler.setDebugMode(true);
  MVELRuntime.setThreadDebugger(new Debugger(){
    public int onBreak(    Frame frame){
      System.out.println("onBreak");
      for (      String var : frame.getFactory().getKnownVariables()) {
        System.out.println("  " + var);
        knownVariables.add(var);
      }
      return 0;
    }
  }
);
  String source="org.drools.integrationtests.Rule_Hello_World_0";
  MVELRuntime.registerBreakpoint(source,1);
  KnowledgeBase kbase=readKnowledgeBase();
  StatefulKnowledgeSession ksession=kbase.newStatefulKnowledgeSession();
  File testTmpDir=new File("target/test-tmp/");
  testTmpDir.mkdirs();
  KnowledgeRuntimeLogger logger=KnowledgeRuntimeLoggerFactory.newFileLogger(ksession,"target/test-tmp/testHelloWorldDebug");
  Message message=new Message();
  message.setMessage("Hello World");
  message.setStatus(Message.HELLO);
  ksession.insert(message);
  ksession.fireAllRules();
  logger.close();
  assertEquals(2,knownVariables.size());
  assertTrue(knownVariables.contains("m"));
  assertTrue(knownVariables.contains("myMessage"));
}
