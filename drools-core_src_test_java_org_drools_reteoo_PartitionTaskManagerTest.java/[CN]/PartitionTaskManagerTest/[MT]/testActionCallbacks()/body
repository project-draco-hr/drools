{
  final PartitionTaskManager.Action action=mock(PartitionTaskManager.Action.class);
  taskManager.enqueue(action);
  taskManager.enqueue(action);
  ExecutorService pool=Executors.newSingleThreadExecutor();
  ExternalExecutorService service=new ExternalExecutorService(pool);
  manager.setPool(service);
  taskManager.enqueue(action);
  taskManager.enqueue(action);
  taskManager.enqueue(action);
  service.waitUntilEmpty();
  pool.shutdown();
  verify(action,times(5)).execute(workingMemory);
}
