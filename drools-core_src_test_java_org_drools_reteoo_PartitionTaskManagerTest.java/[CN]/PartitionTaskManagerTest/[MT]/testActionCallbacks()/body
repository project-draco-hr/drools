{
  final PartitionTaskManager.Action action=context.mock(PartitionTaskManager.Action.class);
  DeterministicScheduler pool=new DeterministicScheduler();
  context.checking(new Expectations(){
{
      allowing(action).compareTo(with(any(PartitionTaskManager.Action.class)));
      exactly(5).of(action).execute(workingMemory);
    }
  }
);
  taskManager.enqueue(action);
  taskManager.enqueue(action);
  ExternalExecutorService service=new ExternalExecutorService(pool);
  manager.setPool(service);
  taskManager.enqueue(action);
  taskManager.enqueue(action);
  taskManager.enqueue(action);
  pool.runUntilIdle();
  context.assertIsSatisfied();
}
