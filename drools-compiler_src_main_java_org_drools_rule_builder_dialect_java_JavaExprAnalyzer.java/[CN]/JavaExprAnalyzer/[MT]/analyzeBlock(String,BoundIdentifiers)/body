{
  final CharStream charStream=new ANTLRStringStream("{" + expr + "}");
  final JavaLexer lexer=new JavaLexer(charStream);
  final TokenStream tokenStream=new CommonTokenStream(lexer);
  final JavaParser parser=new JavaParser(tokenStream);
  parser.block();
  JavaAnalysisResult result=new JavaAnalysisResult();
  result.setIdentifiers(new HashSet<String>(parser.getIdentifiers()));
  result.setLocalVariables(new HashMap<String,JavaLocalDeclarationDescr>());
  for (Iterator<?> it=parser.getLocalDeclarations().iterator(); it.hasNext(); ) {
    JavaLocalDeclarationDescr descr=(JavaLocalDeclarationDescr)it.next();
    for (Iterator<?> identIt=descr.getIdentifiers().iterator(); identIt.hasNext(); ) {
      JavaLocalDeclarationDescr.IdentifierDescr ident=(JavaLocalDeclarationDescr.IdentifierDescr)identIt.next();
      result.addLocalVariable(ident.getIdentifier(),descr);
    }
  }
  result.setBlockDescrs(parser.getRootBlockDescr());
  return analyze(result,availableIdentifiers);
}
