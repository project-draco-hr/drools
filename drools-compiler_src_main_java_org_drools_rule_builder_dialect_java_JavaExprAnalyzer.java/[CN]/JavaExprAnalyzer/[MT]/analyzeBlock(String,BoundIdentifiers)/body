{
  final CharStream charStream=new ANTLRStringStream("{" + expr + "}");
  final JavaLexer lexer=new JavaLexer(charStream);
  final TokenStream tokenStream=new CommonTokenStream(lexer);
  final JavaParser parser=new JavaParser(tokenStream);
  parser.block();
  JavaAnalysisResult result=new JavaAnalysisResult();
  result.setIdentifiers(new HashSet<String>(parser.getIdentifiers()));
  result.setLocalVariables(new HashMap<String,JavaLocalDeclarationDescr>());
  if (parser.getRootBlockDescr().getInScopeLocalVars() != null) {
    for (    JavaLocalDeclarationDescr descr : parser.getRootBlockDescr().getInScopeLocalVars()) {
      for (Iterator<?> identIt=descr.getIdentifiers().iterator(); identIt.hasNext(); ) {
        JavaLocalDeclarationDescr.IdentifierDescr ident=(JavaLocalDeclarationDescr.IdentifierDescr)identIt.next();
        result.addLocalVariable(ident.getIdentifier(),descr);
      }
    }
  }
  result.setBlockDescrs(parser.getRootBlockDescr());
  return analyze(result,availableIdentifiers);
}
