fact = {'Age': 42, 'Risk': "'HIGH'", 'PolicyType': "'COMPREHENSIVE'", }
table = {'condition_headers': [['A', 'Age'], ['B', 'Risk =='], ['C', 'PolicyType ==']], 'action_headers': [['F', 'Premium'], ['G', 'Log']], 'data': [{'row': 2, 'A': '> 2', 'B': "'HIGH'", 'C': "'COMPREHENSIVE'", 'F': '245', }, {'row': 3, 'A': '< 25 ', 'B': "'LOW'", 'F': '390', }], }
headers = map(make_header, table['condition_headers'])
"\nfor row in table['data'] :\n    #go through all the conditions, evaluating\n    row_pass = True\n    for condition in headers :\n        col_index = condition[0]\n        cell_value = row[col_index]\n         \n        predicate = str(condition[1]) + str(cell_value)\n        \n        if not eval(predicate) :\n            #then failure due to negation\n            row_pass = False\n            break\n        #if they all pass\n        #then iterate through and apply the action (unless we finish on first match)\n        #thats it !\n    if row_pass :\n        for action in table['action_headers'] :\n            \n            col_label = action[0]\n            if (row.has_key(col_label)) :\n                fact[action[1]] = row[col_label]\n    \n\n\n\nprint str(fact)\n"
map(eval_table, table['data'])
print ('And the result is: ' + str(fact))
