{
  final CompositeObjectSinkAdapter ad=new CompositeObjectSinkAdapter();
  InternalReadAccessor extractor=store.getReader(Cheese.class,"charType",this.getClass().getClassLoader());
  final LiteralConstraint lit=new LiteralConstraint(extractor,equals.getEvaluator(extractor.getValueType(),Operator.EQUAL),new LongFieldImpl(65));
  final AlphaNode al=new AlphaNode(buildContext.getNextId(),lit,new MockObjectSource(buildContext.getNextId()),buildContext);
  ad.addObjectSink(al);
  assertNull(ad.otherSinks);
  assertNotNull(ad.hashedFieldIndexes);
  assertEquals(1,ad.hashableSinks.size());
  assertEquals(al,ad.getSinks()[0]);
  final LiteralConstraint lit2=new LiteralConstraint(extractor,equals.getEvaluator(extractor.getValueType(),Operator.EQUAL),new LongFieldImpl(66));
  final AlphaNode al2=new AlphaNode(buildContext.getNextId(),lit2,new MockObjectSource(buildContext.getNextId()),buildContext);
  ad.addObjectSink(al2);
  assertNull(ad.hashedSinkMap);
  assertEquals(2,ad.hashableSinks.size());
  final LiteralConstraint lit3=new LiteralConstraint(extractor,equals.getEvaluator(extractor.getValueType(),Operator.EQUAL),new LongFieldImpl(67));
  final AlphaNode al3=new AlphaNode(buildContext.getNextId(),lit3,new MockObjectSource(buildContext.getNextId()),buildContext);
  ad.addObjectSink(al3);
  assertNotNull(ad.hashedSinkMap);
  assertNull(ad.hashableSinks);
  Cheese cheese=new Cheese();
  cheese.setCharType('B');
  CompositeObjectSinkAdapter.HashKey hashKey=new CompositeObjectSinkAdapter.HashKey();
  hashKey.setValue(extractor.getIndex(),cheese,extractor);
  ObjectSink sink=(ObjectSink)ad.hashedSinkMap.get(hashKey);
  assertSame(al2,sink);
  cheese.setCharType('X');
  hashKey.setValue(extractor.getIndex(),cheese,extractor);
  sink=(ObjectSink)ad.hashedSinkMap.get(hashKey);
  assertNull(sink);
  ad.removeObjectSink(al2);
  assertNotNull(ad.hashableSinks);
  assertEquals(2,ad.hashableSinks.size());
  assertNull(ad.hashedSinkMap);
}
