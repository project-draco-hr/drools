{
  final KieSessionModelImpl kSession=new KieSessionModelImpl();
  kSession.setName(reader.getAttribute("name"));
  kSession.setType(reader.getAttribute("type"));
  String clockType=reader.getAttribute("clockType");
  if (clockType != null) {
    kSession.setClockType(ClockTypeOption.get(clockType));
  }
  readNodes(reader,new AbstractXStreamConverter.NodeReader(){
    public void onNode(    HierarchicalStreamReader reader,    String name,    String value){
      if ("listener".equals(name)) {
        ListenerModelImpl listener=readObject(reader,context,ListenerModelImpl.class);
        listener.setKSession(kSession);
        kSession.addListenerModel(listener);
      }
 else       if ("workItemHandler".equals(name)) {
        WorkItemHandlerModelImpl wih=readObject(reader,context,WorkItemHandlerModelImpl.class);
        wih.setKSession(kSession);
        kSession.addWorkItemHandelerModel(wih);
      }
    }
  }
);
  return kSession;
}
