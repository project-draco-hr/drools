{
  SpreadsheetCompiler compiler=new SpreadsheetCompiler();
  InputStream is=new ReaderInputStream(reader);
switch (configuration.getInputType()) {
case XLS:
{
      if (StringUtils.isEmpty(configuration.getWorksheetName())) {
        return compiler.compile(is,InputType.XLS);
      }
 else {
        return compiler.compile(is,configuration.getWorksheetName());
      }
    }
case CSV:
{
    return compiler.compile(is,InputType.CSV);
  }
}
return null;
}
