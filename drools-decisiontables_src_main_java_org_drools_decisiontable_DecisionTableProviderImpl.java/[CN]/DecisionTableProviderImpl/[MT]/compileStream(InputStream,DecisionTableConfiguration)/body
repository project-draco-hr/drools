{
  SpreadsheetCompiler compiler=new SpreadsheetCompiler();
  if (configuration == null) {
    configuration=KnowledgeBuilderFactory.newDecisionTableConfiguration();
    configuration.setInputType(DecisionTableInputType.XLS);
  }
switch (configuration.getInputType()) {
case XLS:
{
      if (StringUtils.isEmpty(configuration.getWorksheetName())) {
        return compiler.compile(is,InputType.XLS);
      }
 else {
        return compiler.compile(is,configuration.getWorksheetName());
      }
    }
case CSV:
{
    return compiler.compile(is,InputType.CSV);
  }
}
return null;
}
