{
  final int currentPageId=(int)key >> this.doubleShifts;
  final int nextPageId=(int)(key + 1) >> this.doubleShifts;
  if (currentPageId != nextPageId) {
    Page page=findPage(key + 1);
    while (page.isEmpty()) {
      page=page.getNextSibling();
    }
    key=this.doubleShifts << page.getPageId();
  }
 else {
    key+=1;
  }
  while (!containsKey(key) && key <= this.maxKey) {
    key++;
  }
  if (key > this.maxKey) {
    key-=1;
  }
  return key;
}
