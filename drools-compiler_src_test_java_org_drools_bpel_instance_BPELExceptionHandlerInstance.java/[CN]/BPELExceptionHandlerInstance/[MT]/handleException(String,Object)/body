{
  if (exception == null) {
    throw new IllegalArgumentException("Exception is null!");
  }
  if (!(faultHandler.getFaultName() == null || exception.equals(faultHandler.getFaultName()))) {
    throw new IllegalArgumentException("Cannot handle exception: " + exception);
  }
  NodeInstance nodeInstance=nodeInstanceContainer.getNodeInstance(faultHandler.getActivity());
  String faultVariable=faultHandler.getFaultVariable();
  if (faultVariable != null) {
    VariableScopeInstance variableScopeInstance=(VariableScopeInstance)((NodeInstanceImpl)nodeInstance).resolveContextInstance(VariableScope.VARIABLE_SCOPE,faultHandler.getFaultVariable());
    if (variableScopeInstance != null) {
      variableScopeInstance.setVariable(faultVariable,(String)param);
    }
 else {
      System.err.println("Could not find variable scope for variable " + faultVariable);
      System.err.println("when trying handle fault " + exception);
      System.err.println("Continuing without setting variable.");
    }
  }
  nodeInstance.trigger(null,null);
}
