{
  if (value == null) {
    return;
  }
  try {
    this.ruleBase.readLock();
    this.lock.lock();
    final Map globalDefintions=this.ruleBase.getGlobals();
    final Class type=(Class)globalDefintions.get(identifier);
    if ((type == null)) {
      throw new RuntimeException("Unexpected global [" + identifier + "]");
    }
 else     if (!type.isInstance(value)) {
      throw new RuntimeException("Illegal class for global. " + "Expected [" + type.getName() + "], "+ "found ["+ value.getClass().getName()+ "].");
    }
 else {
      this.globalResolver.setGlobal(identifier,value);
    }
  }
  finally {
    this.lock.unlock();
    this.ruleBase.readUnlock();
  }
}
