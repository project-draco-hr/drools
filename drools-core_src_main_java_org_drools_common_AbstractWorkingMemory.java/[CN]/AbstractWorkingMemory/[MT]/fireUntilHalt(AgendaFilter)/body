{
  if (isSequential()) {
    throw new IllegalStateException("fireUntilHalt() can not be called in sequential mode.");
  }
  executeQueuedActions();
  try {
    if (this.firing.compareAndSet(false,true)) {
      this.agenda.fireUntilHalt(agendaFilter);
    }
  }
  finally {
    this.firing.set(false);
  }
}
