{
  if (isSequential()) {
    for (Iterator it=this.liaPropagations.iterator(); it.hasNext(); ) {
      ((LIANodePropagation)it.next()).doPropagation(this);
    }
  }
  executeQueuedActions();
  int fireCount=0;
  try {
    if (this.firing.compareAndSet(false,true)) {
      fireCount=this.agenda.fireAllRules(agendaFilter,fireLimit);
    }
  }
  finally {
    this.firing.set(false);
  }
  return fireCount;
}
