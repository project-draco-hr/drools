{
  this.id=id;
  this.ruleBase=ruleBase;
  this.handleFactory=handleFactory;
  this.globalResolver=new MapGlobalResolver();
  this.maintainTms=this.ruleBase.getConfiguration().isMaintainTms();
  this.sequential=this.ruleBase.getConfiguration().isSequential();
  if (initialFactHandle == null) {
    this.initialFactHandle=new InitialFactHandle(handleFactory.newFactHandle(new InitialFactHandleDummyObject(),null,this));
  }
 else {
    this.initialFactHandle=initialFactHandle;
  }
  this.actionQueue=new LinkedList<WorkingMemoryAction>();
  this.addRemovePropertyChangeListenerArgs=new Object[]{this};
  this.queryResults=Collections.EMPTY_MAP;
  this.workingMemoryEventSupport=new WorkingMemoryEventSupport();
  this.agendaEventSupport=new AgendaEventSupport();
  this.workflowEventSupport=new RuleFlowEventSupport();
  this.__ruleBaseEventListeners=new LinkedList();
  this.lock=new ReentrantLock();
  this.liaPropagations=Collections.EMPTY_LIST;
  this.processInstances=new HashMap();
  this.processInstanceFactories=new HashMap();
  this.timeMachine=new TimeMachine();
  this.nodeMemories=new ConcurrentNodeMemories(this.ruleBase);
  if (this.maintainTms) {
    this.tms=new TruthMaintenanceSystem(this);
  }
 else {
    this.tms=null;
  }
  final RuleBaseConfiguration conf=this.ruleBase.getConfiguration();
  this.propagationIdCounter=new AtomicLong(propagationContext);
  this.objectStore=new SingleThreadedObjectStore(conf,this.lock);
  if (LogicalOverride.DISCARD.equals(conf.getLogicalOverride())) {
    this.discardOnLogicalOverride=true;
  }
 else {
    this.discardOnLogicalOverride=false;
  }
  this.processInstanceFactories.put(RuleFlowProcess.RULEFLOW_TYPE,new RuleFlowProcessInstanceFactory());
  this.entryPoints=new ConcurrentHashMap();
  this.entryPoints.put("DEFAULT",this);
  this.entryPoint=EntryPoint.DEFAULT;
  initTransient();
}
