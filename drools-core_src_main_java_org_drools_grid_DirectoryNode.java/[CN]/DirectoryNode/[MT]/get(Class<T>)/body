{
synchronized (interfaceClass) {
    Object service=services.get(interfaceClass);
    if (service == null) {
      try {
        Class<?> implementingClass=Class.forName(interfaceClass.getCanonicalName() + "Impl");
        service=implementingClass.newInstance();
        services.put(interfaceClass,service);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
    return interfaceClass.cast(service);
  }
}
