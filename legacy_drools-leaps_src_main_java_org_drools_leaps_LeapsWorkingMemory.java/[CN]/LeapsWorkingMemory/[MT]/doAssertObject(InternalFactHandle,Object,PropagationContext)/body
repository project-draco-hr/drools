{
  this.pushTokenOnStack(factHandle,new Token(this,factHandle,propagationContext));
  final List tuplesToAssert=new LinkedList();
  final Object objectClass=LeapsBuilder.getLeapsClassType(object);
  for (final Iterator tables=this.getFactTablesList(objectClass).iterator(); tables.hasNext(); ) {
    tuplesToAssert.clear();
    final FactTable factTable=(FactTable)tables.next();
    factTable.add(factHandle);
    for (final Iterator tuples=factTable.getTuplesIterator(); tuples.hasNext(); ) {
      final LeapsTuple tuple=(LeapsTuple)tuples.next();
      TokenEvaluator.evaluateExistsConditions(tuple,tuple.getLeapsRule(),this);
      if (tuple.isReadyForActivation()) {
        tuplesToAssert.add(tuple);
      }
    }
    for (final Iterator it=tuplesToAssert.iterator(); it.hasNext(); ) {
      final LeapsTuple tuple=(LeapsTuple)it.next();
      factTable.removeTuple(tuple);
      tuple.setContext(new PropagationContextImpl(nextPropagationIdCounter(),PropagationContext.ASSERTION,tuple.getLeapsRule().getRule(),null));
      this.assertTuple(tuple);
    }
  }
  final Activation[] activations=this.agenda.getActivations();
  for (int k=0; k < activations.length; k++) {
    boolean deActivate=false;
    final LeapsTuple tuple=(LeapsTuple)activations[k].getTuple();
    final ColumnConstraints[] not=tuple.getLeapsRule().getNotColumnConstraints();
    for (int i=0, length=not.length; !deActivate && i < length; i++) {
      final ColumnConstraints constraint=not[i];
      final Object columnClassObject=constraint.getClassType();
      if (((objectClass.getClass() == Class.class && columnClassObject.getClass() == Class.class && ((Class)columnClassObject).isAssignableFrom((Class)objectClass)) || (objectClass.getClass() != Class.class && columnClassObject.getClass() != Class.class && columnClassObject.equals(objectClass))) && constraint.isAllowed(factHandle,tuple,this)) {
        tuple.setBlockingNotFactHandle((LeapsFactHandle)factHandle,i);
        ((LeapsFactHandle)factHandle).addNotTuple(tuple,i);
        deActivate=true;
      }
    }
    if (deActivate) {
      tuple.setContext(new PropagationContextImpl(nextPropagationIdCounter(),PropagationContext.ASSERTION,tuple.getLeapsRule().getRule(),null));
      if (tuple.getLeapsRule().getRule() instanceof Query) {
        removeFromQueryResults(tuple.getLeapsRule().getRule().getName(),tuple);
      }
 else {
        invalidateActivation(tuple);
      }
    }
  }
}
