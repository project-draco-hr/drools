{
  RuleSetDef rs=new RuleSetDef("rule history",null);
  RuleDef first=rs.addRule(new RuleDef("rh1","xxxxx"));
  rs.addRule(new RuleDef("rh2","xxxxx"));
  rs.addRule(new RuleDef("rh3","xxxxx"));
  RepositoryManager repo=getRepo();
  repo.save(rs);
  rs=repo.loadRuleSet("rule history",1);
  rs.createNewVersion("yeah");
  repo.save(rs);
  List list=repo.listRuleVersions("rh1");
  assertEquals(2,list.size());
  assertTrue(list.get(0) instanceof RuleDef);
  RuleDef rule=(RuleDef)list.get(0);
  rule.addTag("XYZ");
  repo.save(rule);
  list=repo.listRuleVersions("rh1");
  assertEquals(2,list.size());
  rule.setContent("NEW CONTENT");
  repo.save(rule);
  rule.setContent("MORE NEW");
  repo.save(rule);
  list=repo.listRuleVersions("rh1");
  assertEquals(2,list.size());
  list=repo.listSaveHistory(rule);
  assertEquals(2,list.size());
  rs=repo.loadRuleSet("rule history",1);
  RuleDef firstLoaded=rs.findRuleByName("rh1");
  firstLoaded.setContent("new again");
  rs.modify(firstLoaded);
  repo.save(rs);
  rs=repo.loadRuleSet("rule history",1);
  RuleDef loadedAgain=rs.findRuleByName("rh1");
  assertEquals(firstLoaded.getContent(),loadedAgain.getContent());
}
