{
  while (!tempStack.empty()) {
    Node elem=(Node)tempStack.pop();
    String ns=elem.getNamespaceURI();
    String localName=elem.getLocalName();
    String name=((Element)elem).getTagName();
    NamedNodeMap domAttr=elem.getAttributes();
    AttributesImpl attr=new AttributesImpl();
    for (int acount=0; acount < domAttr.getLength(); acount++) {
      Node a=domAttr.item(acount);
      if (((ns == null || ns == "http://www.w3.org/1999/xhtml") && localName.equalsIgnoreCase("a")) || (a.getLocalName().equalsIgnoreCase("id"))) {
      }
 else {
        attr.addAttribute(a.getNamespaceURI(),a.getLocalName(),a.getNodeName(),"CDATA",a.getNodeValue());
      }
    }
    rtf.startElement(ns,localName,name,attr);
    elementStack.push(elem);
  }
  tempStack=null;
}
