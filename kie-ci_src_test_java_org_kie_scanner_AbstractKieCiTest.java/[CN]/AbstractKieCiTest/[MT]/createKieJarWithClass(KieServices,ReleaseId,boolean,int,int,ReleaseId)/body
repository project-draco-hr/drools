{
  KieModuleModel kproj=ks.newKieModuleModel();
  KieBaseModel kieBaseModel1=kproj.newKieBaseModel("KBase1").setEqualsBehavior(EqualityBehaviorOption.EQUALITY).setEventProcessingMode(EventProcessingOption.STREAM);
  KieSessionModel ksession1=kieBaseModel1.newKieSessionModel("KSession1").setType(KieSessionModel.KieSessionType.STATEFUL).setClockType(ClockTypeOption.get("realtime"));
  KieFileSystem kieFileSystem=ks.newKieFileSystem();
  kieFileSystem.writeKModuleXML(kproj.toXML()).writePomXML(getPom(releaseId,dependencies));
  if (useTypeDeclaration) {
    kieFileSystem.write("src/main/resources/" + kieBaseModel1.getName() + "/rule1.drl",createDRLWithTypeDeclaration(value,factor));
  }
 else {
    kieFileSystem.write("src/main/resources/" + kieBaseModel1.getName() + "/rule1.drl",createDRLForJavaSource(value)).write("src/main/java/org/kie/test/Bean.java",createJavaSource(factor));
  }
  KieBuilder kieBuilder=ks.newKieBuilder(kieFileSystem);
  assertTrue(kieBuilder.buildAll().getResults().getMessages().isEmpty());
  return (InternalKieModule)kieBuilder.getKieModule();
}
