{
  if (leftTuple.getLeftTupleSink() != node) {
    return;
  }
  final Activation activation=(Activation)leftTuple.getObject();
  if (activation instanceof ScheduledAgendaItem) {
    ScheduledAgendaItem scheduled=(ScheduledAgendaItem)activation;
    workingMemory.getTimerService().removeJob(scheduled.getJobHandle());
    scheduled.getJobHandle().setCancel(true);
  }
  if (activation.isQueued()) {
    activation.remove();
    ((EventSupport)workingMemory).getAgendaEventSupport().fireActivationCancelled(activation,workingMemory,MatchCancelledCause.CLEAR);
  }
  PropagationContextFactory pctxFactory=((InternalRuleBase)workingMemory.getRuleBase()).getConfiguration().getComponentFactory().getPropagationContextFactory();
  final PropagationContext propagationContext=pctxFactory.createPropagationContext(workingMemory.getNextPropagationIdCounter(),PropagationContext.RULE_REMOVAL,null,null,null);
  TruthMaintenanceSystemHelper.removeLogicalDependencies(activation,propagationContext,node.getRule());
  leftTuple.unlinkFromLeftParent();
  leftTuple.unlinkFromRightParent();
}
