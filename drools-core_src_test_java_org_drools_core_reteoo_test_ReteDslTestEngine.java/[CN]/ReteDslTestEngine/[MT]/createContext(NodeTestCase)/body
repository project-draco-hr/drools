{
  Map<String,Object> context=new HashMap<String,Object>();
  context.put("TestCase",testCase);
  RuleBaseConfiguration conf=new RuleBaseConfiguration();
  ReteooRuleBase rbase=new ReteooRuleBase("ID",conf);
  BuildContext buildContext=new BuildContext(rbase,rbase.getReteooBuilder().getIdGenerator());
  Rule rule=new Rule("rule1","org.pkg1",null);
  org.drools.core.rule.Package pkg=new org.drools.core.rule.Package("org.pkg1");
  pkg.getDialectRuntimeRegistry().setDialectData("mvel",new MVELDialectRuntimeData());
  pkg.addRule(rule);
  buildContext.setRule(rule);
  pctxFactory=conf.getComponentFactory().getPropagationContextFactory();
  rbase.addPackage(pkg);
  context.put(BUILD_CONTEXT,buildContext);
  context.put("ClassFieldAccessorStore",this.reteTesterHelper.getStore());
  InternalWorkingMemory wm=(InternalWorkingMemory)rbase.newStatefulSession(true);
  context.put(WORKING_MEMORY,wm);
  return context;
}
