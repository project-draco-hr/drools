{
  super.setState(state);
  while (!nodeInstances.isEmpty()) {
    RuleFlowNodeInstance nodeInstance=(RuleFlowNodeInstance)nodeInstances.get(0);
    nodeInstance.cancel();
  }
  workingMemory.removeEventListener(this);
  if (state == ProcessInstanceImpl.STATE_COMPLETED) {
    ((EventSupport)this.workingMemory).getRuleFlowEventSupport().fireRuleFlowProcessCompleted(this,this.workingMemory);
  }
}
