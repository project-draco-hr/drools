{
  if (unlinkingEnabled) {
    context=findMostRecentPropagationContext(leftTuple,context);
  }
  InternalAgenda agenda=(InternalAgenda)workingMemory.getAgenda();
  Object o=leftTuple.getObject();
  if (o != Boolean.TRUE) {
    AgendaItem match=(AgendaItem)o;
    if (match != null && match.isQueued()) {
      agenda.modifyActivation(match,true);
      return;
    }
  }
  if ((!this.rule.isEffective(leftTuple,this,workingMemory)) || (this.rule.isNoLoop() && this.rule.equals(context.getRuleOrigin()))) {
    return;
  }
  if (o == null || o == Boolean.TRUE) {
    leftTuple.setObject(null);
  }
  boolean fire=agenda.createActivation(leftTuple,context,workingMemory,this);
  if (fire && !isFireDirect()) {
    agenda.modifyActivation((AgendaItem)leftTuple.getObject(),false);
  }
}
