{
  KieBase kbase=KieServices.Factory.get().getKieClasspathContainer().getKieBase();
  Properties properties=new Properties();
  properties.put("drools.processInstanceManagerFactory","com.example.CustomJPAProcessInstanceManagerFactory");
  KnowledgeSessionConfiguration config=KnowledgeBaseFactory.newKnowledgeSessionConfiguration(properties);
  KieSession ksession=JPAKnowledgeService.newStatefulKnowledgeSession(kbase,config,env);
  SessionConfiguration sessionConfig=(SessionConfiguration)ksession.getSessionConfiguration();
  assertEquals("com.example.CustomJPAProcessInstanceManagerFactory",sessionConfig.getProcessInstanceManagerFactory());
}
