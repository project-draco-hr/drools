{
  Declaration[] declrs=results.getDeclarations(0).values().toArray(new Declaration[results.getDeclarations(0).size()]);
  this.results=new ArrayList<ArrayList<Object>>(results.size());
  this.factHandles=new ArrayList<ArrayList<FactHandle>>(results.size());
  int length=declrs.length;
  identifiers=new HashMap<String,Integer>(length);
  for (int i=0; i < length; i++) {
    identifiers.put(declrs[i].getIdentifier(),i);
  }
  for (  org.drools.QueryResult result : results) {
    ArrayList<Object> row=new ArrayList<Object>();
    ArrayList<FactHandle> rowHandle=new ArrayList<FactHandle>();
    for (int i=0; i < length; i++) {
      Declaration declr=declrs[i];
      row.add(result.get(declr));
      rowHandle.add(result.getFactHandle(declr));
    }
    this.results.add(row);
    this.factHandles.add(rowHandle);
  }
}
