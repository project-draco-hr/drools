{
  StatelessSession session=getStatelessSession(this.getClass().getResourceAsStream("MissingEquality.drl"));
  session.setAgendaFilter(new RuleNameMatchesAgendaFilter("Missing restriction in VariableRestrictions"));
  AnalyticsResult result=AnalyticsResultFactory.createAnalyticsResult();
  Collection<? extends Object> testData=getTestData(this.getClass().getResourceAsStream("MissingEqualityTest.drl"),result.getAnalyticsData());
  session.setGlobal("result",result);
  session.executeWithResults(testData);
  Iterator<AnalyticsMessageBase> iter=result.getBySeverity(Severity.WARNING).iterator();
  Collection<String> ruleNames=new ArrayList<String>();
  while (iter.hasNext()) {
    Object o=(Object)iter.next();
    if (o instanceof AnalyticsMessage) {
      Cause cause=((AnalyticsMessage)o).getFaulty();
      String name=((VariableRestriction)cause).getRuleName();
      ruleNames.add(name);
    }
  }
  assertTrue(ruleNames.remove("Missing equality 3"));
  assertTrue(ruleNames.remove("Missing equality 4"));
  assertTrue(ruleNames.remove("Missing equality 5"));
  assertTrue(ruleNames.remove("Missing equality 6"));
  if (!ruleNames.isEmpty()) {
    for (    String string : ruleNames) {
      fail("Rule " + string + " caused an error.");
    }
  }
}
