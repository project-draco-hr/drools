{
  String line=laDiscard();
  if (line.trim().equals("then")) {
    consumeDiscard();
    StringBuffer consequence=new StringBuffer();
    while (true) {
      line=laDiscard();
      if (line == null) {
        throw new ParseException("end expected",lineNumber);
      }
      String trimLine=line.trim();
      if (trimLine.equals("end")) {
        break;
      }
      consumeDiscard();
      line=maybeExpand(consequenceExpander.expand(trimLine,this));
      consequence.append(line + "\n");
    }
    System.err.println("begin consequence");
    System.err.println(consequence);
    System.err.println("end consequence");
  }
}
