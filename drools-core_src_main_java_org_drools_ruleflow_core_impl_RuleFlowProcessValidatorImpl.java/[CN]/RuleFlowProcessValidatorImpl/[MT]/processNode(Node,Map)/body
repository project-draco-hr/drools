{
  if (!nodes.containsKey(node)) {
    throw new IllegalStateException("A process node is connected with " + "a node that does not belong to the process.");
  }
  final Boolean prevValue=(Boolean)nodes.put(node,Boolean.TRUE);
  if (prevValue == Boolean.FALSE) {
    for (final Iterator it=node.getOutgoingConnections().iterator(); it.hasNext(); ) {
      final Connection connection=(Connection)it.next();
      processNode(connection.getTo(),nodes);
    }
  }
}
