{
  XmlPackageReader xmlPackageReader=new XmlPackageReader();
  xmlPackageReader.read(new InputStreamReader(getClass().getResourceAsStream("test_ParseRule.xml")));
  final PackageDescr pkgOriginal=xmlPackageReader.getPackageDescr();
  final XmlDumper dumper=new XmlDumper();
  final String result=dumper.dump(pkgOriginal);
  final BufferedReader reader=new BufferedReader(new InputStreamReader(getClass().getResourceAsStream("test_ParseRule.xml")));
  final StringBuffer buffer=new StringBuffer();
  String s=null;
  while ((s=reader.readLine()) != null) {
    buffer.append(s);
  }
  System.out.println("-------------------------");
  System.out.println(result);
  System.out.println("-------------------------");
  System.out.println(buffer);
  System.out.println("-------------------------");
  assertEqualsIgnoreWhitespace(buffer.toString(),result);
  assertNotNull(result);
  xmlPackageReader=new XmlPackageReader();
  final PackageDescr pkgDumped=xmlPackageReader.read(new StringReader(result));
  assertEquals(pkgOriginal.getName(),pkgDumped.getName());
  assertEquals(pkgOriginal.getFunctions().size(),pkgDumped.getFunctions().size());
  assertEquals(pkgOriginal.getRules().size(),pkgDumped.getRules().size());
  assertEquals(pkgOriginal.getGlobals().size(),pkgDumped.getGlobals().size());
  final RuleDescr ruleOriginal=(RuleDescr)pkgOriginal.getRules().get(0);
  final RuleDescr ruleDumped=(RuleDescr)pkgDumped.getRules().get(0);
  assertEquals(ruleOriginal.getName(),ruleDumped.getName());
  assertEquals(ruleOriginal.getLhs().getDescrs().size(),ruleDumped.getLhs().getDescrs().size());
  assertEquals(ruleOriginal.getConsequence(),ruleDumped.getConsequence());
}
