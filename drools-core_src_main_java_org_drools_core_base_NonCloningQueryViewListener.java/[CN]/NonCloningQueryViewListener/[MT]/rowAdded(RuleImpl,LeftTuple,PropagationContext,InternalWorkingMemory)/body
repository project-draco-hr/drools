{
  InternalFactHandle[] handles=new InternalFactHandle[tuple.getIndex() + 1];
  LeftTuple entry=tuple;
  while (entry.getIndex() > 0) {
    InternalFactHandle handle=entry.getLastHandle();
    if (handle != null) {
      handles[entry.getIndex()]=handle;
    }
    entry=entry.getParent();
  }
  InternalFactHandle handle=entry.getLastHandle();
  handles[entry.getIndex()]=handle;
  QueryTerminalNode node=(QueryTerminalNode)tuple.getLeftTupleSink();
  this.results.add(new QueryRowWithSubruleIndex(handles,node.getSubruleIndex()));
}
