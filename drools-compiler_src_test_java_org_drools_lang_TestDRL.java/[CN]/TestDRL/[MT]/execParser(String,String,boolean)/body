{
  CharStream input;
  if (isFile == true) {
    input=new ANTLRFileStream(testInput);
  }
 else {
    input=new ANTLRStringStream(testInput);
  }
  try {
    DRLLexer lexer=new DRLLexer(input);
    CommonTokenStream tokens=new CommonTokenStream(lexer);
    DRLParser parser=new DRLParser(tokens);
    Method ruleName=Class.forName("org.drools.lang.DRLParser").getMethod(testRuleName);
    PipedInputStream pipedIn=new PipedInputStream();
    PipedOutputStream pipedOut=new PipedOutputStream();
    PipedInputStream pipedErrIn=new PipedInputStream();
    PipedOutputStream pipedErrOut=new PipedOutputStream();
    try {
      pipedOut.connect(pipedIn);
      pipedErrOut.connect(pipedErrIn);
    }
 catch (    IOException e) {
      System.err.println("connection failed...");
      System.exit(1);
    }
    PrintStream console=System.out;
    PrintStream consoleErr=System.err;
    PrintStream ps=new PrintStream(pipedOut);
    PrintStream ps2=new PrintStream(pipedErrOut);
    System.setOut(ps);
    System.setErr(ps2);
    Object ruleReturn=ruleName.invoke(parser);
    String astString=null;
    if (ruleReturn != null) {
      if (ruleReturn.toString().indexOf(testRuleName + "_return") > 0) {
        try {
          Class _return=Class.forName("org.drools.lang.DRLParser" + "$" + testRuleName + "_return");
          Method[] methods=_return.getDeclaredMethods();
          for (          Method method : methods) {
            if (method.getName().equals("getTree")) {
              Method returnName=_return.getMethod("getTree");
              CommonTree tree=(CommonTree)returnName.invoke(ruleReturn);
              astString=tree.toStringTree();
            }
          }
        }
 catch (        Exception e) {
          System.err.println(e);
        }
      }
    }
  }
 catch (  ClassNotFoundException e) {
    e.printStackTrace();
    System.exit(1);
  }
catch (  SecurityException e) {
    e.printStackTrace();
    System.exit(1);
  }
catch (  NoSuchMethodException e) {
    e.printStackTrace();
    System.exit(1);
  }
catch (  IllegalAccessException e) {
    e.printStackTrace();
    System.exit(1);
  }
catch (  InvocationTargetException e) {
    this.stderr="error";
    return e.getCause().toString();
  }
catch (  Exception e) {
    e.printStackTrace();
    System.exit(1);
  }
  return stdout;
}
