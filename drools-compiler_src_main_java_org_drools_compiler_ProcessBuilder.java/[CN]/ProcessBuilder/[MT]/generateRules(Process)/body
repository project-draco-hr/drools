{
  StringBuilder builder=new StringBuilder();
  if (process instanceof WorkflowProcessImpl) {
    WorkflowProcessImpl ruleFlow=(WorkflowProcessImpl)process;
    builder.append("package " + ruleFlow.getPackageName() + "\n");
    List imports=ruleFlow.getImports();
    if (imports != null) {
      for (Iterator iterator=imports.iterator(); iterator.hasNext(); ) {
        builder.append("import " + iterator.next() + ";\n");
      }
    }
    Map globals=ruleFlow.getGlobals();
    if (globals != null) {
      for (Iterator iterator=globals.entrySet().iterator(); iterator.hasNext(); ) {
        Map.Entry entry=(Map.Entry)iterator.next();
        builder.append("global " + entry.getValue() + " "+ entry.getKey()+ ";\n");
      }
    }
    Node[] nodes=ruleFlow.getNodes();
    for (int i=0; i < nodes.length; i++) {
      if (nodes[i] instanceof Split) {
        Split split=(Split)nodes[i];
        if (split.getType() == Split.TYPE_XOR || split.getType() == Split.TYPE_OR) {
          for (Iterator iterator=split.getDefaultOutgoingConnections().iterator(); iterator.hasNext(); ) {
            Connection connection=(Connection)iterator.next();
            Constraint constraint=split.getConstraint(connection);
            if ("rule".equals(constraint.getType())) {
              builder.append(createSplitRule(process,connection,split.getConstraint(connection).getConstraint()));
            }
          }
        }
      }
 else       if (nodes[i] instanceof MilestoneNode) {
        MilestoneNode milestone=(MilestoneNode)nodes[i];
        builder.append(createMilestoneRule(process,milestone));
      }
    }
  }
  return builder.toString();
}
