{
  if (configuration == null) {
    this.configuration=new PackageBuilderConfiguration();
  }
 else {
    this.configuration=configuration;
  }
  this.rootClassLoader=new CompositeClassLoader(this.configuration.getClassLoader());
  this.defaultDialect=this.configuration.getDefaultDialect();
  this.pkgRegistryMap=new HashMap<String,PackageRegistry>();
  this.results=new ArrayList<DroolsError>();
  PackageRegistry pkgRegistry=new PackageRegistry(this,pkg);
  pkgRegistry.setDialect(this.defaultDialect);
  this.pkgRegistryMap.put(pkg.getName(),pkgRegistry);
  globals=new HashMap<String,Class<?>>();
}
