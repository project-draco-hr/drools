{
  validatePackageName(packageDescr);
  validateUniqueRuleNames(packageDescr);
  if (this.pkg != null) {
    mergePackage(this.pkg,packageDescr);
  }
 else {
    this.pkg=newPackage(packageDescr);
  }
  builder=new RuleBuilder(getTypeResolver(),this.classFieldExtractorCache,this.dialect);
  if (!hasErrors()) {
    for (final Iterator it=packageDescr.getFactTemplates().iterator(); it.hasNext(); ) {
      addFactTemplate((FactTemplateDescr)it.next());
    }
    for (final Iterator it=packageDescr.getFunctions().iterator(); it.hasNext(); ) {
      addFunction((FunctionDescr)it.next());
    }
    for (final Iterator it=packageDescr.getRules().iterator(); it.hasNext(); ) {
      addRule((RuleDescr)it.next());
    }
  }
  this.dialect.compileAll();
  this.results.addAll(this.dialect.getResults());
}
