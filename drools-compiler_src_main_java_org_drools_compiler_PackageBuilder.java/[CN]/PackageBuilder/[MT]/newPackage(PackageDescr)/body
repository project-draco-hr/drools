{
  Package pkg;
  if (this.ruleBase == null || (pkg=this.ruleBase.getPackage(packageDescr.getName())) == null) {
    pkg=new Package(packageDescr.getName());
    pkg.setClassFieldAccessorCache(new ClassFieldAccessorCache(this.rootClassLoader));
    if (this.ruleBase != null) {
      this.ruleBase.lock();
      try {
        this.ruleBase.addPackage(pkg);
        pkg=this.ruleBase.getPackage(packageDescr.getName());
      }
  finally {
        this.ruleBase.unlock();
      }
    }
 else {
      pkg.getDialectRuntimeRegistry().onAdd(this.rootClassLoader);
    }
  }
  PackageRegistry pkgRegistry=new PackageRegistry(this,pkg);
  pkgRegistry.addImport(new ImportDescr(packageDescr.getNamespace() + ".*"));
  this.pkgRegistryMap.put(packageDescr.getName(),pkgRegistry);
  return pkgRegistry;
}
