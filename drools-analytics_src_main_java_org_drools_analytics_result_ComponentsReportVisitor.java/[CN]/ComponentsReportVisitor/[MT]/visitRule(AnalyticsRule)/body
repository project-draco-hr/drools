{
  AnalyticsData data=AnalyticsDataFactory.getAnalyticsData();
  Collection<AnalyticsClass> objectTypes=data.getClassesByRuleName(rule.getRuleName());
  Map<String,Object> map=new HashMap<String,Object>();
  map.put("header",processHeader(UrlFactory.PREVIOUS_FOLDER));
  map.put("sourceFolder",UrlFactory.PREVIOUS_FOLDER);
  map.put("objectTypeFolder",UrlFactory.OBJECT_TYPE_FOLDER);
  map.put("cssStyle",createStyleTag(UrlFactory.PREVIOUS_FOLDER + "/" + UrlFactory.CSS_FOLDER+ "/"+ UrlFactory.CSS_FILE_DETAILS));
  map.put("rule",rule);
  map.put("objectTypes",objectTypes);
  String myTemplate=readFile("rule.htm");
  String result=TemplateInterpreter.evalToString(myTemplate,map);
  return result;
}
