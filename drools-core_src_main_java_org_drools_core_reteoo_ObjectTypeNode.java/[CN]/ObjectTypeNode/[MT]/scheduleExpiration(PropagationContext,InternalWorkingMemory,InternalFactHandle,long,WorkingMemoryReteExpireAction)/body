{
  TimerService clock=workingMemory.getTimerService();
  EventFactHandle eventFactHandle=(EventFactHandle)handle;
  long effectiveEnd=eventFactHandle.getEndTimestamp() + expirationOffset;
  long nextTimestamp=Math.max(clock.getCurrentTime(),effectiveEnd >= 0 ? effectiveEnd : Long.MAX_VALUE);
  JobContext jobctx=new ExpireJobContext(expireAction,workingMemory);
  JobHandle jobHandle=clock.scheduleJob(job,jobctx,new PointInTimeTrigger(nextTimestamp,null,null));
  jobctx.setJobHandle(jobHandle);
  eventFactHandle.addJob(jobHandle);
}
