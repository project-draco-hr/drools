{
  long initialNumberOfSavedSessions=getSavedSessionsCount();
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  StatefulKnowledgeSession crmPersistentSession=createSession(kbase);
  long ksessionId=crmPersistentSession.getId();
  crmPersistentSession.fireAllRules();
  crmPersistentSession=disposeAndReloadSession(crmPersistentSession,kbase);
  Assert.assertEquals(ksessionId,crmPersistentSession.getId());
  ksessionId=crmPersistentSession.getId();
  crmPersistentSession.fireAllRules();
  crmPersistentSession=disposeAndReloadSession(crmPersistentSession,kbase);
  crmPersistentSession.fireAllRules();
  Assert.assertEquals(initialNumberOfSavedSessions + 1,getSavedSessionsCount());
  crmPersistentSession.dispose();
}
