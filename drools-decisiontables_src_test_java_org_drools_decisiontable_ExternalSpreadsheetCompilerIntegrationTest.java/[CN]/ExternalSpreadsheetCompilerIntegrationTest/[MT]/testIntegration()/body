{
  final ExternalSpreadsheetCompiler converter=new ExternalSpreadsheetCompiler();
  final String drl=converter.compile("/data/IntegrationExampleTest.xls","/templates/test_integration.drl",18,3);
  final PackageBuilder builder=new PackageBuilder();
  builder.addPackageFromDrl(new StringReader(drl));
  final Package pkg=builder.getPackage();
  assertNotNull(pkg);
  assertEquals(0,builder.getErrors().getErrors().length);
  final RuleBase rb=RuleBaseFactory.newRuleBase();
  rb.addPackage(pkg);
  final WorkingMemory wm=rb.newStatefulSession();
  wm.insert(new Cheese("stilton",42));
  wm.insert(new Person("michael","stilton",42));
  final List list=new ArrayList();
  wm.setGlobal("list",list);
  wm.fireAllRules();
  assertEquals(1,list.size());
}
