{
  BetaMemory memory;
  final List list=new ArrayList(2);
  if (this.indexed0) {
    final IndexableConstraint indexableConstraint=(IndexableConstraint)this.constraint0;
    final FieldIndex index=indexableConstraint.getFieldIndex();
    list.add(index);
  }
  if (this.indexed1) {
    final IndexableConstraint indexableConstraint=(IndexableConstraint)this.constraint1;
    final FieldIndex index=indexableConstraint.getFieldIndex();
    list.add(index);
  }
  if (this.indexed2) {
    final IndexableConstraint indexableConstraint=(IndexableConstraint)this.constraint2;
    final FieldIndex index=indexableConstraint.getFieldIndex();
    list.add(index);
  }
  if (this.indexed3) {
    final IndexableConstraint indexableConstraint=(IndexableConstraint)this.constraint3;
    final FieldIndex index=indexableConstraint.getFieldIndex();
    list.add(index);
  }
  if (!list.isEmpty()) {
    final FieldIndex[] indexes=(FieldIndex[])list.toArray(new FieldIndex[list.size()]);
    LeftTupleMemory tupleMemory;
    if (conf.isIndexLeftBetaMemory()) {
      tupleMemory=new LeftTupleIndexHashTable(indexes);
    }
 else {
      tupleMemory=new LeftTupleList();
    }
    RightTupleMemory factHandleMemory;
    if (conf.isIndexRightBetaMemory()) {
      factHandleMemory=new RightTupleIndexHashTable(indexes);
    }
 else {
      factHandleMemory=new RightTupleList();
    }
    memory=new BetaMemory(conf.isSequential() ? null : tupleMemory,factHandleMemory,this.createContext(),nodeType);
  }
 else {
    memory=new BetaMemory(conf.isSequential() ? null : new LeftTupleList(),new RightTupleList(),this.createContext(),nodeType);
  }
  return memory;
}
