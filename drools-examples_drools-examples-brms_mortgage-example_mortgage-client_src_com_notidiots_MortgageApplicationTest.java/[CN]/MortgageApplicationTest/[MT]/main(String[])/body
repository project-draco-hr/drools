{
  StatefulKnowledgeSession ksession=null;
  try {
    KnowledgeBase kbase=readKnowledgeBase();
    FactType appType=kbase.getFactType("mortgages","LoanApplication");
    Object application=appType.newInstance();
    appType.set(application,"amount",25000);
    appType.set(application,"deposit",1500);
    appType.set(application,"lengthYears",20);
    FactType incomeType=kbase.getFactType("mortgages","IncomeSource");
    Object income=incomeType.newInstance();
    incomeType.set(income,"type","Job");
    incomeType.set(income,"amount",65000);
    ksession=kbase.newStatefulKnowledgeSession();
    ksession.insert(application);
    ksession.insert(income);
    ksession.fireAllRules();
    System.out.println(application);
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
 finally {
    if (ksession != null) {
      ksession.dispose();
    }
  }
}
