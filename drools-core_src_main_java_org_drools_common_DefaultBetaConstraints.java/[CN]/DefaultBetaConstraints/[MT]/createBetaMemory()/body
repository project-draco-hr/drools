{
  BetaMemory memory;
  if (this.indexed) {
    final Constraint constraint=(Constraint)this.constraints.getFirst();
    final VariableConstraint variableConstraint=(VariableConstraint)constraint;
    final FieldIndex index=new FieldIndex(variableConstraint.getFieldExtractor(),variableConstraint.getRequiredDeclarations()[0]);
    memory=new BetaMemory(new TupleHashTable(),new FieldIndexHashTable(new FieldIndex[]{index}));
  }
 else {
    memory=new BetaMemory(new TupleHashTable(),new FactHashTable());
  }
  return memory;
}
