{
  this.conf=conf;
  this.indexed=-1;
  this.constraints=new LinkedList();
  ContextEntry current=null;
  int depth=conf.getCompositeKeyDepth();
  for (int i=0, length=constraints.length; i < length; i++) {
    if (isIndexable(constraints[i])) {
      if (depth >= 1 && indexed == -1) {
        this.constraints.insertAfter(null,new LinkedListEntry(constraints[i]));
        indexed++;
      }
 else       if (depth >= this.indexed + 1) {
        this.constraints.insertAfter(findNode(indexed++),new LinkedListEntry(constraints[i]));
      }
    }
 else {
      this.constraints.add(new LinkedListEntry(constraints[i]));
    }
  }
  for (LinkedListEntry entry=(LinkedListEntry)this.constraints.getFirst(); entry != null; entry=(LinkedListEntry)entry.getNext()) {
    BetaNodeFieldConstraint constraint=(BetaNodeFieldConstraint)entry.getObject();
    final ContextEntry context=constraint.getContextEntry();
    if (current == null) {
      current=context;
      this.contexts=context;
    }
 else {
      current.setNext(context);
    }
    current=context;
  }
}
