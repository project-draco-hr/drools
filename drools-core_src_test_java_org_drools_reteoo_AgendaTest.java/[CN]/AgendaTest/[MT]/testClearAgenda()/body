{
  RuleBase ruleBase=new RuleBaseImpl();
  WorkingMemoryImpl workingMemory=(WorkingMemoryImpl)ruleBase.newWorkingMemory();
  final Agenda agenda=workingMemory.getAgenda();
  final Rule rule1=new Rule("test-rule1");
  ReteTuple tuple=new ReteTuple(0,new FactHandleImpl(1),workingMemory);
  final PropagationContext context1=new PropagationContextImpl(PropagationContext.ASSERTION,rule1,new AgendaItem(tuple,initContext,rule1));
  rule1.setConsequence(new org.drools.spi.Consequence(){
    public void invoke(    Activation activation){
    }
  }
);
  assertEquals(0,agenda.focusSize());
  rule1.setNoLoop(false);
  agenda.addToAgenda(tuple,context1,rule1);
  assertEquals(1,agenda.focusSize());
  agenda.clearAgenda();
  assertEquals(0,agenda.focusSize());
}
