{
  systemEventListener.debug("Message receieved : " + msg);
  List<GenericCommand> commands;
  if (msg.getPayload() instanceof List) {
    commands=(List<GenericCommand>)msg.getPayload();
  }
 else {
    commands=new ArrayList<GenericCommand>();
    commands.add((GenericCommand)msg.getPayload());
  }
  ContextImpl localSessionContext=new ContextImpl("session_" + msg.getSessionId(),this.data.getContextManager(),this.data.getTemp());
  ExecutionResultImpl localKresults=new ExecutionResultImpl();
  localSessionContext.set("kresults_" + msg.getSessionId(),localKresults);
  for (  GenericCommand cmd : commands) {
    cmd.execute(localSessionContext);
  }
  if (!msg.isAsync() && localKresults.getIdentifiers().isEmpty()) {
    session.write(new Message(msg.getSessionId(),msg.getResponseId(),msg.isAsync(),new FinishedCommand()));
  }
 else {
    session.write(new Message(msg.getSessionId(),msg.getResponseId(),msg.isAsync(),localKresults));
  }
}
