{
  final DelegateJavaFactHandler handler=new DelegateJavaFactHandler();
  final Field field=handler.getClass().getDeclaredField("entries");
  field.setAccessible(true);
  final WorkingMemory wm1=RuleBaseFactory.newRuleBase().newWorkingMemory();
  handler.register(wm1);
  JavaFactRegistryEntry[] entries=(JavaFactRegistryEntry[])field.get(handler);
  assertEquals(1,entries.length);
  assertTrue(handler.isRegistered(wm1));
  assertEquals(1,handler.listWorkingMemories().length);
  assertSame(wm1,handler.listWorkingMemories()[0].getWorkingMemory());
  final WorkingMemory wm2=RuleBaseFactory.newRuleBase().newWorkingMemory();
  assertFalse(handler.isRegistered(wm2));
  handler.unregister(wm1);
  assertFalse(handler.isRegistered(wm1));
  entries=(JavaFactRegistryEntry[])field.get(handler);
  assertNull(entries);
}
