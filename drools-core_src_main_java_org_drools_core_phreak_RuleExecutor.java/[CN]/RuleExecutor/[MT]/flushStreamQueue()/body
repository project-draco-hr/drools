{
  TupleEntryQueue tupleQueue=pmem.getStreamQueue().takeAllForFlushing();
  if (tupleQueue == null || tupleQueue.isEmpty()) {
    return Collections.emptyList();
  }
  List<TupleEntry> nonNormalizedDeletes=new ArrayList<TupleEntry>();
  while (!tupleQueue.isEmpty()) {
    TupleEntry tupleEntry=tupleQueue.remove();
    if (processStreamTupleEntry(tupleQueue,tupleEntry)) {
      nonNormalizedDeletes.add(tupleEntry);
    }
  }
  return nonNormalizedDeletes;
}
