{
  final RuleDescr rule=parseResource("from.drl").rule();
  System.err.println(parser.getErrorMessages());
  assertFalse(parser.hasErrors());
  assertNotNull(rule);
  assertEquals("using_from",rule.getName());
  assertEquals(6,rule.getLhs().getDescrs().size());
  FromDescr from=(FromDescr)rule.getLhs().getDescrs().get(0);
  assertEquals(3,from.getLine());
  assertEquals("Foo",from.getReturnedColumn().getObjectType());
  assertTrue(from.getDataSource() instanceof FieldAccessDescr);
  assertEquals("baz",((FieldAccessDescr)from.getDataSource()).getFieldName());
  assertEquals("bar",((FieldAccessDescr)from.getDataSource()).getVariableName());
  ArgumentValueDescr arg=null;
  from=(FromDescr)rule.getLhs().getDescrs().get(1);
  assertEquals("Whee",from.getReturnedColumn().getObjectType());
  assertEquals(1,from.getReturnedColumn().getDescrs().size());
  assertTrue(from.getDataSource() instanceof FunctionCallDescr);
  assertEquals("whee",((FunctionCallDescr)from.getDataSource()).getName());
  assertEquals(1,((FunctionCallDescr)from.getDataSource()).getArguments().size());
  arg=((ArgumentValueDescr)((FunctionCallDescr)from.getDataSource()).getArguments().get(0));
  assertEquals("y",arg.getValue());
  assertEquals(ArgumentValueDescr.STRING,arg.getType());
  assertEquals(4,from.getLine());
  assertEquals(4,from.getReturnedColumn().getLine());
  from=(FromDescr)rule.getLhs().getDescrs().get(2);
  assertEquals("Foo",from.getReturnedColumn().getObjectType());
  assertEquals(1,from.getReturnedColumn().getDescrs().size());
  assertEquals("f",from.getReturnedColumn().getIdentifier());
  assertTrue(from.getDataSource() instanceof MethodAccessDescr);
  assertEquals("bar",((MethodAccessDescr)from.getDataSource()).getVariableName());
  assertEquals("la",((MethodAccessDescr)from.getDataSource()).getMethodName());
  assertEquals(1,((MethodAccessDescr)from.getDataSource()).getArguments().size());
  arg=(ArgumentValueDescr)((MethodAccessDescr)from.getDataSource()).getArguments().get(0);
  assertEquals("x",arg.getValue());
  assertEquals(ArgumentValueDescr.VARIABLE,arg.getType());
  assertEqualsIgnoreWhitespace("whee();",rule.getConsequence());
  from=(FromDescr)rule.getLhs().getDescrs().get(3);
  assertEquals("wa",((FunctionCallDescr)from.getDataSource()).getName());
  from=(FromDescr)rule.getLhs().getDescrs().get(4);
  MethodAccessDescr meth=(MethodAccessDescr)from.getDataSource();
  assertEquals("wa",meth.getMethodName());
  assertEquals("la",meth.getVariableName());
  arg=(ArgumentValueDescr)meth.getArguments().get(0);
  assertEquals("42",arg.getValue());
  assertEquals(ArgumentValueDescr.INTEGRAL,arg.getType());
  arg=(ArgumentValueDescr)meth.getArguments().get(1);
  assertEquals("42.42",arg.getValue());
  assertEquals(ArgumentValueDescr.DECIMAL,arg.getType());
  arg=(ArgumentValueDescr)meth.getArguments().get(2);
  assertEquals("false",arg.getValue());
  assertEquals(ArgumentValueDescr.BOOLEAN,arg.getType());
  arg=(ArgumentValueDescr)meth.getArguments().get(3);
  assertEquals("null",arg.getValue());
  assertEquals(ArgumentValueDescr.NULL,arg.getType());
  assertEquals("Bam",((ColumnDescr)rule.getLhs().getDescrs().get(5)).getObjectType());
}
