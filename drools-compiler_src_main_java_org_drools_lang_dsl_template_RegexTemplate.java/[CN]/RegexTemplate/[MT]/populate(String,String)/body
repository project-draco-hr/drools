{
  Matcher matcher=templatePattern.matcher(source);
  if (!matcher.matches())   return source;
  String result=targetTemplate;
  if (matcher.groupCount() != holes.size()) {
    throw new IllegalArgumentException("Unable to match up holes in template with source.");
  }
  for (int i=0; i < matcher.groupCount(); i++) {
    String val=matcher.group(i + 1);
    String hole=(String)holes.get(i);
    result=replace(result,hole,val.trim());
  }
  return result;
}
