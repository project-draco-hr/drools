{
  final Matcher matcher=this.templatePattern.matcher(source);
  if (!matcher.matches()) {
    return source;
  }
  String result=targetTemplate;
  if (matcher.groupCount() != this.holes.size()) {
    throw new IllegalArgumentException("Unable to match up holes in template with source.");
  }
  for (int i=0; i < matcher.groupCount(); i++) {
    final String val=matcher.group(i + 1);
    final String hole=(String)this.holes.get(i);
    result=replace(result,hole,val.trim());
  }
  return result;
}
