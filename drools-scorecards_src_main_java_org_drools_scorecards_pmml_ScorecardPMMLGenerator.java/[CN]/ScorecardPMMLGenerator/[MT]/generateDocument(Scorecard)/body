{
  removeEmptyExtensions(pmmlScorecard);
  createAndSetPredicates(pmmlScorecard);
  createAndSetOutput(pmmlScorecard);
  repositionExternalClassExtensions(pmmlScorecard);
  Extension scorecardPackage=ScorecardPMMLUtils.getExtension(pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas(),PMMLExtensionNames.MODEL_PACKAGE);
  if (scorecardPackage != null) {
    pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas().remove(scorecardPackage);
  }
  Extension importsExt=ScorecardPMMLUtils.getExtension(pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas(),PMMLExtensionNames.MODEL_IMPORTS);
  if (importsExt != null) {
    pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas().remove(importsExt);
  }
  Extension agendaGroupExt=ScorecardPMMLUtils.getExtension(pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas(),PMMLExtensionNames.AGENDA_GROUP);
  if (agendaGroupExt != null) {
    pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas().remove(agendaGroupExt);
  }
  Extension ruleFlowGroupExt=ScorecardPMMLUtils.getExtension(pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas(),PMMLExtensionNames.RULEFLOW_GROUP);
  if (ruleFlowGroupExt != null) {
    pmmlScorecard.getExtensionsAndCharacteristicsAndMiningSchemas().remove(ruleFlowGroupExt);
  }
  PMML pmml=new PMML();
  Header header=new Header();
  Timestamp timestamp=new Timestamp();
  timestamp.getContent().add(new SimpleDateFormat("yyyy.MM.dd 'at' HH:mm:ss z",Locale.ENGLISH).format(new Date()));
  header.setTimestamp(timestamp);
  header.setDescription("generated by the drools-scorecards module");
  header.getExtensions().add(scorecardPackage);
  header.getExtensions().add(importsExt);
  if (ruleFlowGroupExt != null) {
    header.getExtensions().add(ruleFlowGroupExt);
  }
  if (agendaGroupExt != null) {
    header.getExtensions().add(agendaGroupExt);
  }
  pmml.setHeader(header);
  createAndSetDataDictionary(pmml,pmmlScorecard);
  pmml.getAssociationModelsAndBaselineModelsAndClusteringModels().add(pmmlScorecard);
  removeAttributeFieldExtension(pmmlScorecard);
  return pmml;
}
