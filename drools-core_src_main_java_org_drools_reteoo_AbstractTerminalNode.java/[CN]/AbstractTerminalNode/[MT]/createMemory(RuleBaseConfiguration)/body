{
  int segmentCount=1;
  if (getLeftTupleSource().getSinkPropagator().size() > 1) {
    segmentCount++;
  }
  int segmentPosMask=1;
  long allLinkedTestMask=1;
  PathMemory rmem=new PathMemory(this);
  LeftTupleSource tupleSource=getLeftTupleSource();
  boolean updateBitInNewSegment=false;
  while (tupleSource.getLeftTupleSource() != null) {
    if (!SegmentUtilities.parentInSameSegment(tupleSource)) {
      updateBitInNewSegment=true;
      segmentPosMask=segmentPosMask << 1;
      segmentCount++;
    }
    if (updateBitInNewSegment && NodeTypeEnums.isBetaNode(tupleSource)) {
      updateBitInNewSegment=false;
      allLinkedTestMask=allLinkedTestMask | segmentPosMask;
    }
    tupleSource=tupleSource.getLeftTupleSource();
  }
  rmem.setAllLinkedMaskTest(allLinkedTestMask);
  rmem.setSegmentMemories(new SegmentMemory[segmentCount]);
  return rmem;
}
