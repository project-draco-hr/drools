{
  final Configuration config=this.xmlPackageReader.endConfiguration();
  final RuleDescr ruleDescr=(RuleDescr)this.xmlPackageReader.getCurrent();
  final AndDescr lhs=ruleDescr.getLhs();
  if (lhs == null) {
    throw new SAXParseException("<rule> requires a LHS",this.xmlPackageReader.getLocator());
  }
  final Configuration rhs=config.getChild("rhs");
  if (rhs == null) {
    throw new SAXParseException("<rule> requires a <rh> child element",this.xmlPackageReader.getLocator());
  }
  ruleDescr.setConsequence(rhs.getText());
  final Configuration[] attributes=config.getChildren("rule-attribute");
  for (int i=0, length=attributes.length; i < length; i++) {
    final String name=attributes[i].getAttribute("name");
    if (name == null || name.trim().equals("")) {
      throw new SAXParseException("<rule-attribute> requires a 'name' attribute",this.xmlPackageReader.getLocator());
    }
    final String value=attributes[i].getAttribute("value");
    ruleDescr.addAttribute(new AttributeDescr(name,value));
  }
  this.xmlPackageReader.getPackageDescr().addRule(ruleDescr);
  return null;
}
