{
  PackageBuilder builder=new PackageBuilder();
  Reader source=new InputStreamReader(getClass().getResourceAsStream("rule_with_expander_dsl.drl"));
  Reader dsl=new InputStreamReader(getClass().getResourceAsStream("test_expander.dsl"));
  builder.addPackageFromDrl(source,dsl);
  Package pkg=builder.getPackage();
  assertTrue(pkg.isValid());
  assertEquals(null,pkg.getErrorSummary());
  String err=builder.printErrors();
  assertEquals("",err);
  assertEquals(0,builder.getErrors().length);
  RuleBase ruleBase=getRuleBase();
  ruleBase.addPackage(pkg);
  WorkingMemory wm=ruleBase.newWorkingMemory();
  wm.assertObject(new Person("Bob","stilton"));
  wm.assertObject(new Cheese("stilton",42));
  List messages=new ArrayList();
  wm.setGlobal("messages",messages);
  wm.fireAllRules();
  assertEquals(1,messages.size());
}
