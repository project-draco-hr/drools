{
  try {
    final PackageBuilder builder=new PackageBuilder();
    builder.addPackageFromDrl(new InputStreamReader(getClass().getResourceAsStream("test_Query.drl")));
    final RuleBase ruleBase=getRuleBase();
    ruleBase.addPackage(builder.getPackage());
    final WorkingMemory workingMemory=ruleBase.newWorkingMemory();
    workingMemory.fireAllRules();
    QueryResults results=workingMemory.getQueryResults("assertedobjquery");
    if (results == null || !results.iterator().hasNext()) {
      Assert.fail("The stated query should return a result");
    }
 else {
      int counter=0;
      for (Iterator it=results.iterator(); it.hasNext(); ) {
        QueryResult result=(QueryResult)it.next();
        ;
        AssertedObject assertedObject=(AssertedObject)result.get("assertedobj");
        Assert.assertNotNull("Query result is not expected to be null",assertedObject);
        counter++;
      }
      Assert.assertEquals("Expecting a single result from the query",1,counter);
    }
  }
 catch (  Exception e) {
    Assert.fail("Retrieving query results should not throw any exception: " + e.getMessage());
  }
}
