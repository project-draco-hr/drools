{
  final StringBuffer result=new StringBuffer();
  final Tuple tuple=activation.getTuple();
  final Map<?,?> declarations=activation.getSubRule().getOuterDeclarations();
  for (Iterator<?> it=declarations.values().iterator(); it.hasNext(); ) {
    final Declaration declaration=(Declaration)it.next();
    final FactHandle handle=tuple.get(declaration);
    if (handle instanceof InternalFactHandle) {
      final InternalFactHandle handleImpl=(InternalFactHandle)handle;
      if (handleImpl.getId() == -1) {
        continue;
      }
      final Object value=declaration.getValue((InternalWorkingMemory)workingMemory,handleImpl.getObject());
      result.append(declaration.getIdentifier());
      result.append("=");
      if (value == null) {
        result.append("null");
      }
 else {
        result.append(value);
        result.append("(");
        result.append(handleImpl.getId());
        result.append(")");
      }
    }
    if (it.hasNext()) {
      result.append("; ");
    }
  }
  return result.toString();
}
