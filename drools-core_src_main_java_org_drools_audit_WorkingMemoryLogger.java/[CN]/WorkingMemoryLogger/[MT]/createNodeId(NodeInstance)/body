{
  Node node=((org.drools.workflow.instance.NodeInstance)nodeInstance).getNode();
  if (node == null) {
    return "";
  }
  String nodeId="" + node.getId();
  NodeContainer nodeContainer=node.getNodeContainer();
  while (nodeContainer != null) {
    if (nodeContainer instanceof CompositeNode) {
      node=(CompositeNode)nodeContainer;
      nodeContainer=node.getNodeContainer();
      if (!(nodeContainer instanceof ForEachNode)) {
        nodeId=node.getId() + ":" + nodeId;
      }
    }
 else {
      break;
    }
  }
  return nodeId;
}
