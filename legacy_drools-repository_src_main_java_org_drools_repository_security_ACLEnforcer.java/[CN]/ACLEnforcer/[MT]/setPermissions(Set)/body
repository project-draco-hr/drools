{
  for (Iterator iter=permissions.iterator(); iter.hasNext(); ) {
    AssetPermission perm=(AssetPermission)iter.next();
    Object existingPermMap=permissionMap.get(perm.getAssetType());
    if (existingPermMap != null) {
      Map existing=(Map)existingPermMap;
      if (existing.containsKey(perm.getAssetId())) {
        AssetPermission current=(AssetPermission)existing.get(perm.getAssetId());
        current.setPermission(current.getPermission() | perm.getPermission());
      }
 else {
        existing.put(perm.getAssetId(),perm);
      }
    }
 else {
      Map existing=new HashMap();
      existing.put(perm.getAssetId(),perm);
      permissionMap.put(perm.getAssetType(),existing);
    }
  }
}
