{
  this.sessionInfo=new SessionInfo();
  this.ksession=kbase.newKieSession(conf,this.env);
  this.marshallingHelper=new SessionMarshallingHelper(this.ksession,conf);
  MarshallingConfigurationImpl config=(MarshallingConfigurationImpl)this.marshallingHelper.getMarshaller().getMarshallingConfiguration();
  config.setMarshallProcessInstances(false);
  config.setMarshallWorkItems(false);
  this.sessionInfo.setJPASessionMashallingHelper(this.marshallingHelper);
  ((InternalKnowledgeRuntime)this.ksession).setEndOperationListener(new EndOperationListenerImpl(this.sessionInfo));
  this.kContext=new FixedKnowledgeCommandContext(new ContextImpl("ksession",null),null,null,this.ksession,null);
  this.commandService=new TransactionInterceptor(kContext);
  ((AcceptsTimerJobFactoryManager)((InternalKnowledgeRuntime)ksession).getTimerService()).getTimerJobFactoryManager().setCommandService(this);
}
