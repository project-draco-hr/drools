{
  this.id=id;
  this.config=config;
  this.kBase=kBase;
  this.handleFactory=handleFactory;
  this.pctxFactory=kBase.getConfiguration().getComponentFactory().getPropagationContextFactory();
  this.environment=environment;
  this.ruleRuntimeEventSupport=workingMemoryEventSupport;
  this.agendaEventSupport=agendaEventSupport;
  this.ruleEventListenerSupport=ruleEventListenerSupport;
  this.propagationList=new SynchronizedPropagationList();
  this.propagationIdCounter=new AtomicLong(propagationContext);
  if (agenda == null) {
    this.agenda=kBase.getConfiguration().getComponentFactory().getAgendaFactory().createAgenda(kBase);
  }
 else {
    this.agenda=agenda;
  }
  this.agenda.setWorkingMemory(this);
  init();
  if (initInitFactHandle) {
    initInitialFact(kBase,null);
  }
}
