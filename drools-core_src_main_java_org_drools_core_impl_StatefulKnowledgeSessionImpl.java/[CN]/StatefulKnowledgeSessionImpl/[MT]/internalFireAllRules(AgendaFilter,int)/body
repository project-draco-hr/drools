{
  int fireCount=0;
  try {
    kBase.readLock();
    flushPropagations();
    fireCount=this.agenda.fireAllRules(agendaFilter,fireLimit);
  }
  finally {
    kBase.readUnlock();
    if (kBase.flushModifications()) {
      fireCount+=internalFireAllRules(agendaFilter,fireLimit);
    }
  }
  return fireCount;
}
