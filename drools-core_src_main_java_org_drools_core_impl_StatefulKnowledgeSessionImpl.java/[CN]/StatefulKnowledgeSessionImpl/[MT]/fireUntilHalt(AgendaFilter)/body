{
  if (isSequential()) {
    throw new IllegalStateException("fireUntilHalt() can not be called in sequential mode.");
  }
  if (this.firing.compareAndSet(false,true)) {
    try {
      startOperation();
      agenda.fireUntilHalt(agendaFilter);
    }
  finally {
      endOperation();
      this.firing.set(false);
    }
  }
}
