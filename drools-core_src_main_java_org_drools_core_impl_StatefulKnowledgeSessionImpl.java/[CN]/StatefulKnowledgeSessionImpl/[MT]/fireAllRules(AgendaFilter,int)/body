{
  checkAlive();
  if (this.firing.compareAndSet(false,true)) {
    try {
      startOperation();
      kBase.readLock();
      executeQueuedActions();
      int fireCount=0;
      fireCount=this.agenda.fireAllRules(agendaFilter,fireLimit);
      return fireCount;
    }
  finally {
      kBase.readUnlock();
      endOperation();
      this.firing.set(false);
    }
  }
  return 0;
}
