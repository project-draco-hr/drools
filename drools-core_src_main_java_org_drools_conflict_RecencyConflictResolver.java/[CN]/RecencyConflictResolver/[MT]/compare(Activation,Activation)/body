{
  InternalFactHandle[] lFacts=(InternalFactHandle[])lhs.getTuple().getFactHandles();
  InternalFactHandle[] rFacts=(InternalFactHandle[])rhs.getTuple().getFactHandles();
  InternalFactHandle leftMostRecent=getMostRecentFact(lFacts);
  InternalFactHandle rightMostRecent=getMostRecentFact(rFacts);
  int lastIndex=(lFacts.length < rFacts.length) ? lFacts.length : rFacts.length;
  if (leftMostRecent.getRecency() == rightMostRecent.getRecency() && lastIndex > 1) {
    for (int i=0; i < lastIndex; i++) {
      leftMostRecent=getMostRecentFact(lFacts,leftMostRecent);
      rightMostRecent=getMostRecentFact(rFacts,rightMostRecent);
      if (leftMostRecent == null || rightMostRecent == null) {
        if (leftMostRecent == null && rightMostRecent != null) {
          return leftMostRecent.getRecency();
        }
      }
      if (leftMostRecent.getRecency() != rightMostRecent.getRecency()) {
        return (int)(rightMostRecent.getRecency() - leftMostRecent.getRecency());
      }
    }
  }
 else {
    return (int)(rightMostRecent.getRecency() - leftMostRecent.getRecency());
  }
  return rFacts.length - lFacts.length;
}
