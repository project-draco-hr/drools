{
  final InternalFactHandle[] lFacts=lhs.getTuple().getFactHandles();
  final InternalFactHandle[] rFacts=rhs.getTuple().getFactHandles();
  InternalFactHandle leftMostRecent=getMostRecentFact(lFacts);
  InternalFactHandle rightMostRecent=getMostRecentFact(rFacts);
  final int lastIndex=(lFacts.length < rFacts.length) ? lFacts.length : rFacts.length;
  if (leftMostRecent.getRecency() == rightMostRecent.getRecency() && lastIndex > 1) {
    for (int i=0; i < lastIndex; i++) {
      leftMostRecent=getMostRecentFact(lFacts,leftMostRecent);
      rightMostRecent=getMostRecentFact(rFacts,rightMostRecent);
      if (leftMostRecent == null || rightMostRecent == null) {
        if (leftMostRecent == null && rightMostRecent != null) {
          return (int)rightMostRecent.getRecency();
        }
      }
 else       if (leftMostRecent.getRecency() != rightMostRecent.getRecency()) {
        return (int)(rightMostRecent.getRecency() - leftMostRecent.getRecency());
      }
    }
  }
 else {
    return (int)(rightMostRecent.getRecency() - leftMostRecent.getRecency());
  }
  return rFacts.length - lFacts.length;
}
