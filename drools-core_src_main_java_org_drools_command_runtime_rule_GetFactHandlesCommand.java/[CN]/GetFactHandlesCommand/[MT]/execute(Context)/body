{
  StatefulKnowledgeSession ksession=((KnowledgeCommandContext)context).getStatefulKnowledgesession();
  if (filter != null) {
    Collection<FactHandle> factHandles=ksession.getFactHandles(this.filter);
    if (factHandles != null && disconnected) {
      for (      FactHandle factHandle : factHandles) {
        ((DefaultFactHandle)factHandle).disconnect();
      }
    }
    return factHandles;
  }
 else {
    Collection<FactHandle> factHandles=ksession.getFactHandles();
    if (factHandles != null && disconnected) {
      for (      FactHandle factHandle : factHandles) {
        ((DefaultFactHandle)factHandle).disconnect();
      }
    }
    return factHandles;
  }
}
