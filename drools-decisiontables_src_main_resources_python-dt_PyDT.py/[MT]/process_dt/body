def process_dt(fact, table):

    def make_header(hdr):
        splut = hdr[1].split(' ')
        if (len(splut) > 1):
            return [hdr[0], ((fact[splut[0]] + ' ') + splut[1])]
        else:
            return [hdr[0], fact[hdr[1]]]
    headers = map(make_header, table['condition_headers'])

    def eval_table(row):

        def check_condition(condition):
            col_index = condition[0]
            if (not row.has_key(col_index)):
                return False
            cell_value = row[col_index]
            predicate = (str(condition[1]) + str(cell_value))
            return (not eval(predicate))
        size = len(filter(check_condition, headers))
        if (size == 0):

            def apply_actions(action):
                col_label = action[0]
                if row.has_key(col_label):
                    fact[action[1]] = row[col_label]
            map(apply_actions, table['action_headers'])
    map(eval_table, table['data'])
