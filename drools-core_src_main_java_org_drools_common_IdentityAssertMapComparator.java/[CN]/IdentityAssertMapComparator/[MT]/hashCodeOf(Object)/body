{
  Object realObject=obj;
  if (realObject instanceof FactHandle) {
    realObject=((InternalFactHandle)obj).getObject();
  }
  if (realObject instanceof ShadowProxy) {
    realObject=((ShadowProxy)realObject).getShadowedObject();
  }
  return rehash(System.identityHashCode(realObject));
}
