{
  if (o1 instanceof FactHandle) {
    return ((InternalFactHandle)o1).getObject() == ((InternalFactHandle)o2).getObject();
  }
  Object left=o1;
  if (left instanceof ShadowProxy) {
    left=((ShadowProxy)left).getShadowedObject();
  }
  final InternalFactHandle handle=((InternalFactHandle)o2);
  return left == ((handle.isShadowFact()) ? ((ShadowProxy)handle.getObject()).getShadowedObject() : handle.getObject());
}
