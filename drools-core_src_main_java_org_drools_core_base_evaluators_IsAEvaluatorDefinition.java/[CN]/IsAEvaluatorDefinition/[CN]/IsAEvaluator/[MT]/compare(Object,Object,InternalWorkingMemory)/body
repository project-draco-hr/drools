{
  Collection sourceTraits=null;
  Collection targetTraits=null;
  if (source instanceof Thing) {
    sourceTraits=((TraitableBean)((Thing)source).getCore()).getTraits();
  }
 else   if (source instanceof TraitableBean) {
    sourceTraits=((TraitableBean)source).getTraits();
  }
 else {
    TraitableBean tbean=lookForWrapper(source,workingMemory);
    if (tbean != null) {
      sourceTraits=tbean.getTraits();
    }
  }
  if (target instanceof Thing) {
    targetTraits=((TraitableBean)((Thing)target).getCore()).getTraits();
  }
 else   if (target instanceof TraitableBean) {
    targetTraits=((TraitableBean)target).getTraits();
  }
 else {
    TraitableBean tbean=lookForWrapper(target,workingMemory);
    if (tbean != null) {
      targetTraits=tbean.getTraits();
    }
  }
  return (targetTraits != null && sourceTraits != null && (this.getOperator().isNegated() ^ sourceTraits.containsAll(targetTraits))) || (sourceTraits == null && this.getOperator().isNegated());
}
