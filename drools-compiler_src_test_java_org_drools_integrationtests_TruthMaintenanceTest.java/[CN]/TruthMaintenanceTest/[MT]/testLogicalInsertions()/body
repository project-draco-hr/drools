{
  final KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newClassPathResource("test_LogicalInsertions.drl",getClass()),KnowledgeType.DRL);
  Collection<KnowledgePackage> kpkgs=kbuilder.getKnowledgePackages();
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  kbase.addKnowledgePackages(kpkgs);
  kbase=SerializationHelper.serializeObject(kbase);
  final StatefulKnowledgeSession session=kbase.newStatefulKnowledgeSession();
  final List list=new ArrayList();
  session.setGlobal("list",list);
  final Cheese brie=new Cheese("brie",12);
  final FactHandle brieHandle=session.insert(brie);
  final Cheese provolone=new Cheese("provolone",12);
  final FactHandle provoloneHandle=session.insert(provolone);
  session.fireAllRules();
  assertEquals(3,list.size());
  assertEquals(3,session.getObjects().size());
  session.retract(brieHandle);
  assertEquals(2,session.getObjects().size());
  session.retract(provoloneHandle);
  assertEquals(0,session.getObjects().size());
}
