{
  snapshotter.loadSnapshot(data1);
  XAResource xa=pm.getXAResource();
  Xid xid=new DroolsXid(100,new byte[]{0x01},new byte[]{0x01});
  xa.start(xid,XAResource.TMNOFLAGS);
  snapshotter.loadSnapshot(data2);
  xa.commit(xid,true);
  pm.save();
  assertTrue(assertEquals(data2,snapshotter.bytes));
  snapshotter.loadSnapshot(data3);
  assertTrue(assertEquals(data3,snapshotter.bytes));
  pm.load();
  assertTrue(assertEquals(data2,snapshotter.bytes));
}
