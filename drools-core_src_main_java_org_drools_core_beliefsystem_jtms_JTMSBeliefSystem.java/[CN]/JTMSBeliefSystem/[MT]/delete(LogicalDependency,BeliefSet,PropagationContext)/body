{
  JTMSBeliefSet jtmsBeliefSet=(JTMSBeliefSet)beliefSet;
  boolean wasConflicting=jtmsBeliefSet.isUndecided();
  boolean wasNegated=jtmsBeliefSet.isNegated();
  boolean primeChanged=false;
  if ((jtmsBeliefSet.getPositiveFactHandle() != null && jtmsBeliefSet.getPositiveFactHandle().getObject() == node.getObject()) || (jtmsBeliefSet.getNegativeFactHandle() != null && jtmsBeliefSet.getNegativeFactHandle().getObject() == node.getObject())) {
    primeChanged=true;
  }
  beliefSet.remove(node.getJustifierEntry());
  if (beliefSet.isEmpty()) {
    if (wasNegated) {
      defEP.getObjectStore().addHandle(beliefSet.getFactHandle(),beliefSet.getFactHandle().getObject());
      InternalFactHandle fh=jtmsBeliefSet.getNegativeFactHandle();
      ((NamedEntryPoint)fh.getEntryPoint()).delete(fh,(Rule)context.getRuleOrigin(),node.getJustifier());
    }
    if (!(context.getType() == PropagationContext.DELETION && context.getFactHandle() == beliefSet.getFactHandle())) {
      InternalFactHandle fh=jtmsBeliefSet.getFactHandle();
      ((NamedEntryPoint)fh.getEntryPoint()).delete(fh,(Rule)context.getRuleOrigin(),node.getJustifier());
    }
  }
 else   if (wasConflicting && !jtmsBeliefSet.isUndecided()) {
    insertBelief(node,defEP.getObjectTypeConfigurationRegistry().getObjectTypeConf(defEP.getEntryPoint(),node.getObject()),jtmsBeliefSet,context,false,wasNegated,wasConflicting);
  }
 else   if (primeChanged) {
    String value;
    InternalFactHandle handle;
    Object object=null;
    if (jtmsBeliefSet.isNegated()) {
      if (!wasNegated) {
        jtmsBeliefSet.setNegativeFactHandle(jtmsBeliefSet.getPositiveFactHandle());
        jtmsBeliefSet.setPositiveFactHandle(null);
      }
      value=MODE.NEGATIVE.getId();
      handle=jtmsBeliefSet.getNegativeFactHandle();
      for (LinkedListEntry<LogicalDependency> entry=(LinkedListEntry<LogicalDependency>)jtmsBeliefSet.getLast(); entry != null; entry=(LinkedListEntry<LogicalDependency>)entry.getPrevious()) {
        if (entry.getObject().getValue().equals(value)) {
          object=entry.getObject().getObject();
          break;
        }
      }
    }
 else {
      if (wasNegated) {
        jtmsBeliefSet.setPositiveFactHandle(jtmsBeliefSet.getNegativeFactHandle());
        jtmsBeliefSet.setNegativeFactHandle(null);
      }
      value=MODE.POSITIVE.getId();
      handle=jtmsBeliefSet.getPositiveFactHandle();
      for (LinkedListEntry<LogicalDependency> entry=(LinkedListEntry<LogicalDependency>)jtmsBeliefSet.getFirst(); entry != null; entry=(LinkedListEntry<LogicalDependency>)entry.getNext()) {
        if (entry.getObject().getValue() == null || entry.getObject().getValue().equals(value)) {
          object=entry.getObject().getObject();
          break;
        }
      }
    }
    if (handle.getObject() != object) {
      ((NamedEntryPoint)handle.getEntryPoint()).getObjectStore().updateHandle(handle,object);
      ((NamedEntryPoint)handle.getEntryPoint()).update(handle,true,handle.getObject(),Long.MAX_VALUE,Object.class,null);
    }
  }
}
