{
  this.resource=resource;
  InputStream is=resource.getInputStream();
  String encoding=null;
  if (resource instanceof ClassPathResource) {
    encoding=((ClassPathResource)resource).getEncoding();
  }
  if (resource instanceof ReaderResource) {
    encoding=((ReaderResource)resource).getEncoding();
  }
  if (resource instanceof InputStreamResource) {
    encoding=((InputStreamResource)resource).getEncoding();
  }
  lexer=buildLexer(is,encoding,languageLevel);
  DRLParser parser=buildParser(lexer,languageLevel);
  return compile(isEditor,parser);
}
