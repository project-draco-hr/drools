{
  this.kbase=kbase;
  this.resources=new HashMap<Resource,ResourceMapping>();
  this.resourceDirectories=new HashSet<Resource>();
  this.listener=listener;
  this.newInstance=true;
  if (configuration != null) {
    this.notifier=(ResourceChangeNotifierImpl)ResourceFactory.getResourceChangeNotifierService();
    if (((KnowledgeAgentConfigurationImpl)configuration).isMonitorChangeSetEvents()) {
      this.monitor=true;
    }
    if (((KnowledgeAgentConfigurationImpl)configuration).isScanDirectories()) {
      this.scanDirectories=true;
    }
    if (((KnowledgeAgentConfigurationImpl)configuration).isScanResources()) {
      this.notifier.addResourceChangeMonitor(ResourceFactory.getResourceChangeScannerService());
      this.monitor=true;
    }
  }
  if (this.monitor) {
    this.queue=new LinkedBlockingQueue<ChangeSet>();
    thread=new Thread(this);
    thread.start();
  }
  buildResourceMapping(kbase);
}
