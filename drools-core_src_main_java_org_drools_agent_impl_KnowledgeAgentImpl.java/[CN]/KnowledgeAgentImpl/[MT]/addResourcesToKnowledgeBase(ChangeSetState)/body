{
  if (changeSetState.addedResources.size() > 0) {
    KnowledgeBuilder builder=createKBuilder();
    for (    Resource resource : changeSetState.addedResources) {
      Collection<KnowledgePackage> createdPackages=this.createPackageFromResource(resource,builder);
      Set<KnowledgePackage> packs=changeSetState.createdPackages.get(resource);
      if (packs == null) {
        packs=new HashSet<KnowledgePackage>();
        changeSetState.createdPackages.put(resource,packs);
      }
      packs.addAll(createdPackages);
    }
  }
  for (  Resource resource : changeSetState.createdPackages.keySet()) {
    this.kbase.addKnowledgePackages(changeSetState.createdPackages.get(resource));
  }
  autoBuildResourceMapping();
}
