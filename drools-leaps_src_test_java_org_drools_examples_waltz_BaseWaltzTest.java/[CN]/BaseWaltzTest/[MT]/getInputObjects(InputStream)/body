{
  final List list=new ArrayList();
  final BufferedReader br=new BufferedReader(new InputStreamReader(inputStream));
  String line;
  while ((line=br.readLine()) != null) {
    if (line.trim().length() == 0 || line.trim().startsWith(";")) {
      continue;
    }
    final StringTokenizer st=new StringTokenizer(line,"() ");
    final String type=st.nextToken();
    if ("line".equals(type)) {
      if (!"p1".equals(st.nextToken())) {
        throw new IOException("expected 'p1' in: " + line);
      }
      final int p1=Integer.parseInt(st.nextToken(),10);
      if (!"p2".equals(st.nextToken())) {
        throw new IOException("expected 'p2' in: " + line);
      }
      final int p2=Integer.parseInt(st.nextToken(),10);
      list.add(new Line(p1,p2));
    }
    if ("stage".equals(type)) {
      if (!"value".equals(st.nextToken())) {
        throw new IOException("expected 'seat' in: " + line);
      }
      list.add(new Stage(Stage.resolveStageValue(st.nextToken())));
    }
  }
  inputStream.close();
  return list;
}
