{
  PackageBuilder builder=new PackageBuilder();
  builder.addPackageFromDrl(new InputStreamReader(MannersBenchmark.class.getResourceAsStream("manners.drl")));
  if (builder.hasErrors()) {
    throw new RuntimeException(builder.getErrors().toString());
  }
  Package pkg=builder.getPackage();
  RuleBaseConfiguration conf=new RuleBaseConfiguration();
  conf.setUnlinkingEnabled(true);
  final RuleBase ruleBase=RuleBaseFactory.newRuleBase(conf);
  ruleBase.addPackage(pkg);
  String filename;
  if (args.length != 0) {
    String arg=args[0];
    filename=arg;
  }
 else {
    filename="manners5.dat";
  }
  for (int i=0; i < 3; ++i) {
    InputStream is=MannersBenchmark.class.getResourceAsStream(filename);
    List list=getInputObjects(is);
    StatefulSession session=ruleBase.newStatefulSession();
    for (Iterator it=list.iterator(); it.hasNext(); ) {
      Object object=it.next();
      session.insert(object);
    }
    session.insert(new Count(1));
    long start=System.currentTimeMillis();
    session.fireAllRules();
    System.err.println(System.currentTimeMillis() - start);
    session.dispose();
  }
}
