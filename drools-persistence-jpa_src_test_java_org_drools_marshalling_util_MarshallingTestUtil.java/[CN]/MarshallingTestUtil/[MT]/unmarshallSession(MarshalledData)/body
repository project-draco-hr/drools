{
  KnowledgeBase kbase=(KnowledgeBase)DroolsStreamUtils.streamIn(marshalledData.serializedKnowledgeBase);
  Marshaller marshaller=MarshallerFactory.newMarshaller(kbase,new ObjectMarshallingStrategy[]{MarshallerFactory.newSerializeMarshallingStrategy()});
  ByteArrayInputStream bais=new ByteArrayInputStream(marshalledData.byteArray);
  SessionConfiguration conf=SessionConfiguration.getDefaultInstance();
  Environment env=EnvironmentFactory.newEnvironment();
  StatefulKnowledgeSession ksession=marshaller.unmarshall(bais,conf,env);
  return ksession;
}
