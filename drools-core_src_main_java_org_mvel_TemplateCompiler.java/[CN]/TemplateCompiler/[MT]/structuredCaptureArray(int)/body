{
  int start=cursor++ + 1;
  while (cursor < (length) && depth != 0) {
switch (expressionArray[cursor++]) {
case '@':
case '$':
      if (expressionArray[cursor] == '{') {
        cursor++;
        depth++;
      }
    break;
case '}':
  depth--;
break;
case '{':
depth++;
break;
}
}
if (depth > 0) {
throw new CompileException("unbalanced braces near: " + showCodeNearError() + " ("+ depth+ ")");
}
char[] array=new char[--cursor - start];
arraycopy(expressionArray,start,array,0,cursor - start);
return array;
}
