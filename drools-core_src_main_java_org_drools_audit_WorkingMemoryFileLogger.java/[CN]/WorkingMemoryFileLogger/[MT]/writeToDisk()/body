{
  if (!initialized) {
    initializeLog();
  }
  FileWriter fileWriter=null;
  try {
    fileWriter=new FileWriter(this.fileName + (this.nbOfFile == 0 ? ".log" : this.nbOfFile + ".log"),true);
    final XStream xstream=new XStream();
    for (    LogEvent event : this.events) {
      fileWriter.write(xstream.toXML(event) + "\n");
    }
    if (split) {
      this.nbOfFile++;
      initialized=false;
    }
    clear();
    fileWriter.write("</object-stream>");
  }
 catch (  final FileNotFoundException exc) {
    throw new RuntimeException("Could not create the log file.  Please make sure that directory that the log file should be placed in does exist.");
  }
catch (  final Throwable t) {
    t.printStackTrace(System.err);
  }
 finally {
    if (fileWriter != null) {
      try {
        fileWriter.close();
      }
 catch (      Exception e) {
      }
    }
  }
}
