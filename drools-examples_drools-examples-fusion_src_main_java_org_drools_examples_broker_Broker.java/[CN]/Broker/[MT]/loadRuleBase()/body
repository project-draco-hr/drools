{
  KnowledgeBuilder builder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  try {
    builder.add(ResourceFactory.newInputStreamResource(Broker.class.getResourceAsStream(RULES_FILE)),ResourceType.DRL);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (builder.hasErrors()) {
    System.err.println(builder.getErrors());
    System.exit(0);
  }
  KnowledgeBaseConfiguration conf=KnowledgeBaseFactory.newKnowledgeBaseConfiguration();
  conf.setOption(EventProcessingOption.STREAM);
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase(conf);
  kbase.addKnowledgePackages(builder.getKnowledgePackages());
  return kbase;
}
