{
  InternalWorkingMemory wm=newWorkingMemory();
  for (Iterator it=collection.iterator(); it.hasNext(); ) {
    wm.insert(it.next());
  }
  wm.fireAllRules(this.agendaFilter);
  GlobalResolver globalResolver=null;
  if (this.globalExporter != null) {
    globalResolver=this.globalExporter.export(wm);
  }
  return new ReteStatelessSessionResult(wm,globalResolver);
}
