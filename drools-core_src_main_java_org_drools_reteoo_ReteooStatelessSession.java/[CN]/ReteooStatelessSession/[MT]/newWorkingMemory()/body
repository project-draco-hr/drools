{
synchronized (this.ruleBase.getPackagesMap()) {
    InternalWorkingMemory wm=new ReteooWorkingMemory(this.ruleBase.nextWorkingMemoryCounter(),this.ruleBase);
    wm.setGlobalResolver(this.globalResolver);
    wm.setWorkingMemoryEventSupport(this.workingMemoryEventSupport);
    wm.setAgendaEventSupport(this.agendaEventSupport);
    wm.setRuleFlowEventSupport(ruleFlowEventSupport);
    return wm;
  }
}
