{
  String text="package test_mvel;\n";
  text+="import org.drools.integrationtests.TestObject;\n";
  text+="import function org.drools.integrationtests.TestObject.array;\n";
  ;
  text+="no-loop true\n";
  text+="dialect \"mvel\"\n";
  text+="rule \"1\"\n";
  text+="salience 1\n";
  text+="when\n";
  text+="    $fact: TestObject()\n";
  text+="    eval($fact.checkHighestPriority(\"mvel\", 2))\n";
  text+="    eval($fact.stayHasDaysOfWeek(\"mvel\", false, new String[][]{{\"2008-04-01\", \"2008-04-10\"}}))\n";
  text+="then\n";
  text+="    $fact.applyValueAddPromo(1,2,3,4,\"mvel\");\n";
  text+="end";
  RuleBase ruleBase=RuleBaseFactory.newRuleBase();
  ruleBase.addPackage(compileRule(text.replaceAll("mvel","java")));
  ruleBase.addPackage(compileRule(text));
  List<String> list=new ArrayList<String>();
  ruleBase.newStatelessSession().execute(new TestObject(list));
  assertEquals(6,list.size());
  assertEquals("TestObject.checkHighestPriority: java|2",list.get(0));
  assertEquals("TestObject.stayHasDaysOfWeek: java|false|[2008-04-01, 2008-04-10]",list.get(1));
  assertEquals("TestObject.checkHighestPriority: mvel|2",list.get(2));
  assertEquals("TestObject.stayHasDaysOfWeek: mvel|false|[2008-04-01, 2008-04-10]",list.get(3));
  assertEquals("TestObject.applyValueAddPromo: 1|2|3|4|java",list.get(4));
  assertEquals("TestObject.applyValueAddPromo: 1|2|3|4|mvel",list.get(5));
}
