{
  T thing;
  if (trait.isAssignableFrom(inner.getClass())) {
    thing=(T)inner;
    inner.addTrait(trait.getName(),(Thing<K>)core);
    needsUpdate=true;
  }
 else   if (inner.hasTrait(trait.getName())) {
    return (T)inner.getTrait(trait.getName());
  }
 else {
    thing=(T)builder.getProxy(inner,trait);
  }
  if (needsUpdate) {
    this.update(getFactHandle(core),inner);
  }
  if (!inner.hasTrait(Thing.class.getName())) {
    don(inner,Thing.class,logical);
  }
  return thing;
}
