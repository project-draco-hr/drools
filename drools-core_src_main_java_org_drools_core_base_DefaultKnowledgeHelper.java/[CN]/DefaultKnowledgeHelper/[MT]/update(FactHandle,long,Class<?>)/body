{
  InternalFactHandle h=(InternalFactHandle)handle;
  ((NamedEntryPoint)h.getEntryPoint()).update(h,h.getEqualityKey() != null && h.getEqualityKey().getStatus() == EqualityKey.JUSTIFIED,((InternalFactHandle)handle).getObject(),mask,modifiedClass,this.activation);
  if (h.isTraitOrTraitable()) {
    if (h.isTraitable()) {
      if (((TraitableBean)h.getObject()).hasTraits()) {
        updateTraits(h.getObject(),mask,null,modifiedClass,null,((TraitableBean)h.getObject()).getMostSpecificTraits());
      }
    }
 else     if (h.isTraiting()) {
      Thing x=(Thing)h.getObject();
      if (x != x.getCore()) {
        Object core=x.getCore();
        InternalFactHandle coreHandle=(InternalFactHandle)getFactHandle(core);
        ((NamedEntryPoint)coreHandle.getEntryPoint()).update(coreHandle,coreHandle.getEqualityKey() != null && coreHandle.getEqualityKey().getStatus() == EqualityKey.JUSTIFIED,core,mask,modifiedClass,this.activation);
        BitSet veto=((TraitProxy)x).getTypeCode();
        updateTraits(core,mask,x,modifiedClass,veto,((TraitableBean)core).getMostSpecificTraits());
      }
    }
  }
}
