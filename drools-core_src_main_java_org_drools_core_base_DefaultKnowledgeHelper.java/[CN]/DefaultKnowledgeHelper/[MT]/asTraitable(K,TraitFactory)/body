{
  if (core instanceof Map) {
    return new MapCore((Map)core);
  }
  CoreWrapper<K> wrapper=builder.getCoreWrapper(core.getClass());
  if (wrapper == null) {
    throw new UnsupportedOperationException("Error: cannot apply a trait to non-traitable class " + core.getClass());
  }
  wrapper.init(core);
  return wrapper;
}
