{
  final KieBaseModelImpl kBase=new KieBaseModelImpl();
  kBase.setName(reader.getAttribute("name"));
  String eventMode=reader.getAttribute("eventProcessingMode");
  if (eventMode != null) {
    kBase.setEventProcessingMode(EventProcessingOption.determineEventProcessingMode(eventMode));
  }
  String equalsBehavior=reader.getAttribute("equalsBehavior");
  if (equalsBehavior != null) {
    kBase.setEqualsBehavior(AssertBehaviorOption.valueOf(equalsBehavior.toUpperCase()));
  }
  String pkgs=reader.getAttribute("packages");
  if (pkgs != null) {
    for (    String pkg : pkgs.split(",")) {
      kBase.addPackage(pkg.trim());
    }
  }
  readNodes(reader,new AbstractXStreamConverter.NodeReader(){
    public void onNode(    HierarchicalStreamReader reader,    String name,    String value){
      if ("ksessions".equals(name)) {
        Map<String,KieSessionModel> kSessions=new HashMap<String,KieSessionModel>();
        for (        KieSessionModelImpl kSession : readObjectList(reader,context,KieSessionModelImpl.class)) {
          kSession.setKBase(kBase);
          kSessions.put(kSession.getName(),kSession);
        }
        kBase.setKSessions(kSessions);
      }
 else       if ("includes".equals(name)) {
        for (        String include : readList(reader)) {
          kBase.addInclude(include);
        }
      }
    }
  }
);
  return kBase;
}
