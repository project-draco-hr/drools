{
  if (this.tupleSource == null) {
    this.currentOffsetAdjustment=1;
    final ObjectSource auxObjectSource=attachNode(new ObjectTypeNode(this.id++,new ClassObjectType(InitialFact.class),this.rete));
    this.tupleSource=attachNode(new LeftInputAdapterNode(this.id++,auxObjectSource));
  }
  final Column sourceColumn=collect.getSourceColumn();
  final BetaConstraints sourceBinder=attachColumn(sourceColumn,parent,true);
  Column column=collect.getResultColumn();
  column.adjustOffset(this.currentOffsetAdjustment);
  final List constraints=column.getConstraints();
  if (column.getDeclaration() != null) {
    final Declaration declaration=column.getDeclaration();
    this.declarations.put(declaration.getIdentifier(),declaration);
  }
  final List betaConstraints=new ArrayList();
  final List alphaConstraints=new ArrayList();
  for (final Iterator it=constraints.iterator(); it.hasNext(); ) {
    final Object object=it.next();
    if (object instanceof Declaration) {
      final Declaration declaration=(Declaration)object;
      this.declarations.put(declaration.getIdentifier(),declaration);
      continue;
    }
    final AlphaNodeFieldConstraint fieldConstraint=(AlphaNodeFieldConstraint)object;
    if (fieldConstraint instanceof LiteralConstraint) {
      alphaConstraints.add(fieldConstraint);
    }
 else {
      checkUnboundDeclarations(fieldConstraint.getRequiredDeclarations());
      betaConstraints.add(fieldConstraint);
    }
  }
  BetaConstraints resultsBinder=createBetaNodeConstraint(betaConstraints);
  this.tupleSource=attachNode(new CollectNode(id++,this.tupleSource,this.objectSource,(AlphaNodeFieldConstraint[])alphaConstraints.toArray(new AlphaNodeFieldConstraint[alphaConstraints.size()]),sourceBinder,resultsBinder,collect));
}
