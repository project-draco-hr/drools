{
  RuleSetDef def=new RuleSetDef("para",null);
  def.addRule(new RuleDef("para1","sss"));
  RepositoryManager repo=getRepo();
  repo.save(def);
  def=repo.loadRuleSet("para",1);
  def.createNewVersion("yeah");
  repo.save(def);
  RuleSetDef old=repo.loadRuleSet("para",1);
  RuleSetDef newRs=repo.loadRuleSet("para",2);
  assertEquals(1,old.getRules().size());
  assertEquals(1,newRs.getRules().size());
  newRs.addRule(new RuleDef("para2","xxx"));
  newRs.addTag("HR");
  repo.save(newRs);
  newRs=repo.loadRuleSet("para",2);
  old=repo.loadRuleSet("para",1);
  assertEquals(2,newRs.getRules().size());
  assertEquals(1,old.getRules().size());
  RuleDef originalRule=(RuleDef)old.getRules().iterator().next();
  assertEquals(1,originalRule.getVersionNumber());
  assertEquals(1,old.getRules().size());
  repo.delete(originalRule);
  old=repo.loadRuleSet("para",1);
  assertEquals(0,old.getRules().size());
}
