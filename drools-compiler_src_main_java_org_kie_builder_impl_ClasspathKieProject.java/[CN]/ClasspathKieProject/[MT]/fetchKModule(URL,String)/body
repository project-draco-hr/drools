{
  KieModuleModel kieProject=KieModuleModelImpl.fromXML(url);
  setDefaultsforEmptyKieModule(kieProject);
  String pomProperties=getPomProperties(fixedURL);
  ReleaseId releaseId=ReleaseIdImpl.fromPropertiesString(pomProperties);
  String rootPath=fixedURL;
  if (rootPath.lastIndexOf(':') > 0) {
    rootPath=fixedURL.substring(rootPath.lastIndexOf(':') + 1);
  }
  InternalKieModule kJar;
  File file=new File(rootPath);
  if (fixedURL.endsWith(".jar")) {
    kJar=new ZipKieModule(releaseId,kieProject,file);
  }
 else   if (file.isDirectory()) {
    kJar=new FileKieModule(releaseId,kieProject,file);
  }
 else {
    log.error("Unable to build index of kmodule.xml url=" + url.toExternalForm() + "\n");
    kJar=null;
  }
  return kJar;
}
