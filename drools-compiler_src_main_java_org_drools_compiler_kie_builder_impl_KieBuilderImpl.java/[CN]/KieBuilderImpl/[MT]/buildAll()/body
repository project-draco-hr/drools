{
  if (!isBuilt() && releaseId != null && kModuleModel != null) {
    trgMfs=new MemoryFileSystem();
    writePomAndKModule();
    compileJavaClasses();
    addKBasesFilesToTrg();
    kModule=new MemoryKieModule(releaseId,kModuleModel,trgMfs);
    if (dependencies != null && !dependencies.isEmpty()) {
      for (      KieModule kieModule : dependencies) {
        kModule.addDependency((InternalKieModule)kieModule);
      }
    }
    if (buildKieModule(kModule,results)) {
      Map<String,TypeDeclaration> typeDeclarations=addTypeDeclarationClassesToTrg();
      writeTypeMetaInfosToTrg(typeDeclarations);
    }
  }
  return this;
}
