{
  Graph<BayesVariable> graph=new BayesNetwork();
  JunctionTreeBuilder tbuilder=new JunctionTreeBuilder(graph);
  GraphNode<BayesVariable> x0=addNode(graph);
  GraphNode<BayesVariable> x1=addNode(graph);
  GraphNode<BayesVariable> x2=addNode(graph);
  GraphNode<BayesVariable> x3=addNode(graph);
  GraphNode<BayesVariable> x4=addNode(graph);
  GraphNode<BayesVariable> x5=addNode(graph);
  GraphNode<BayesVariable> x6=addNode(graph);
  GraphNode<BayesVariable> x7=addNode(graph);
  connectChildToParents(x1,x2,x3);
  connectChildToParents(x3,x6,x7);
  OpenBitSet clique0=bitSet("01001110");
  OpenBitSet clique1=bitSet("11001110");
  OpenBitSet clique2=bitSet("11101000");
  OpenBitSet clique3=bitSet("00010011");
  JunctionTreeClique jtNode0=new JunctionTreeClique(0,graph,clique0);
  JunctionTreeClique jtNode1=new JunctionTreeClique(1,graph,clique1);
  JunctionTreeClique jtNode2=new JunctionTreeClique(2,graph,clique2);
  JunctionTreeClique jtNode3=new JunctionTreeClique(3,graph,clique3);
  JunctionTreeClique[] jtNodes=new JunctionTreeClique[]{jtNode0,jtNode1,jtNode2,jtNode3};
  OpenBitSet[] nodeToCliques=new OpenBitSet[8];
  tbuilder.mapVarNodeToCliques(nodeToCliques,0,clique0);
  tbuilder.mapVarNodeToCliques(nodeToCliques,1,clique1);
  tbuilder.mapVarNodeToCliques(nodeToCliques,2,clique2);
  tbuilder.mapVarNodeToCliques(nodeToCliques,3,clique3);
  tbuilder.mapNodeToCliqueFamily(nodeToCliques,jtNodes);
  assertEquals(3,x0.getContent().getFamily());
  assertEquals(0,x1.getContent().getFamily());
  assertEquals(0,x2.getContent().getFamily());
  assertEquals(2,x3.getContent().getFamily());
  assertEquals(3,x4.getContent().getFamily());
  assertEquals(2,x5.getContent().getFamily());
  assertEquals(0,x6.getContent().getFamily());
  assertEquals(2,x7.getContent().getFamily());
}
