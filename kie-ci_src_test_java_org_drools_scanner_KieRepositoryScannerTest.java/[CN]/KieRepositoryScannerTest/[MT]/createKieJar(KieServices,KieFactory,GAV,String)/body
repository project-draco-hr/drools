{
  KieFileSystem kfs=kf.newKieFileSystem();
  for (  String rule : rules) {
    String file="org/test/" + rule + ".drl";
    kfs.write("src/main/resources/KBase1/" + file,createDRL(rule));
  }
  KieModuleModel kproj=kf.newKieModuleModel();
  KieBaseModel kieBaseModel1=kproj.newKieBaseModel("KBase1").setEqualsBehavior(AssertBehaviorOption.EQUALITY).setEventProcessingMode(EventProcessingOption.STREAM);
  KieSessionModel ksession1=kieBaseModel1.newKieSessionModel("KSession1").setType(KieSessionType.STATEFUL).setClockType(ClockTypeOption.get("realtime"));
  kfs.writeKModuleXML(kproj.toXML());
  kfs.writePomXML(getPom(gav));
  KieBuilder kieBuilder=ks.newKieBuilder(kfs);
  assertTrue(kieBuilder.build().getInsertedMessages().isEmpty());
  return (InternalKieModule)kieBuilder.getKieModule();
}
