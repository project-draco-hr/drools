{
  final Rule rule=new Rule("match_edge");
  final Column stageColumn=new Column(0,this.stageType,"stage");
  stageColumn.addConstraint(getLiteralConstraint(stageColumn,"value",new Integer(Stage.LABELING),this.integerEqualEvaluator));
  rule.addPattern(stageColumn);
  final Column edgeColumn1plus=new Column(1,this.edgeType,"edge1");
  edgeColumn1plus.addConstraint(getLiteralConstraint(edgeColumn1plus,"label",Edge.PLUS,this.objectEqualEvaluator));
  setFieldDeclaration(edgeColumn1plus,"p1","edge1p1");
  setFieldDeclaration(edgeColumn1plus,"p2","edge1p2");
  final Column edgeColumn1minus=new Column(1,this.edgeType,"edge1");
  edgeColumn1minus.addConstraint(getLiteralConstraint(edgeColumn1minus,"label",Edge.MINUS,this.objectEqualEvaluator));
  setFieldDeclaration(edgeColumn1minus,"p1","edge1p1");
  setFieldDeclaration(edgeColumn1minus,"p2","edge1p2");
  final Column edgeColumn1b=new Column(1,this.edgeType,"edge1");
  edgeColumn1b.addConstraint(getLiteralConstraint(edgeColumn1b,"label",Edge.B,this.objectEqualEvaluator));
  setFieldDeclaration(edgeColumn1b,"p1","edge1p1");
  setFieldDeclaration(edgeColumn1b,"p2","edge1p2");
  final Or or=new Or();
  or.addChild(edgeColumn1plus);
  or.addChild(edgeColumn1minus);
  or.addChild(edgeColumn1b);
  rule.addPattern(or);
  final Declaration edge1Declaration=rule.getDeclaration("edge1");
  final Declaration edge1P1Declaration=rule.getDeclaration("edge1p1");
  final Declaration edge1P2Declaration=rule.getDeclaration("edge1p2");
  final Column edgeColumn2=new Column(2,this.edgeType,"edge2");
  edgeColumn2.addConstraint(getLiteralConstraint(edgeColumn2,"label",Edge.NIL,this.objectEqualEvaluator));
  rule.addPattern(edgeColumn2);
  final Declaration edge2Declaration=rule.getDeclaration("edge2");
  edgeColumn2.addConstraint(getBoundVariableConstraint(edgeColumn2,"p1",edge1P2Declaration,this.integerEqualEvaluator));
  edgeColumn2.addConstraint(getBoundVariableConstraint(edgeColumn2,"p2",edge1P1Declaration,this.integerEqualEvaluator));
  final Consequence consequence=new Consequence(){
    public void evaluate(    KnowledgeHelper drools,    WorkingMemory workingMemory) throws ConsequenceException {
      try {
        Rule rule=drools.getRule();
        Tuple tuple=drools.getTuple();
        Edge edge1=(Edge)drools.get(edge1Declaration);
        edge1.setPlotted(Edge.TRUE);
        Edge edge2=(Edge)drools.get(edge2Declaration);
        edge2.setLabel(edge1.getLabel());
        edge2.setPlotted(Edge.TRUE);
        drools.modifyObject(tuple.get(edge1Declaration),edge1);
        drools.modifyObject(tuple.get(edge2Declaration),edge2);
        System.out.println("plot " + edge1.getLabel() + " "+ edge1.getP1()+ " "+ edge1.getP2());
      }
 catch (      Exception e) {
        e.printStackTrace();
        throw new ConsequenceException(e);
      }
    }
  }
;
  rule.setConsequence(consequence);
  return rule;
}
