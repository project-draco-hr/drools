{
  BetaMemory memory;
  if (this.indexed) {
    final VariableConstraint variableConstraint=(VariableConstraint)this.constraint;
    final FieldIndex index=new FieldIndex(variableConstraint.getFieldExtractor(),variableConstraint.getRequiredDeclarations()[0],variableConstraint.getEvaluator());
    LeftTupleMemory tupleMemory;
    if (this.conf.isIndexLeftBetaMemory()) {
      tupleMemory=new TupleIndexHashTable(new FieldIndex[]{index});
    }
 else {
      tupleMemory=new TupleHashTable();
    }
    FactHandleMemory factHandleMemory;
    if (this.conf.isIndexRightBetaMemory()) {
      factHandleMemory=new FactHandleIndexHashTable(new FieldIndex[]{index});
    }
 else {
      factHandleMemory=new FactHashTable();
    }
    memory=new BetaMemory(config.isSequential() ? null : tupleMemory,factHandleMemory,this.createContext());
  }
 else {
    memory=new BetaMemory(config.isSequential() ? null : new TupleHashTable(),new FactHashTable(),this.createContext());
  }
  return memory;
}
