{
  InputStream stream=RuleWorksheetParseTest.class.getResourceAsStream("/data/ComplexWorkbook.xls");
  RuleSheetListener listener=getRuleSheetListener(stream);
  Package ruleset=listener.getRuleSet();
  assertEquals(6,ruleset.getRules().size());
  assertEquals(0,ruleset.getImports().size());
  Rule rule=(Rule)ruleset.getRules().get(0);
  assertEquals(3,rule.getConditions().size());
  assertEquals(2,rule.getConsequences().size());
  Consequence cons=(Consequence)rule.getConsequences().get(1);
  assertEquals("myObject.setIsValid(1, 2)",cons.getSnippet());
  Condition con=(Condition)rule.getConditions().get(2);
  assertEquals("myObject.size() < 3",con.getSnippet());
  rule=(Rule)ruleset.getRules().get(4);
  assertEquals(1,rule.getConditions().size());
  rule=(Rule)ruleset.getRules().get(5);
  assertEquals(2,rule.getConditions().size());
  assertEquals(1,rule.getConsequences().size());
}
