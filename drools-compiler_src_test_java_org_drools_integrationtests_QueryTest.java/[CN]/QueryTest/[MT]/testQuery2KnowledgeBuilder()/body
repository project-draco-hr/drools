{
  final KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newClassPathResource("test_Query.drl",getClass()),ResourceType.DRL);
  KnowledgeBase kbase=kbuilder.newKnowledgeBase();
  kbase.addKnowledgePackages(kbase.getKnowledgePackages());
  if (kbuilder.hasErrors()) {
    fail(kbuilder.getErrors().toString());
  }
  kbase=SerializationHelper.serializeObject(kbase);
  final StatefulKnowledgeSession ksession=kbase.newStatefulKnowledgeSession();
  ksession.fireAllRules();
  final org.drools.runtime.rule.QueryResults results=ksession.getQueryResults("assertedobjquery");
  assertEquals(1,results.size());
  assertEquals(new InsertedObject("value1"),results.iterator().next().get("assertedobj"));
}
