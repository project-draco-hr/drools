{
  String str="";
  str+="package org.drools.compiler.test\n";
  str+="import " + A.class.getCanonicalName() + "\n";
  str+="global  " + List.class.getCanonicalName() + " list\n";
  str+="rule r0 when\n";
  str+="then\n";
  str+="    drools.getKnowledgeRuntime().getAgenda().getAgendaGroup( 'g1' ).setFocus();\n";
  str+="    drools.getKnowledgeRuntime().getAgenda().getAgendaGroup( 'g2' ).setFocus();\n";
  str+="    drools.getKnowledgeRuntime().getAgenda().getAgendaGroup( 'g1' ).setFocus();\n";
  str+="end\n";
  str+="rule r1 agenda-group 'g1' when\n";
  str+="    a : A( object > 0 )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="    modify(a) { setObject( 3 ) };\n";
  str+="end\n";
  str+="rule r1_x agenda-group 'g1' when\n";
  str+="    a : A( object == 2 )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r1_y agenda-group 'g1' when\n";
  str+="    a : A( object == 5 )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r2 agenda-group 'g1' when\n";
  str+="    a : A( object < 3 )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r3 agenda-group 'g1' when\n";
  str+="    a : A(object >= 3  )\n";
  str+="then\n";
  str+="    modify(a) { setObject( 5 ) };\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r4 agenda-group 'g1' when\n";
  str+="    a : A(object >= 3  )\n";
  str+="then\n";
  str+="    modify(a) { setObject( 5 ) };\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r6 agenda-group 'g2' when\n";
  str+="    a : A(object < 5  )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r7 agenda-group 'g2' when\n";
  str+="    a : A(object >= 3  )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r8 agenda-group 'g2' when\n";
  str+="    a : A(object >= 5  )\n";
  str+="then\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  str+="rule r9 agenda-group 'g2' when\n";
  str+="    a : A(object >= 5  )\n";
  str+="then\n";
  str+="    modify(a) { setObject( 2 ) };\n";
  str+="    list.add( drools.getRule().getName() );\n";
  str+="end\n";
  KnowledgeBase kbase=loadKnowledgeBaseFromString(kconf,str);
  StatelessKnowledgeSession ksession=createStatelessKnowledgeSession(kbase);
  final List list=new ArrayList();
  ksession.setGlobal("list",list);
  ksession.execute(CommandFactory.newInsertElements(Arrays.asList(new Object[]{new A(1)})));
  assertEquals(6,list.size());
  assertEquals("r1",list.get(0));
  assertEquals("r3",list.get(1));
  assertEquals("r4",list.get(2));
  assertEquals("r7",list.get(3));
  assertEquals("r8",list.get(4));
  assertEquals("r9",list.get(5));
}
