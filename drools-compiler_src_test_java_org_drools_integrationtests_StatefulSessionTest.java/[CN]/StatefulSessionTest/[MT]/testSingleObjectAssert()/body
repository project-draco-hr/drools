{
  StatefulKnowledgeSession session=getSession();
  final Cheese stilton=new Cheese("stilton",5);
  Future futureAssert=session.asyncInsert(stilton);
  Future futureFireAllRules=session.asyncFireAllRules();
  int i=0;
  while (!futureFireAllRules.isDone()) {
    Thread.sleep(100);
    if (i++ > 5) {
      fail("Future should have finished by now");
    }
  }
  assertTrue(futureAssert.get() instanceof FactHandle);
  assertEquals("stilton",list.get(0));
}
