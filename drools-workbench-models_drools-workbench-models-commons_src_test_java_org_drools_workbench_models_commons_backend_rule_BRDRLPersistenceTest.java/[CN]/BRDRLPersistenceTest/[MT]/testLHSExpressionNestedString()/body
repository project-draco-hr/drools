{
  RuleModel m=new RuleModel();
  m.name="test expressionsNestedString";
  FactPattern p=new FactPattern("Person");
  SingleFieldConstraintEBLeftSide con=new SingleFieldConstraintEBLeftSide();
  con.getExpressionLeftSide().appendPart(new ExpressionUnboundFact(p));
  con.getExpressionLeftSide().appendPart(new ExpressionField("favouriteCheese","Cheese",DataType.TYPE_OBJECT));
  con.getExpressionLeftSide().appendPart(new ExpressionField("name","java.lang.String",DataType.TYPE_STRING));
  con.setOperator("==");
  con.setValue("Cheedar");
  con.setConstraintValueType(SingleFieldConstraint.TYPE_LITERAL);
  p.addConstraint(con);
  m.addLhsItem(p);
  String expected="rule \"test expressionsNestedString\"" + "\tdialect \"mvel\"\n when " + "     Person( favouriteCheese.name == \"Cheedar\" )"+ " then "+ "end";
  PackageDataModelOracle dmo=mock(PackageDataModelOracle.class);
  when(dmo.getModelFields()).thenReturn(new HashMap<String,ModelField[]>(){
{
      put("Person",new ModelField[]{new ModelField("favouriteCheese","Cheese",ModelField.FIELD_CLASS_TYPE.TYPE_DECLARATION_CLASS,ModelField.FIELD_ORIGIN.DECLARED,FieldAccessorsAndMutators.BOTH,"Cheese")});
      put("Cheese",new ModelField[]{new ModelField("name","String",ModelField.FIELD_CLASS_TYPE.TYPE_DECLARATION_CLASS,ModelField.FIELD_ORIGIN.DECLARED,FieldAccessorsAndMutators.BOTH,"String")});
    }
  }
);
  when(dmo.getAllFactTypes()).thenReturn(new String[]{"Person","Cheese"});
  checkMarshallUnmarshall(expected,m,dmo);
}
