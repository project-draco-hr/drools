{
  Message msg=(Message)object;
  systemEventListener.debug("Message receieved on server : " + msg);
  try {
    if (msg.getSessionId() == -1) {
      GenericCommand cmd=(GenericCommand)msg.getPayload();
      Context ctx=new ServiceManagerServerContext(null,server);
      int sessionId=(Integer)cmd.execute(ctx);
      session.write(new Message(sessionId,msg.getResponseId(),false,null,sessionId));
      return;
    }
  }
 catch (  RuntimeException e) {
    systemEventListener.exception(e.getMessage(),e);
  }
 finally {
  }
  List<GenericCommand> commands;
  if (msg.getPayload() instanceof List) {
    commands=(List<GenericCommand>)msg.getPayload();
  }
 else {
    commands=new ArrayList<GenericCommand>();
    commands.add((GenericCommand)msg.getPayload());
  }
  ContextImpl localSessionContext=new ContextImpl("sesseion_" + msg.getSessionId(),this.server.getContextManager(),this.server.getTemp());
  ExecutionResultImpl localKresults=new ExecutionResultImpl();
  localSessionContext.set("kresults_" + msg.getSessionId(),localKresults);
  for (  GenericCommand cmd : commands) {
    cmd.execute(localSessionContext);
  }
  if (!msg.isAsync() && localKresults.getIdentifiers().isEmpty()) {
    session.write(new Message(msg.getSessionId(),msg.getResponseId(),msg.isAsync(),null,new FinishedCommand()));
  }
 else {
    session.write(new Message(msg.getSessionId(),msg.getResponseId(),msg.isAsync(),null,localKresults));
  }
}
