{
  RuleModel m=new RuleModel();
  m.name="WorkItem";
  FactPattern fp1=new FactPattern("Person");
  fp1.setBoundName("$p");
  SingleFieldConstraint con1=new SingleFieldConstraint();
  con1.setFieldType(DataType.TYPE_STRING);
  con1.setFieldName("name");
  con1.setOperator("==");
  con1.setValue("Michael");
  con1.setConstraintValueType(SingleFieldConstraint.TYPE_LITERAL);
  fp1.addConstraint(con1);
  m.addLhsItem(fp1);
  ActionExecuteWorkItem awi=new ActionExecuteWorkItem();
  PortableWorkDefinition pwd=new PortableWorkDefinition();
  pwd.setName("WorkItem");
  awi.setWorkDefinition(pwd);
  PortableBooleanParameterDefinition p1=new PortableBooleanParameterDefinition();
  p1.setName("BooleanParameter");
  p1.setBinding("$b2");
  p1.setValue(Boolean.TRUE);
  pwd.addParameter(p1);
  PortableFloatParameterDefinition p2=new PortableFloatParameterDefinition();
  p2.setName("FloatParameter");
  p2.setBinding("$f2");
  p2.setValue(123.456f);
  pwd.addParameter(p2);
  PortableIntegerParameterDefinition p3=new PortableIntegerParameterDefinition();
  p3.setName("IntegerParameter");
  p3.setBinding("$i2");
  p3.setValue(123);
  pwd.addParameter(p3);
  PortableStringParameterDefinition p4=new PortableStringParameterDefinition();
  p4.setName("StringParameter");
  p4.setBinding("$s2");
  p4.setValue("hello");
  pwd.addParameter(p4);
  m.addRhsItem(awi);
  String result=BRDRLPersistence.getInstance().marshal(m);
  assertTrue(result.indexOf("org.kie.internal.process.instance.WorkItemManager wim = (org.kie.internal.process.instance.WorkItemManager) drools.getWorkingMemory().getWorkItemManager();") != -1);
  assertTrue(result.indexOf("org.kie.internal.process.instance.impl.WorkItemImpl wiWorkItem = new org.kie.internal.process.instance.impl.WorkItemImpl();") != -1);
  assertFalse(result.indexOf("wiWorkItem.getParameters().put( \"BooleanParameter\", $b );") != -1);
  assertFalse(result.indexOf("wiWorkItem.getParameters().put( \"FloatParameter\", $f );") != -1);
  assertFalse(result.indexOf("wiWorkItem.getParameters().put( \"IntegerParameter\", $i );") != -1);
  assertFalse(result.indexOf("wiWorkItem.getParameters().put( \"StringParameter\", $s );") != -1);
  assertTrue(result.indexOf("wim.internalExecuteWorkItem( wiWorkItem );") != -1);
  checkMarshallUnmarshall(null,m);
}
