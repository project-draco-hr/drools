{
  this.pkg=pkg;
  this.methods=new ArrayList();
  this.invokers=new HashMap();
  this.invokerLookups=new HashMap();
  this.declarations=new HashMap();
  this.descrLookups=new HashMap();
  this.columnCounter=new ColumnCounter();
  this.typeResolver=new ClassTypeResolver(pkg.getImports(),pkg.getPackageCompilationData().getClassLoader());
  this.typeResolver.addImport(pkg.getName() + ".*");
  this.typeResolver.addImport("java.lang.*");
  this.ruleDescr=ruleDescr;
  if (ruleDescr instanceof QueryDescr) {
    this.rule=new Query(ruleDescr.getName());
  }
 else {
    this.rule=new Rule(ruleDescr.getName());
  }
  setAttributes(this.rule,ruleDescr.getAttributes());
  build(ruleDescr);
  return this.rule;
}
