{
  RulePackage rulePackage=data.getPackageByName(descr.getName());
  StringBuilder header=new StringBuilder();
  for (  ImportDescr i : descr.getImports()) {
    String fullPath=i.getTarget();
    String name=fullPath.substring(fullPath.lastIndexOf(".") + 1);
    header.append("import ");
    header.append(fullPath);
    header.append("\n");
    imports.put(name,fullPath);
    ObjectType objectType=this.data.getObjectTypeByFullName(fullPath);
    if (objectType == null)     objectType=new ObjectType();
    objectType.setName(name);
    objectType.setFullName(fullPath);
    data.add(objectType);
  }
  SuggestionCompletionLoader loader=new SuggestionCompletionLoader();
  SuggestionCompletionEngine engine=loader.getSuggestionEngine(header.toString(),jars,Collections.EMPTY_LIST);
  for (  String factTypeName : engine.getFactTypes()) {
    for (    String fieldName : engine.getFieldCompletions(factTypeName)) {
      ObjectType ot=this.data.getObjectTypeByFullName(imports.get(factTypeName));
      Field field=data.getFieldByObjectTypeAndFieldName(ot.getFullName(),fieldName);
      if (field == null) {
        field=createField(fieldName,ot);
        field.setFieldType(engine.getFieldType(ot.getName(),fieldName));
        data.add(field);
      }
    }
  }
  if (rulePackage == null) {
    rulePackage=new RulePackage();
    rulePackage.setName(descr.getName());
    data.add(rulePackage);
  }
  currentPackage=rulePackage;
  visit(descr.getRules(),rulePackage);
}
