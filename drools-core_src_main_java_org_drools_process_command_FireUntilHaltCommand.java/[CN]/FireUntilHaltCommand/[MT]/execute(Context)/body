{
  StatefulKnowledgeSession ksession=((KnowledgeCommandContext)context).getStatefulKnowledgesession();
  ReteooWorkingMemory session=((StatefulKnowledgeSessionImpl)ksession).session;
  if (agendaFilter != null) {
    session.fireUntilHalt(new StatefulKnowledgeSessionImpl.AgendaFilterWrapper(agendaFilter));
  }
 else {
    session.fireUntilHalt();
  }
  return null;
}
