{
  ProcessInstance processInstance=(ProcessInstance)createProcessInstance();
  processInstance.setWorkingMemory((InternalWorkingMemory)workingMemory);
  processInstance.setProcess(process);
  VariableScope variableScope=(VariableScope)((ContextContainer)process).getDefaultContext(VariableScope.VARIABLE_SCOPE);
  VariableScopeInstance variableScopeInstance=(VariableScopeInstance)processInstance.getContextInstance(VariableScope.VARIABLE_SCOPE);
  if (parameters != null) {
    if (variableScope != null) {
      for (      Map.Entry<String,Object> entry : parameters.entrySet()) {
        variableScopeInstance.setVariable(entry.getKey(),entry.getValue());
      }
    }
 else {
      throw new IllegalArgumentException("This process does not support parameters!");
    }
  }
  ((InternalWorkingMemory)workingMemory).getProcessInstanceManager().addProcessInstance(processInstance);
  return processInstance;
}
