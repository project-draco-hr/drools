{
  try {
    Workbook workbook=Workbook.getWorkbook(inStream);
    if (_useFirstSheet) {
      Sheet sheet=workbook.getSheet(0);
      processSheet(sheet,(List)_listners.get(DEFAULT_RULESHEET_NAME));
    }
 else {
      Set sheetNames=_listners.keySet();
      for (Iterator iter=sheetNames.iterator(); iter.hasNext(); ) {
        String sheetName=(String)iter.next();
        Sheet sheet=workbook.getSheet(sheetName);
        processSheet(sheet,(List)_listners.get(sheetName));
      }
    }
  }
 catch (  BiffException e) {
    throw new DecisionTableParseException("An error occured opening the workbook. ",e);
  }
catch (  IOException e) {
    throw new DecisionTableParseException("Failed to open Excel stream, " + "please check that the content is xls97 format.",e);
  }
}
