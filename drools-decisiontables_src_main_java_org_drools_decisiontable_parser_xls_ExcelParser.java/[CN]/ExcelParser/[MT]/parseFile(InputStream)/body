{
  try {
    Workbook workbook=Workbook.getWorkbook(inStream);
    if (_useFirstSheet) {
      Sheet sheet=workbook.getSheet(0);
      processSheet(sheet,_listeners.get(DEFAULT_RULESHEET_NAME));
    }
 else {
      for (      String sheetName : _listeners.keySet()) {
        Sheet sheet=workbook.getSheet(sheetName);
        processSheet(sheet,_listeners.get(sheetName));
      }
    }
  }
 catch (  BiffException e) {
    throw new DecisionTableParseException("An error occured opening the workbook. It is possible that the encoding of the document did not match the encoding of the reader.",e);
  }
catch (  IOException e) {
    throw new DecisionTableParseException("Failed to open Excel stream, " + "please check that the content is xls97 format.",e);
  }
}
