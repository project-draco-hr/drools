{
  int maxRows=sheet.getRows();
  Range[] mergedRanges=sheet.getMergedCells();
  for (int i=0; i < maxRows; i++) {
    Cell[] row=sheet.getRow(i);
    listener.newRow(i,row.length);
    for (int cellNum=0; cellNum < row.length; cellNum++) {
      Cell cell=row[cellNum];
      Range merged=getRangeIfMerged(cell,mergedRanges);
      if (merged != null) {
        Cell topLeft=merged.getTopLeft();
        listener.newCell(i,cellNum,topLeft.getContents(),topLeft.getColumn());
      }
 else {
        listener.newCell(i,cellNum,cell.getContents(),SheetListener.NON_MERGED);
      }
    }
  }
  listener.finishSheet();
}
