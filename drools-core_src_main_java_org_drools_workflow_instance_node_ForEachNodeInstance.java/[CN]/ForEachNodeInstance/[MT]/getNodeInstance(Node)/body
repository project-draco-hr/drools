{
  if (node instanceof ForEachSplitNode) {
    ForEachSplitNodeInstance nodeInstance=new ForEachSplitNodeInstance();
    nodeInstance.setNodeId(node.getId());
    nodeInstance.setNodeInstanceContainer(this);
    nodeInstance.setProcessInstance(getProcessInstance());
    return nodeInstance;
  }
 else   if (node instanceof ForEachJoinNode) {
    ForEachJoinNodeInstance nodeInstance=(ForEachJoinNodeInstance)getFirstNodeInstance(node.getId());
    if (nodeInstance == null) {
      nodeInstance=new ForEachJoinNodeInstance();
      nodeInstance.setNodeId(node.getId());
      nodeInstance.setNodeInstanceContainer(this);
      nodeInstance.setProcessInstance(getProcessInstance());
    }
    return nodeInstance;
  }
  return super.getNodeInstance(node);
}
