{
  Field field=data.getFieldByClassAndFieldName(currentClass.getName(),descr.getFieldName());
  if (field == null) {
    field=createField(descr.getFieldName(),descr.getLine(),currentClass.getId(),currentClass.getName());
    data.add(field);
  }
  currentField=field;
  Constraint constraint=new Constraint();
  constraint.setRuleId(currentRule.getId());
  constraint.setFieldId(currentField.getId());
  constraint.setFieldName(currentField.getName());
  constraint.setPatternId(currentPattern.getId());
  constraint.setPatternIsNot(currentPattern.isPatternNot());
  constraint.setFieldId(field.getId());
  constraint.setOrderNumber(orderNumber);
  constraint.setParent(parent);
  data.add(constraint);
  currentConstraint=constraint;
  flatten(descr.getRestriction(),constraint,0);
}
