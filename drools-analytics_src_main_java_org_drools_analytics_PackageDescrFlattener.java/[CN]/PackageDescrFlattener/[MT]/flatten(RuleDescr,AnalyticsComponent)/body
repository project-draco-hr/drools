{
  AnalyticsData data=AnalyticsDataFactory.getAnalyticsData();
  AnalyticsRule rule=new AnalyticsRule();
  currentRule=rule;
  rule.setRuleName(descr.getName());
  rule.setRuleSalience(descr.getSalience());
  rule.setConsequence(flattenConsequence(rule,descr.getConsequence()));
  rule.setLineNumber(descr.getLine());
  rule.setPackageId(currentPackage.getId());
  rule.setParent(parent);
  data.save(rule);
  currentPackage.getRules().add(rule);
  solvers.startRuleSolver(rule);
  flatten(descr.getLhs(),rule,0);
  solvers.endRuleSolver();
}
