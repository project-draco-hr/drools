{
  String name=pkgFile.getName();
  if (!(name.endsWith(".pkg") || name.endsWith(".drl") || name.endsWith(".xls"))) {
    return null;
  }
  if (pkgFile.getName().endsWith(".drl")) {
    try {
      FileLoader fl=(FileLoader)Class.forName("org.drools.compiler.SourcePackageProvider").newInstance();
      return fl.loadPackage(pkgFile);
    }
 catch (    Exception e) {
      this.listener.exception(e);
      return null;
    }
  }
 else   if (pkgFile.getName().endsWith(".xls")) {
    try {
      FileLoader fl=(FileLoader)Class.forName("org.drools.decisiontable.SourcePackageProvider").newInstance();
      return fl.loadPackage(pkgFile);
    }
 catch (    Exception e) {
      this.listener.exception(e);
      return null;
    }
  }
 else {
    Object o=null;
    try {
      FileInputStream fis=new FileInputStream(pkgFile);
      o=DroolsStreamUtils.streamIn(fis);
      fis.close();
    }
 catch (    FileNotFoundException e) {
      this.listener.exception(e);
      this.listener.warning("Was unable to find the file " + pkgFile.getPath());
    }
catch (    IOException e) {
      this.listener.exception(e);
    }
catch (    ClassNotFoundException e) {
      this.listener.exception(e);
      this.listener.warning("Was unable to load a class when loading a package. Perhaps it is missing from this application.");
    }
    if (o instanceof KnowledgePackageImp) {
      return ((KnowledgePackageImp)o).pkg;
    }
 else {
      return (Package)o;
    }
  }
}
