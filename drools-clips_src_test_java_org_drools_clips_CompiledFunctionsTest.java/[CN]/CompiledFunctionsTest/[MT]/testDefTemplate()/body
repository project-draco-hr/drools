{
  Deffunction engine=(Deffunction)parse("(deffunction factorial (?n) (if (>= ?n 1) then (* ?n (factorial (- ?n 1))) else 1)) ").deffunction();
  ExecutionContext context=new ExecutionContextImpl(null,null,1);
  ByteArrayOutputStream bais=new ByteArrayOutputStream();
  context.addPrintoutRouter("d",new PrintStream(bais));
  assertEquals(720,engine.execute(new ValueHandler[]{new LongValueHandler(6)},context).getBigDecimalValue(context).longValue());
}
