{
  lock();
  try {
    final Package pkg=this.pkgs.get(packageName);
    if (pkg == null) {
      throw new IllegalArgumentException("Package name '" + packageName + "' does not exist for this Rule Base.");
    }
    this.removalsSinceLock++;
    this.eventSupport.fireBeforePackageRemoved(pkg);
    final Rule[] rules=pkg.getRules();
    for (int i=0; i < rules.length; ++i) {
      removeRule(pkg,rules[i]);
    }
    final Set<String> referencedGlobals=new HashSet<String>();
    for (    Package pkgref : this.pkgs.values()) {
      if (pkgref != pkg) {
        referencedGlobals.addAll(pkgref.getGlobals().keySet());
      }
    }
    for (    String globalName : pkg.getGlobals().keySet()) {
      if (!referencedGlobals.contains(globalName)) {
        this.globals.remove(globalName);
      }
    }
    final Map flows=pkg.getRuleFlows();
    for (final Iterator iter=flows.keySet().iterator(); iter.hasNext(); ) {
      removeProcess((String)iter.next());
    }
    this.pkgs.remove(pkg.getName());
    pkg.getDialectRuntimeRegistry().onRemove();
    pkg.clear();
    this.eventSupport.fireAfterPackageRemoved(pkg);
  }
  finally {
    unlock();
  }
}
