{
  String snip="Today before [date of] 10-Jul-2006 [the end] x";
  String[][] dict={{"before","${left}.before(${right})"},{"date of","dateOf(${1})"},{"Today","(new Date())"},{"the end","<<.yeah(${right})"}};
  NaturalSnippetLexer lex=new SimpleSnippetLexer(snip);
  ExpressionContext ctx=new ExpressionContext(grammarFrom(dict));
  ctx.addTokens(lex.getRawTokens());
  assertEquals("(new Date()).before(dateOf(10-Jul-2006)).yeah(x)",ctx.render());
}
