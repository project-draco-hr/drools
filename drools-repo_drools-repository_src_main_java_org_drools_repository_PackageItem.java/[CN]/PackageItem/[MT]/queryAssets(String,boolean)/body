{
  try {
    String sql="SELECT * FROM " + AssetItem.RULE_NODE_TYPE_NAME;
    sql+=" WHERE jcr:path LIKE '" + getVersionContentNode().getPath() + "/"+ ASSET_FOLDER_NAME+ "[%]/%'";
    if (fieldPredicates.length() > 0) {
      sql+=" and " + fieldPredicates;
    }
    if (!seekArchived) {
      sql+=" AND " + AssetItem.CONTENT_PROPERTY_ARCHIVE_FLAG + " = 'false'";
    }
    sql+=" ORDER BY " + AssetItem.TITLE_PROPERTY_NAME;
    Query q=node.getSession().getWorkspace().getQueryManager().createQuery(sql,Query.SQL);
    long time=System.currentTimeMillis();
    QueryResult res=q.execute();
    NodeIterator it=res.getNodes();
    long taken=System.currentTimeMillis() - time;
    if (taken > 2000) {
      log.debug("QueryExec time is: " + (System.currentTimeMillis() - time));
      log.debug("SQL is " + sql);
      log.debug(it.getClass().getName());
    }
    return new AssetItemIterator(it,this.rulesRepository);
  }
 catch (  RepositoryException e) {
    throw new RulesRepositoryException(e);
  }
}
