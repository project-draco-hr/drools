{
  final org.drools.core.rule.Package pkg1=new org.drools.core.rule.Package("org.droos.test");
  pkg1.setClassFieldAccessorCache(new ClassFieldAccessorCache(Thread.currentThread().getContextClassLoader()));
  pkg1.addGlobal("global1",Object.class);
  pkg1.addGlobal("global2",Object.class);
  final org.drools.core.rule.Package pkg2=new org.drools.core.rule.Package("org.droos.test");
  pkg2.setClassFieldAccessorCache(new ClassFieldAccessorCache(Thread.currentThread().getContextClassLoader()));
  pkg2.addGlobal("global1",Object.class);
  pkg2.addGlobal("global3",Object.class);
  final org.drools.core.rule.Package pkg3=new org.drools.core.rule.Package("org.droos.test2");
  pkg3.setClassFieldAccessorCache(new ClassFieldAccessorCache(Thread.currentThread().getContextClassLoader()));
  pkg3.addGlobal("global3",Object.class);
  pkg3.addGlobal("global4",Object.class);
  this.ruleBase.addPackage(pkg1);
  assertLength(1,this.ruleBase.getPackages());
  assertLength(2,this.ruleBase.getGlobals().values());
  assertLength(2,this.ruleBase.getPackages()[0].getGlobals().values());
  this.ruleBase.addPackage(pkg2);
  assertLength(1,this.ruleBase.getPackages());
  assertLength(3,this.ruleBase.getGlobals().values());
  assertLength(3,this.ruleBase.getPackages()[0].getGlobals().values());
  this.ruleBase.addPackage(pkg3);
  assertLength(2,this.ruleBase.getPackages());
  assertLength(4,this.ruleBase.getGlobals().values());
  final org.drools.core.rule.Package[] pkgs=this.ruleBase.getPackages();
  for (int i=0; i < pkgs.length; i++) {
    if (pkgs[i].getName().equals(pkg3.getName())) {
      assertLength(2,pkgs[i].getGlobals().values());
    }
  }
}
