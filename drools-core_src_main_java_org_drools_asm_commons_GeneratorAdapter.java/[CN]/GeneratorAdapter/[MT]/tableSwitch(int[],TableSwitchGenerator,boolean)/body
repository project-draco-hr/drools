{
  for (int i=1; i < keys.length; ++i) {
    if (keys[i] < keys[i - 1]) {
      throw new IllegalArgumentException("keys must be sorted ascending");
    }
  }
  final Label def=newLabel();
  final Label end=newLabel();
  if (keys.length > 0) {
    final int len=keys.length;
    final int min=keys[0];
    final int max=keys[len - 1];
    final int range=max - min + 1;
    if (useTable) {
      final Label[] labels=new Label[range];
      Arrays.fill(labels,def);
      for (int i=0; i < len; ++i) {
        labels[keys[i] - min]=newLabel();
      }
      this.mv.visitTableSwitchInsn(min,max,def,labels);
      for (int i=0; i < range; ++i) {
        final Label label=labels[i];
        if (label != def) {
          mark(label);
          generator.generateCase(i + min,end);
        }
      }
    }
 else {
      final Label[] labels=new Label[len];
      for (int i=0; i < len; ++i) {
        labels[i]=newLabel();
      }
      this.mv.visitLookupSwitchInsn(def,keys,labels);
      for (int i=0; i < len; ++i) {
        mark(labels[i]);
        generator.generateCase(keys[i],end);
      }
    }
  }
  mark(def);
  generator.generateDefault();
  mark(end);
}
