{
  final FileInputStream fin=new FileInputStream(rm);
  final SpreadsheetCompiler converter=new SpreadsheetCompiler();
  String drl=converter.compile(fin,InputType.XLS);
  fin.close();
  PackageBuilder b=new PackageBuilder();
  try {
    b.addPackageFromDrl(new StringReader(drl));
    if (b.hasErrors()) {
      throw new RuntimeDroolsException("Error building rules from source: " + b.getErrors());
    }
 else {
      return b.getPackage();
    }
  }
 catch (  DroolsParserException e) {
    throw new RuntimeException(e);
  }
}
