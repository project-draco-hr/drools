{
  for (Iterator iter=mappings.iterator(); iter.hasNext(); ) {
    NLMappingItem mapping=(NLMappingItem)iter.next();
    if (mapping.getScope().equals(scope)) {
      Template template=(Template)templateCache.get(mapping);
      input=template.expandAll(input,mapping.getTargetTemplate());
    }
  }
  return input;
}
