{
  if (connection.getTo().getNodeContainer() == this) {
    linkIncomingConnections(org.drools.workflow.core.Node.CONNECTION_DEFAULT_TYPE,connection.getTo().getId(),connection.getToType());
  }
 else {
    super.addOutgoingConnection(type,connection);
    CompositeNode.NodeAndType outNode=internalGetLinkedOutgoingNode(type);
    if (outNode != null) {
      CompositeNodeEnd end=new CompositeNodeEnd(connection.getTo(),type);
      internalAddNode(end);
      NodeImpl node=(NodeImpl)outNode.getNode();
      if (node != null) {
        new ConnectionImpl(outNode.getNode(),outNode.getType(),end,org.drools.workflow.core.Node.CONNECTION_DEFAULT_TYPE);
      }
    }
  }
}
