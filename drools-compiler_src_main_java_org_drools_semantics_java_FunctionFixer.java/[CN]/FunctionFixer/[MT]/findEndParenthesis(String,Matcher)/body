{
  final int start=matcher.start(3) - 1;
  int end=matcher.end();
  int oCount=0, cCount=0;
  int lastQuoteIndex=-1;
  for (int i=0; i < raw.length(); i++) {
    if (i > end && oCount == cCount) {
      if (lastQuoteIndex >= 0 && lastQuoteIndex <= start) {
        return -1;
      }
      break;
    }
switch (raw.charAt(i)) {
case '"':
      if (lastQuoteIndex >= 0) {
        if (lastQuoteIndex <= start && start <= i) {
          return -1;
        }
        lastQuoteIndex=-1;
      }
 else {
        lastQuoteIndex=i;
      }
    break;
case '(':
  if (lastQuoteIndex < 0 && i >= start) {
    ++oCount;
  }
break;
case ')':
if (lastQuoteIndex < 0 && i >= start) {
++cCount;
if (i >= end) {
  end=i + 1;
}
}
}
}
return end;
}
