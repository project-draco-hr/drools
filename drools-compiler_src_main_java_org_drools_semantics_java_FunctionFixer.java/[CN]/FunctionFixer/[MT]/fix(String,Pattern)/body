{
  if (raw == null)   return null;
  StringBuffer buf=new StringBuffer();
  int lastIndex=0;
  Matcher matcher=pattern.matcher(raw);
  while (matcher.find()) {
    String pre=matcher.group(1);
    if (matcher.group(1) != null) {
      String trimmedPre=pre.trim();
      if (trimmedPre.endsWith(".") || trimmedPre.endsWith("new")) {
        continue;
      }
    }
    String function=matcher.group(2).trim();
    String params=matcher.group(3).trim();
    String target=ucFirst(function) + "." + function+ "("+ params+ ")";
    buf.append(raw.substring(lastIndex,matcher.start(2)));
    buf.append(KnowledgeHelperFixer.replace(target,"$","\\$",128));
    lastIndex=matcher.end();
  }
  buf.append(raw.substring(lastIndex));
  return buf.toString();
}
