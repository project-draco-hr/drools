{
  PackageDescr pkgDescr=new PackageDescr("org.test");
  TypeDeclarationDescr typeDescr=new TypeDeclarationDescr("NewBean");
  TypeFieldDescr f1=new TypeFieldDescr("name",new PatternDescr("String"));
  TypeFieldDescr f2=new TypeFieldDescr("age",new PatternDescr("int"));
  typeDescr.addField(f1);
  typeDescr.addField(f2);
  pkgDescr.addTypeDeclaration(typeDescr);
  PackageBuilder builder=new PackageBuilder();
  builder.addPackage(pkgDescr);
  Package pkg=builder.getPackage();
  assertEquals(1,pkg.getTypeDeclarations().size());
  TypeDeclaration type=pkg.getTypeDeclaration("NewBean");
  assertEquals("NewBean",type.getTypeName());
  assertEquals(TypeDeclaration.Role.FACT,type.getRole());
  assertEquals("org.test.NewBean",type.getTypeClass().getName());
  assertFalse(builder.hasErrors());
  Package bp=builder.getPackage();
  DroolsCompositeClassLoader rootClassloader=new DroolsCompositeClassLoader(Thread.currentThread().getContextClassLoader());
  JavaDialectRuntimeData dialectData=(JavaDialectRuntimeData)bp.getDialectRuntimeRegistry().getDialectData("java");
  dialectData.onAdd(bp.getDialectRuntimeRegistry(),rootClassloader);
  Class newBean=rootClassloader.loadClass("org.test.NewBean");
  assertNotNull(newBean);
}
