{
  RightTupleSets stagedRightTuples=memory.getStagedRightTuples();
  boolean stagedUpdateWasEmpty=false;
  if (streamMode) {
    stagedUpdateWasEmpty=memory.getSegmentMemory().getTupleQueue().isEmpty();
    memory.getSegmentMemory().getTupleQueue().add(new RightTupleEntry(rightTuple,rightTuple.getPropagationContext(),memory));
  }
 else {
    stagedUpdateWasEmpty=stagedRightTuples.addUpdate(rightTuple);
  }
  if (stagedUpdateWasEmpty) {
    memory.getSegmentMemory().notifyRuleLinkSegment(wm);
  }
}
