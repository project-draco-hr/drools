{
  RightTupleSets stagedRightTuples=memory.getStagedRightTuples();
  if (((BetaNode)rightTuple.getRightTupleSink()).isParentIsWindowNode() && rightTuple.getStagedType() != LeftTuple.NONE && (rightTuple.getPropagationContext().getType() == PropagationContext.EXPIRATION || rightTuple.getPropagationContext().getType() == PropagationContext.DELETION)) {
    memory.getDequeu().add(rightTuple);
    return;
  }
switch (rightTuple.getStagedType()) {
case LeftTuple.INSERT:
    stagedRightTuples.removeInsert(rightTuple);
  break;
case LeftTuple.UPDATE:
stagedRightTuples.removeUpdate(rightTuple);
break;
}
if (memory.getAndDecCounter() == 1) {
memory.unlinkNode(wm);
}
 else if (stagedRightTuples.deleteSize() == 0) {
memory.getSegmentMemory().notifyRuleLinkSegment(wm);
}
stagedRightTuples.addDelete(rightTuple);
}
