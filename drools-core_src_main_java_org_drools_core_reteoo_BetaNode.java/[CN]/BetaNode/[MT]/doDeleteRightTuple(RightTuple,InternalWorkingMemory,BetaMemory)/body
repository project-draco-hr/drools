{
  RightTupleSets stagedRightTuples=memory.getStagedRightTuples();
switch (rightTuple.getStagedType()) {
case LeftTuple.INSERT:
    stagedRightTuples.removeInsert(rightTuple);
  break;
case LeftTuple.UPDATE:
stagedRightTuples.removeUpdate(rightTuple);
break;
}
if (memory.getAndDecCounter() == 1) {
memory.unlinkNode(wm);
}
 else if (stagedRightTuples.deleteSize() == 0) {
memory.getSegmentMemory().notifyRuleLinkSegment(wm);
}
stagedRightTuples.addDelete(rightTuple);
}
