{
  while (!tempStack.empty()) {
    StartElementInfo elem=(StartElementInfo)tempStack.pop();
    AttributeCollection attr=(AttributeCollection)elem.getAttributes();
    AttributeCollection newAttr=new AttributeCollection(namePool);
    for (int acount=0; acount < attr.getLength(); acount++) {
      String localName=attr.getLocalName(acount);
      int nameCode=attr.getNameCode(acount);
      String type=attr.getType(acount);
      String value=attr.getValue(acount);
      String uri=attr.getURI(acount);
      String prefix="";
      if (localName.indexOf(':') > 0) {
        prefix=localName.substring(0,localName.indexOf(':'));
        localName=localName.substring(localName.indexOf(':') + 1);
      }
      if (uri.equals("") && ((foStylesheet && localName.equals("id")) || (!foStylesheet && (localName.equals("id") || localName.equals("name"))))) {
      }
 else {
        newAttr.addAttribute(prefix,uri,localName,type,value);
      }
    }
    rtfEmitter.startElement(elem.getNameCode(),newAttr,elem.getNamespaces(),elem.getNSCount());
    elementStack.push(elem);
  }
}
