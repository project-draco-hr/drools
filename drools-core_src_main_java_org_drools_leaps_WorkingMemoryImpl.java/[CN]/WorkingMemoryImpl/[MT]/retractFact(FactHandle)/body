{
synchronized (lock) {
    Object object=((FactHandleImpl)factHandle).getObject();
    FactHandleImpl retractedFactHandle=new FactHandleImpl(this.getNextId(),object);
    for (Iterator it=this.getFactTablesList(object.getClass()).iterator(); it.hasNext(); ) {
      ((FactTable)it.next()).remove(factHandle);
    }
    this.handles.remove(object);
    for (Iterator it=this.getShadowFactTablesList(object.getClass()).iterator(); it.hasNext(); ) {
      ((FactTable)it.next()).add(retractedFactHandle);
    }
    this.removeLeapsTokenFromStack(new Token(this,(FactHandleImpl)factHandle,Token.ASSERTED));
    Token token=new Token(this,retractedFactHandle,Token.RETRACTED);
    this.pushTokenOnStack(token);
    PropagationContextImpl propagationContext=new PropagationContextImpl(++this.propagationIdCounter,PropagationContext.ASSERTION,(Rule)null,(Activation)null);
    this.workingMemoryEventSupport.fireObjectRetracted(propagationContext,factHandle,((FactHandleImpl)factHandle).getObject());
    return retractedFactHandle;
  }
}
