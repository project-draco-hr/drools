{
  long id;
  RetractAssembly assembly;
  FactHandle[] factHandles=tuple.getTuple().getFactHandles();
  for (int i=0; i < factHandles.length; i++) {
    id=((FactHandleImpl)factHandles[i]).getId();
    assembly=(RetractAssembly)this.retracts.get(id);
    if (assembly == null) {
      assembly=new RetractAssembly();
      this.retracts.put(id,assembly);
    }
    assembly.addPendingTuple(tuple);
  }
  if (existsFactHandles != null) {
    for (Iterator it=existsFactHandles.iterator(); it.hasNext(); ) {
      id=((FactHandleImpl)it.next()).getId();
      assembly=(RetractAssembly)this.retracts.get(id);
      if (assembly == null) {
        assembly=new RetractAssembly();
        this.retracts.put(id,assembly);
      }
      assembly.addPendingExists(tuple);
    }
  }
  if (notFactHandles != null) {
    for (Iterator it=notFactHandles.iterator(); it.hasNext(); ) {
      id=((FactHandleImpl)it.next()).getId();
      assembly=(RetractAssembly)this.retracts.get(id);
      if (assembly == null) {
        assembly=new RetractAssembly();
        this.retracts.put(id,assembly);
      }
      assembly.addPendingNot(tuple);
    }
  }
}
