{
  KnowledgeBuilder builder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  String str="";
  str+="package org.test1\n";
  str+="rule rule1\n";
  str+="when\n";
  str+="then\n";
  str+="end\n\n";
  str+="rule rule2\n";
  str+="when\n";
  str+="then\n";
  str+="end\n";
  builder.add(ResourceFactory.newByteArrayResource(str.getBytes()),ResourceType.DRL);
  str="package org.test2\n";
  str+="rule rule3\n";
  str+="when\n";
  str+="then\n";
  str+="end\n\n";
  str+="rule rule4\n";
  str+="when\n";
  str+="then\n";
  str+="end\n";
  builder.add(ResourceFactory.newByteArrayResource(str.getBytes()),ResourceType.DRL);
  Collection<KnowledgePackage> pkgs=builder.getKnowledgePackages();
  assertNotNull(pkgs);
  assertEquals(2,pkgs.size());
  KnowledgePackage test1=getKnowledgePackage(pkgs,"org.test1");
  Collection<Rule> rules=test1.getRules();
  assertEquals(2,rules.size());
  Rule rule=getRule(rules,"rule1");
  assertEquals("rule1",rule.getName());
  rule=getRule(rules,"rule2");
  assertEquals("rule2",rule.getName());
  KnowledgePackage test2=getKnowledgePackage(pkgs,"org.test2");
  rules=test2.getRules();
  assertEquals(2,rules.size());
  rule=getRule(rules,"rule3");
  assertEquals("rule3",rule.getName());
  rule=getRule(rules,"rule4");
  assertEquals("rule4",rule.getName());
}
