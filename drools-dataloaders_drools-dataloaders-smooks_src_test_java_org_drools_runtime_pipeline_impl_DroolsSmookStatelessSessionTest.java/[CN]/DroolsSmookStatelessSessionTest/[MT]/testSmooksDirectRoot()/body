{
  KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newClassPathResource("test_SmooksDirectRoot.drl",DroolsSmookStatefulSessionTest.class),ResourceType.DRL);
  assertFalse(kbuilder.hasErrors());
  KnowledgeBase kbase=KnowledgeBaseFactory.newKnowledgeBase();
  kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());
  StatelessKnowledgeSession ksession=kbase.newStatelessKnowledgeSession();
  List list=new ArrayList();
  ksession.setGlobal("list",list);
  Smooks smooks=new Smooks(getClass().getResourceAsStream("smooks-config.xml"));
  Transformer transformer=PipelineFactory.newSmooksTransformer(smooks,"orderItem");
  transformer.addReceiver(PipelineFactory.newStatelessKnowledgeSessionReceiverAdapter());
  StatelessKnowledgeSessionDataLoader dataLoader=new StatelessKnowledgeSessionDataLoaderImpl(ksession,transformer);
  dataLoader.executeObject(new StreamSource(getClass().getResourceAsStream("SmooksDirectRoot.xml")));
  assertEquals(1,list.size());
  assertEquals("example.OrderItem",list.get(0).getClass().getName());
}
