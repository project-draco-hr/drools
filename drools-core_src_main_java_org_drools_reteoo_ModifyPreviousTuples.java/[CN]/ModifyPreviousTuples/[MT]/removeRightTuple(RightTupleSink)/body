{
  if (this.rightTuple == null) {
    return null;
  }
  if (this.rightTuples == null) {
    if (this.rightTuple.getRightTupleSink() == sink) {
      RightTuple current=this.rightTuple;
      current.setHandlePrevious(null);
      this.rightTuple=current.getHandleNext();
      current.setHandleNext(null);
      return current;
    }
 else {
      this.rightTuples=new IdentityHashMap<RightTupleSink,RightTuple>();
      for (; rightTuple != null; rightTuple=(RightTuple)rightTuple.getHandleNext()) {
        this.rightTuples.put(rightTuple.getRightTupleSink(),rightTuple);
      }
    }
  }
  return this.rightTuples.remove(sink);
}
