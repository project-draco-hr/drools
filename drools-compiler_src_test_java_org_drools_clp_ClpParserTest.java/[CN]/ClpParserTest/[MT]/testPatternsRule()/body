{
  RuleDescr rule=parse("(defrule xxx ?b <- (person (name \"yyy\"&?bf|~\"zzz\"|~=(+ 2 3)&:(< 1 2)) ) ?c <- (hobby (type ?bf2&~iii) (rating fivestar) )").rule();
  assertEquals("xxx",rule.getName());
  AndDescr lhs=rule.getLhs();
  List lhsList=lhs.getDescrs();
  assertEquals(2,lhsList.size());
  ColumnDescr col=(ColumnDescr)lhsList.get(0);
  assertEquals("?b",col.getIdentifier());
  assertEquals("person",col.getObjectType());
  List colList=col.getDescrs();
  assertEquals(2,colList.size());
  FieldConstraintDescr fieldConstraintDescr=(FieldConstraintDescr)colList.get(0);
  List restrictionList=fieldConstraintDescr.getRestrictions();
  assertEquals("name",fieldConstraintDescr.getFieldName());
  assertEquals(8,restrictionList.size());
  LiteralRestrictionDescr litDescr=(LiteralRestrictionDescr)restrictionList.get(0);
  assertEquals("==",litDescr.getEvaluator());
  assertEquals("yyy",litDescr.getText());
  RestrictionConnectiveDescr connDescr=(RestrictionConnectiveDescr)restrictionList.get(1);
  assertEquals(RestrictionConnectiveDescr.AND,connDescr.getConnective());
  VariableRestrictionDescr varDescr=(VariableRestrictionDescr)restrictionList.get(2);
  assertEquals("==",varDescr.getEvaluator());
  assertEquals("?bf",varDescr.getIdentifier());
  connDescr=(RestrictionConnectiveDescr)restrictionList.get(3);
  assertEquals(RestrictionConnectiveDescr.OR,connDescr.getConnective());
  litDescr=(LiteralRestrictionDescr)restrictionList.get(4);
  assertEquals("!=",litDescr.getEvaluator());
  assertEquals("zzz",litDescr.getText());
  connDescr=(RestrictionConnectiveDescr)restrictionList.get(5);
  assertEquals(RestrictionConnectiveDescr.OR,connDescr.getConnective());
  ReturnValueRestrictionDescr retDescr=(ReturnValueRestrictionDescr)restrictionList.get(6);
  assertEquals("!=",retDescr.getEvaluator());
  CLPReturnValue clprv=(CLPReturnValue)retDescr.getContent();
  Function f=clprv.getFunctions()[0];
  assertEquals("+",f.getName());
  assertSame(new LongLiteralValue(2),f.getParameters()[0]);
  PredicateDescr predicateDescr=(PredicateDescr)colList.get(1);
  assertEquals("ooo",predicateDescr.getContent());
  col=(ColumnDescr)lhsList.get(1);
  assertEquals("?c",col.getIdentifier());
  assertEquals("hobby",col.getObjectType());
  colList=col.getDescrs();
  assertEquals(2,colList.size());
  fieldConstraintDescr=(FieldConstraintDescr)colList.get(0);
  restrictionList=fieldConstraintDescr.getRestrictions();
  assertEquals("type",fieldConstraintDescr.getFieldName());
  varDescr=(VariableRestrictionDescr)restrictionList.get(0);
  assertEquals("==",varDescr.getEvaluator());
  assertEquals("?bf2",varDescr.getIdentifier());
  connDescr=(RestrictionConnectiveDescr)restrictionList.get(1);
  assertEquals(RestrictionConnectiveDescr.AND,connDescr.getConnective());
  litDescr=(LiteralRestrictionDescr)restrictionList.get(2);
  assertEquals("!=",litDescr.getEvaluator());
  assertEquals("iii",litDescr.getText());
  fieldConstraintDescr=(FieldConstraintDescr)colList.get(1);
  restrictionList=fieldConstraintDescr.getRestrictions();
  assertEquals("rating",fieldConstraintDescr.getFieldName());
  litDescr=(LiteralRestrictionDescr)restrictionList.get(0);
  assertEquals("==",litDescr.getEvaluator());
  assertEquals("fivestar",litDescr.getText());
}
