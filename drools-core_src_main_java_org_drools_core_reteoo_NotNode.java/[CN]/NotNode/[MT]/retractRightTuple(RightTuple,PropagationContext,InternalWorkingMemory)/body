{
  final BetaMemory memory=(BetaMemory)workingMemory.getNodeMemory(this);
  rightTuple.setPropagationContext(context);
  RightTupleSets stagedRightTuples=memory.getStagedRightTuples();
  boolean stagedDeleteWasEmpty=false;
  if (streamMode) {
    stagedDeleteWasEmpty=memory.getSegmentMemory().getTupleQueue().isEmpty();
    memory.getSegmentMemory().getTupleQueue().add(new RightTupleEntry(rightTuple,context,memory));
  }
 else {
    stagedDeleteWasEmpty=stagedRightTuples.addDelete(rightTuple);
  }
  if (memory.getAndDecCounter() == 1 && isEmptyBetaConstraints()) {
    memory.linkNode(workingMemory);
  }
 else   if (stagedDeleteWasEmpty) {
    memory.setNodeDirty(workingMemory);
  }
}
