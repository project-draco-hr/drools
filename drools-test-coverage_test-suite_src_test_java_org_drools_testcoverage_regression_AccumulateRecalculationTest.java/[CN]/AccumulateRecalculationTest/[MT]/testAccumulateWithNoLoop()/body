{
  final String drl="import " + MyFact.class.getCanonicalName() + " ;\n"+ "rule RuleAccumulate \n"+ "  no-loop true\n"+ "when\n"+ "  $target: MyFact(name == \"target\");\n"+ "  $sum : Integer( ) from accumulate (\n"+ "    $v1: MyFact(name str[startsWith] \"src\", currentValue != null),\n"+ "    init ( int total = 0; ),\n"+ "    action (\n"+ "      total = total + $v1.getCurrentValue().intValue();\n"+ "      System.out.println(\"action  : plus  \" + $v1.toString() + \" then total=\" + total);\n"+ "    ),\n"+ "    reverse (\n"+ "      total = total - \n"+ "        ($v1.getPreviousValue() != null ? $v1.getPreviousValue().intValue() : $v1.getCurrentValue().intValue());\n"+ "      System.out.println(\"reverse : minus \" + $v1.toString() + \" then total=\" + total);\n"+ "    ),\n"+ "    result ( new Integer(total) )\n"+ "  );\n"+ "then\n"+ "  System.out.println(\" Fired!! \" + drools.getRule().getName() + \" total=\" + $sum);\n"+ "  $target.setCurrentValue($sum);\n"+ "  update($target);\n"+ "end\n"+ "\n"+ "rule RuleFollowing \n"+ "when\n"+ "  $target: MyFact(name == \"target\");\n"+ "then\n"+ "  System.out.println(\" Fired!! RuleFollowing target=\" + $target.toString());\n"+ "end\n";
  scenario(drl);
}
