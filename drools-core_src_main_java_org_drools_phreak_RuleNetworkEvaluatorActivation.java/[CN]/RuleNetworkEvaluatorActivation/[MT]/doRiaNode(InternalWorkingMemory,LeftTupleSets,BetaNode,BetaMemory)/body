{
  SegmentMemory subSmem=bm.getSubnetworkSegmentMemory();
  if (betaNode.getLeftTupleSource().getSinkPropagator().size() == 2) {
    LeftTupleSets peerTuples=new LeftTupleSets();
    SegmentPropagator.processPeers(srcTuples,peerTuples,betaNode);
    LeftTupleSets subnetworkStaged=subSmem.getStagedLeftTuples();
    subnetworkStaged.addAll(srcTuples);
    srcTuples.resetAll();
    srcTuples=peerTuples;
  }
  RightInputAdapterNode riaNode=(RightInputAdapterNode)betaNode.getRightInput();
  RiaNodeMemory riaNodeMemory=(RiaNodeMemory)wm.getNodeMemory((MemoryFactory)betaNode.getRightInput());
  LeftTupleSets riaStagedTuples=eval((LeftTupleSink)subSmem.getRootNode(),subSmem.getNodeMemories().getFirst(),riaNodeMemory.getRiaRuleMemory().getSegmentMemories(),subSmem.getPos(),subSmem.getStagedLeftTuples(),null,wm);
  for (LeftTuple leftTuple=riaStagedTuples.getInsertFirst(); leftTuple != null; ) {
    LeftTuple next=leftTuple.getStagedNext();
    InternalFactHandle handle=riaNode.createFactHandle(leftTuple,leftTuple.getPropagationContext(),wm);
    RightTuple rightTuple=new RightTuple(handle,betaNode);
    leftTuple.setObject(rightTuple);
    bm.getStagedRightTuples().addInsert(rightTuple);
    leftTuple.clearStaged();
    leftTuple=next;
  }
  for (LeftTuple leftTuple=riaStagedTuples.getDeleteFirst(); leftTuple != null; ) {
    LeftTuple next=leftTuple.getStagedNext();
    bm.getStagedRightTuples().addDelete((RightTuple)leftTuple.getObject());
    leftTuple.clearStaged();
    leftTuple=next;
  }
  for (LeftTuple leftTuple=riaStagedTuples.getUpdateFirst(); leftTuple != null; ) {
    LeftTuple next=leftTuple.getStagedNext();
    bm.getStagedRightTuples().addUpdate((RightTuple)leftTuple.getObject());
    leftTuple.clearStaged();
    leftTuple=next;
  }
  return srcTuples;
}
