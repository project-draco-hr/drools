{
  try {
    RuleBase ruleBase=createKnowledgeBase();
    StatefulSession session=ruleBase.newStatefulSession();
    WorkingMemoryFileLogger logger=new WorkingMemoryFileLogger(session);
    CustomerService customerService=new DefaultCustomerService();
    Customer c=new Customer("A-12345");
    Calendar birthday=Calendar.getInstance();
    birthday.set(1982,1,1);
    c.setBirthday(birthday.getTime());
    c.setFirstName("John");
    c.setLastName("Doe");
    customerService.addCustomer(c);
    session.setGlobal("customerService",customerService);
    ItemCatalog itemCatalog=new DefaultItemCatalog();
    Item i=new Item("I-9876");
    i.setName("Rampage !!! PC game");
    i.setMinimalAge(18);
    session.setGlobal("itemCatalog",itemCatalog);
    UIWorkItemHandler handler=new UIWorkItemHandler();
    session.getWorkItemManager().registerWorkItemHandler("Human Task",handler);
    handler.setVisible(true);
    Order order=new Order();
    order.setOrderId("O-ABCDE");
    order.setCustomerId("A-12345");
    order.addOrderItem("I-9876",3,50.0D);
    session.insert(order);
    Map<String,Object> parameters=new HashMap<String,Object>();
    parameters.put("orderId",order.getOrderId());
    session.startProcess("org.drools.examples.process.ruleset.RuleSetExample",parameters);
    session.fireAllRules();
    logger.writeToDisk();
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
}
