{
  final ReteooRuleBase ruleBase=(ReteooRuleBase)RuleBaseFactory.newRuleBase();
  final InternalWorkingMemory workingMemory=(InternalWorkingMemory)ruleBase.newStatefulSession();
  final ClassFieldReader extractor=cache.getReader(Cheese.class,"type",getClass().getClassLoader());
  final FieldValue field=FieldFactory.getFieldValue("cheddar");
  final Evaluator evaluator=equals.getEvaluator(ValueType.STRING_TYPE,Operator.EQUAL);
  final LiteralConstraint constraint1=new LiteralConstraint(extractor,evaluator,field);
  final ClassFieldReader priceExtractor=cache.getReader(Cheese.class,"price",getClass().getClassLoader());
  final FieldValue priceField=FieldFactory.getFieldValue(10);
  final Evaluator priceEvaluator=comparables.getEvaluator(ValueType.INTEGER_TYPE,Operator.GREATER);
  final LiteralConstraint constraint2=new LiteralConstraint(priceExtractor,priceEvaluator,priceField);
  final Cheese cheddar=new Cheese("cheddar",15);
  final AndConstraint constraint=new AndConstraint();
  constraint.addAlphaConstraint(constraint1);
  constraint.addAlphaConstraint(constraint2);
  final ContextEntry context=constraint.createContextEntry();
  final InternalFactHandle cheddarHandle=(InternalFactHandle)workingMemory.insert(cheddar);
  assertTrue(constraint.isAllowed(cheddarHandle,workingMemory,context));
  cheddar.setPrice(5);
  ((ShadowProxy)cheddarHandle.getObject()).updateProxy();
  assertFalse(constraint.isAllowed(cheddarHandle,workingMemory,context));
  cheddar.setType("stilton");
  ((ShadowProxy)cheddarHandle.getObject()).updateProxy();
  assertFalse(constraint.isAllowed(cheddarHandle,workingMemory,context));
  cheddar.setPrice(15);
  ((ShadowProxy)cheddarHandle.getObject()).updateProxy();
  assertFalse(constraint.isAllowed(cheddarHandle,workingMemory,context));
}
