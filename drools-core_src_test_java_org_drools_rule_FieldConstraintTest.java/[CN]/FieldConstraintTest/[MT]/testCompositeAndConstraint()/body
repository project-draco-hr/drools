{
  final ReteooRuleBase ruleBase=(ReteooRuleBase)RuleBaseFactory.newRuleBase();
  final InternalWorkingMemory workingMemory=(InternalWorkingMemory)ruleBase.newStatefulSession();
  final ClassFieldExtractor extractor=ClassFieldExtractorCache.getExtractor(Cheese.class,"type",getClass().getClassLoader());
  final FieldValue field=FieldFactory.getFieldValue("cheddar");
  final Evaluator evaluator=ValueType.STRING_TYPE.getEvaluator(Operator.EQUAL);
  final LiteralConstraint constraint1=new LiteralConstraint(extractor,evaluator,field);
  final ClassFieldExtractor priceExtractor=ClassFieldExtractorCache.getExtractor(Cheese.class,"price",getClass().getClassLoader());
  final FieldValue priceField=FieldFactory.getFieldValue(10);
  final Evaluator priceEvaluator=ValueType.INTEGER_TYPE.getEvaluator(Operator.GREATER);
  final LiteralConstraint constraint2=new LiteralConstraint(priceExtractor,priceEvaluator,priceField);
  final Cheese cheddar=new Cheese("cheddar",15);
  final AndConstraint constraint=new AndConstraint();
  constraint.addAlphaConstraint(constraint1);
  constraint.addAlphaConstraint(constraint2);
  final InternalFactHandle cheddarHandle=(InternalFactHandle)workingMemory.insert(cheddar);
  assertTrue(constraint.isAllowed(cheddarHandle.getObject(),workingMemory));
  cheddar.setPrice(5);
  ((ShadowProxy)cheddarHandle.getObject()).updateProxy();
  assertFalse(constraint.isAllowed(cheddarHandle.getObject(),workingMemory));
  cheddar.setType("stilton");
  ((ShadowProxy)cheddarHandle.getObject()).updateProxy();
  assertFalse(constraint.isAllowed(cheddarHandle.getObject(),workingMemory));
  cheddar.setPrice(15);
  ((ShadowProxy)cheddarHandle.getObject()).updateProxy();
  assertFalse(constraint.isAllowed(cheddarHandle.getObject(),workingMemory));
}
