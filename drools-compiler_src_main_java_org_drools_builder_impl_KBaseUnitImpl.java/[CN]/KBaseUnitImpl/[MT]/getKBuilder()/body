{
  if (kbuilder != null) {
    return kbuilder;
  }
  if (classLoader != null) {
    KnowledgeBuilderConfiguration kConf=KnowledgeBuilderFactory.newKnowledgeBuilderConfiguration(null,classLoader);
    kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder(kConf);
  }
 else {
    kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  }
  CompositeKnowledgeBuilder ckbuilder=kbuilder.batch();
  buildKBaseFiles(ckbuilder,kBase);
  if (includes != null) {
    for (    KBase include : includes) {
      buildKBaseFiles(ckbuilder,include);
    }
  }
  ckbuilder.build();
  return kbuilder;
}
