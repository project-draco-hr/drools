{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  try {
    statefulKnowledgeMarshaller.marshall(baos,ksession);
  }
 catch (  IOException e) {
    throw new IllegalStateException("unable to marshall knowledge session",e);
  }
  int ksessionId=internalSaveStatefulKnowledgeSession(baos.toByteArray());
  ((StatefulKnowledgeSessionImpl)ksession).setId(ksessionId);
}
