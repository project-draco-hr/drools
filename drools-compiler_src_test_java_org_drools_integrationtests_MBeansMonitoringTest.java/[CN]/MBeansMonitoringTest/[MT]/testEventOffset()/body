{
  String drl="package org.kie.test\n" + "import org.kie.StockTick\n" + "declare StockTick\n"+ "    @role(event)\n"+ "    @expires(10s)\n"+ "end\n"+ "rule X\n"+ "when\n"+ "    StockTick()\n"+ "then\n"+ "end";
  KnowledgeBaseConfiguration conf=KnowledgeBaseFactory.newKnowledgeBaseConfiguration();
  conf.setOption(EventProcessingOption.STREAM);
  conf.setOption(MBeansOption.ENABLED);
  KnowledgeBase kbase=loadKnowledgeBase("monitoredKbase",drl,conf);
  MBeanServer mbserver=ManagementFactory.getPlatformMBeanServer();
  ObjectName kbOn=new ObjectName("org.kie.kbases:type=monitoredKbase");
  mbserver.invoke(kbOn,"startInternalMBeans",new Object[0],new String[0]);
  Object expOffset=mbserver.getAttribute(new ObjectName("org.kie.kbases:type=monitoredKbase,group=EntryPoints,EntryPoint=DEFAULT,ObjectType=org.kie.StockTick"),"ExpirationOffset");
  Assert.assertEquals(10001,((Number)expOffset).longValue());
}
