{
  String rule1="A( a == 10, b == 15 )";
  String rule2="A( a == 10, i == 20 )";
  KnowledgeBase kbase=getKnowledgeBase(rule1,rule2);
  InternalWorkingMemory wm=((InternalWorkingMemory)kbase.newStatefulKnowledgeSession());
  ObjectTypeNode otn=getObjectTypeNode(kbase,"A");
  assertNotNull(otn);
  List<String> sp=getSettableProperties(wm,otn);
  AlphaNode alphaNode1=(AlphaNode)otn.getObjectSinkPropagator().getSinks()[0];
  assertEquals(calculatePositiveMask(list("a"),sp),alphaNode1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","b","i"),sp),alphaNode1.getInferredMask());
  AlphaNode alphaNode1_1=(AlphaNode)alphaNode1.getObjectSinkPropagator().getSinks()[0];
  assertEquals(calculatePositiveMask(list("b"),sp),alphaNode1_1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","b"),sp),alphaNode1_1.getInferredMask());
  LeftInputAdapterNode liaNode1=(LeftInputAdapterNode)alphaNode1_1.getObjectSinkPropagator().getSinks()[0];
  RuleTerminalNode rtNode1=(RuleTerminalNode)liaNode1.getSinkPropagator().getSinks()[0];
  assertEquals(EmptyBitMask.get(),rtNode1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","b"),sp),rtNode1.getInferredMask());
  AlphaNode alphaNode1_2=(AlphaNode)alphaNode1.getObjectSinkPropagator().getSinks()[1];
  assertEquals(calculatePositiveMask(list("i"),sp),alphaNode1_2.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","i"),sp),alphaNode1_2.getInferredMask());
  LeftInputAdapterNode liaNode2=(LeftInputAdapterNode)alphaNode1_2.getObjectSinkPropagator().getSinks()[0];
  RuleTerminalNode rtNode2=(RuleTerminalNode)liaNode2.getSinkPropagator().getSinks()[0];
  assertEquals(EmptyBitMask.get(),rtNode2.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","i"),sp),rtNode2.getInferredMask());
  kbase.removeRule("org.drools.compiler.integrationtests","r0");
  assertEquals(calculatePositiveMask(list("a"),sp),alphaNode1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","i"),sp),alphaNode1.getInferredMask());
  assertEquals(calculatePositiveMask(list("i"),sp),alphaNode1_2.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","i"),sp),alphaNode1_2.getInferredMask());
  assertEquals(EmptyBitMask.get(),rtNode2.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","i"),sp),rtNode2.getInferredMask());
  kbase=getKnowledgeBase(rule1,rule2);
  kbase.removeRule("org.drools.compiler.integrationtests","r1");
  otn=getObjectTypeNode(kbase,"A");
  alphaNode1=(AlphaNode)otn.getObjectSinkPropagator().getSinks()[0];
  assertEquals(calculatePositiveMask(list("a"),sp),alphaNode1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","b"),sp),alphaNode1.getInferredMask());
  alphaNode1_1=(AlphaNode)alphaNode1.getObjectSinkPropagator().getSinks()[0];
  assertEquals(calculatePositiveMask(list("b"),sp),alphaNode1_1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","b"),sp),alphaNode1_1.getInferredMask());
  liaNode1=(LeftInputAdapterNode)alphaNode1_1.getObjectSinkPropagator().getSinks()[0];
  rtNode1=(RuleTerminalNode)liaNode1.getSinkPropagator().getSinks()[0];
  assertEquals(EmptyBitMask.get(),rtNode1.getDeclaredMask());
  assertEquals(calculatePositiveMask(list("a","b"),sp),rtNode1.getInferredMask());
}
