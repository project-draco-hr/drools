{
  assertEquals(object1 + " is not of the same type as " + object2,object1.getClass(),object2.getClass());
  assertEquals(object1 + " is not equal to " + object2,object1,object2);
  List list1=null;
  List list2=null;
  if (object1 instanceof ObjectSource) {
    ObjectSource source1=(ObjectSource)object1;
    ObjectSource source2=(ObjectSource)object2;
    list1=source1.getObjectSinksAsList();
    list2=source2.getObjectSinksAsList();
  }
 else   if (object1 instanceof TupleSource) {
    TupleSource source1=(TupleSource)object1;
    TupleSource source2=(TupleSource)object2;
    list1=source1.getTupleSinks();
    list2=source2.getTupleSinks();
  }
  assertEquals(object1.getClass() + " nodes have different number of sinks",list1.size(),list2.size());
  for (int i=0, size=list1.size(); i < size; i++) {
    nodesEquals(list1.get(i),list2.get(i));
  }
}
