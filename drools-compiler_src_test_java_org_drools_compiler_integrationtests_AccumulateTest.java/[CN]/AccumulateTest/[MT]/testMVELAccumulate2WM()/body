{
  KieBase kbase=loadKnowledgeBase("test_AccumulateMVEL.drl");
  KieSession wm1=createKieSession(kbase);
  final List<?> results1=new ArrayList<Object>();
  wm1.setGlobal("results",results1);
  KieSession wm2=createKieSession(kbase);
  final List<?> results2=new ArrayList<Object>();
  wm2.setGlobal("results",results2);
  wm1.insert(new Person("Bob","stilton",20));
  wm1.insert(new Person("Mark","provolone"));
  wm2.insert(new Person("Bob","stilton",20));
  wm2.insert(new Person("Mark","provolone"));
  wm1.insert(new Cheese("stilton",10));
  wm1.insert(new Cheese("brie",5));
  wm2.insert(new Cheese("stilton",10));
  wm1.insert(new Cheese("provolone",150));
  wm2.insert(new Cheese("brie",5));
  wm2.insert(new Cheese("provolone",150));
  wm1.fireAllRules();
  wm2.fireAllRules();
  assertEquals(165,results1.get(0));
  assertEquals(10,results1.get(1));
  assertEquals(150,results1.get(2));
  assertEquals(10,results1.get(3));
  assertEquals(210,results1.get(4));
  assertEquals(165,results2.get(0));
  assertEquals(10,results2.get(1));
  assertEquals(150,results2.get(2));
  assertEquals(10,results2.get(3));
  assertEquals(210,results2.get(4));
}
