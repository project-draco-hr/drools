{
  String str="import java.util.*;\n" + "import AccumulateTest.MyPerson;\n" + "dialect \"mvel\"\n"+ "\n"+ "rule \"Test\"\n"+ "    when\n"+ "        $total : Number()\n"+ "             from accumulate( MyPerson( $age: age ),\n"+ "                              sum( $age ) )\n"+ "\n"+ "        $p: MyPerson();\n"+ "        $k: List( size > 0 ) from accumulate( MyPerson($kids: kids) from $p.kids,\n"+ "            init( ArrayList myList = new ArrayList(); ),\n"+ "            action( myList.addAll($kids); ),\n"+ "            reverse( myList.removeAll($kids); ),\n"+ "            result( myList )\n"+ "        )\n"+ "\n"+ "        MyPerson(name == \"Jos Jr Jr\")\n"+ "        or\n"+ "        MyPerson(name == \"Jos\")\n"+ "    then\n"+ "        System.out.println(\"hello\");\n"+ "end\n";
  PackageBuilder builder=new PackageBuilder();
  builder.addPackageFromDrl(ResourceFactory.newByteArrayResource(str.getBytes()));
  RuleBase rb=RuleBaseFactory.newRuleBase();
  rb.addPackages(builder.getPackages());
  StatelessSession ss=rb.newStatelessSession();
  ss.execute(new Object[]{new MyPerson("John",20,Arrays.asList(new MyPerson("John Jr 1st",10,Arrays.asList(new MyPerson("John Jr Jr",4,Collections.<MyPerson>emptyList()))),new MyPerson("John Jr 2nd",8,Collections.<MyPerson>emptyList()))),new MyPerson("Jeff",30,Arrays.asList(new MyPerson("Jeff Jr 1st",10,Collections.<MyPerson>emptyList()),new MyPerson("Jeff Jr 2nd",8,Collections.<MyPerson>emptyList())))});
}
