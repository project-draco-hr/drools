{
  KProject kproj=new KProjectImpl();
  KProjectChangeLog klog=new KProjectChangeLog();
  kproj.setListener(klog);
  kproj.setKProjectPath("src/main/resources/");
  kproj.setKBasesPath("src/kbases");
  List<String> files=asList(new String[]{});
  KBase kBase1=kproj.newKBase("org.test1","KBase1");
  kBase1.setFiles(files);
  kBase1.setAnnotations(asList("@ApplicationScoped; @Inject"));
  kBase1.setEqualsBehavior(AssertBehaviorOption.EQUALITY);
  kBase1.setEventProcessingMode(EventProcessingOption.STREAM);
  MemoryFileSystem mfs=new MemoryFileSystem();
  KProjectChangeLogCommiter.commit(kproj,klog,mfs);
  Folder fld=mfs.getFolder("src/kbases/org.test1.KBase1");
  assertTrue(fld.exists());
  MemoryFile mf=(MemoryFile)mfs.getFile("src/kbases/org.test1.KBase1/org/test1/KBase1Producer.java");
  String s=new String(mfs.getBytes(mf.getPath().toPortableString()));
  assertTrue(s.contains("EventProcessingOption.STREAM"));
  kBase1.setEventProcessingMode(EventProcessingOption.CLOUD);
  KProjectChangeLogCommiter.commit(kproj,klog,mfs);
  mf=(MemoryFile)mfs.getFile("src/kbases/org.test1.KBase1/org/test1/KBase1Producer.java");
  s=new String(mfs.getBytes(mf.getPath().toPortableString()));
  assertTrue(s.contains("EventProcessingOption.CLOUD"));
  kproj.removeKBase(kBase1.getQName());
  KProjectChangeLogCommiter.commit(kproj,klog,mfs);
  fld=mfs.getFolder("src/kbases/org.test1.KBase1");
  assertFalse(fld.exists());
  mf=(MemoryFile)mfs.getFile("src/kbases/org.test1.KBase1/org/test1/KBase1Producer.java");
  assertFalse(mf.exists());
}
