{
  TestNode node=new TestNode(1,new MockTupleSource(15),new MockCondition(null,true),true);
  MockTupleSink sink=new MockTupleSink();
  node.addTupleSink(sink);
  FactHandleImpl f0=new FactHandleImpl(0);
  ReteTuple tuple=new ReteTuple(0,f0,this.workingMemory);
  node.assertTuple(tuple,this.context,this.workingMemory);
  Map map=(Map)this.workingMemory.getNodeMemory(node);
  assertLength(1,map.keySet());
  assertContains(tuple.getKey(),map.keySet());
  node.retractTuples(tuple.getKey(),this.context,this.workingMemory);
  assertLength(0,map.keySet());
}
