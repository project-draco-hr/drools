{
  if (value != null) {
    StringBuffer valuePatternBuffer=new StringBuffer();
    if (headMatchGroupAdded) {
      valuePatternBuffer.append("$1");
    }
    valuePatternBuffer.append(value);
    if (value.endsWith(" ")) {
      valuePatternBuffer.deleteCharAt(valuePatternBuffer.length() - 1);
    }
    if (tailMatchGroupAdded) {
      int tailIndex=getVariables().get(TAIL_TAG).intValue();
      valuePatternBuffer.append("$" + tailIndex);
    }
    String pat=valuePatternBuffer.toString();
    for (    Map.Entry<String,Integer> entry : getVariables().entrySet()) {
      pat=pat.replaceAll("\\{" + entry.getKey() + "(:(.*?))?\\}","\\$" + entry.getValue());
    }
    super.setValuePattern(pat);
  }
}
