{
  DRLUpdate updater=new DRLUpdate();
  File curdir=new File(dir);
  Project project=new Project();
  FileSet fileset=new FileSet();
  fileset.setDir(curdir);
  fileset.setIncludes(fileMask);
  fileset.setProject(project);
  for (Iterator it=fileset.iterator(); it.hasNext(); ) {
    Reader reader=null;
    Writer writer=null;
    try {
      FileResource inputFile=(FileResource)it.next();
      reader=new InputStreamReader(inputFile.getInputStream());
      String outFileName=inputFile.getName() + sufix;
      writer=new PrintWriter(new File(outFileName));
      System.out.println("Updating " + inputFile.getName() + " to "+ outFileName);
      updater.updateDrl(reader,writer);
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
catch (    DroolsParserException e) {
      e.printStackTrace();
    }
 finally {
      try {
        if (reader != null)         reader.close();
      }
 catch (      Exception e) {
      }
      try {
        if (writer != null)         writer.close();
      }
 catch (      Exception e) {
      }
    }
  }
}
