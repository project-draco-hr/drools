{
  EventSupport eventsupport=(EventSupport)this.workingMemory;
  for (Iterator agendaGroupIterator=this.agendaGroups.values().iterator(); agendaGroupIterator.hasNext(); ) {
    AgendaGroupImpl group=(AgendaGroupImpl)agendaGroupIterator.next();
    for (Iterator queueIterator=group.getPriorityQueue().iterator(); queueIterator.hasNext(); ) {
      ActivationQueue queue=(ActivationQueue)queueIterator.next();
      queue.setActivated(false);
      if (!queue.isEmpty()) {
        for (Activation item=queue.remove(); !queue.isEmpty(); item=queue.remove()) {
          eventsupport.getAgendaEventSupport().fireActivationCancelled(item);
        }
      }
    }
  }
  AgendaGroup main=(AgendaGroup)this.focusStack.getFirst();
  this.focusStack.clear();
  this.focusStack.add(main);
  if (this.scheduledActivations != null && !this.scheduledActivations.isEmpty()) {
    for (ScheduledAgendaItem item=(ScheduledAgendaItem)this.scheduledActivations.removeFirst(); item != null; item=(ScheduledAgendaItem)this.scheduledActivations.removeFirst()) {
      item.remove();
      eventsupport.getAgendaEventSupport().fireActivationCancelled(item);
    }
  }
}
