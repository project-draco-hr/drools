{
  String str="package foo.bar\n" + "rule R\n" + "when\n"+ "then\n"+ "    throw new RuntimeException(\"foo\");"+ "end";
  KnowledgeBuilder kbuilder=KnowledgeBuilderFactory.newKnowledgeBuilder();
  kbuilder.add(ResourceFactory.newByteArrayResource(str.getBytes(Charset.forName("UTF-8"))),ResourceType.DRL);
  if (kbuilder.hasErrors()) {
    throw new RuntimeException("Drools compile errors: " + kbuilder.getErrors().toString());
  }
  KnowledgeBase kbase=kbuilder.newKnowledgeBase();
  StatefulKnowledgeSession ksession=kbase.newStatefulKnowledgeSession();
  try {
    ksession.fireAllRules();
  }
 catch (  org.drools.runtime.rule.ConsequenceException e) {
  }
catch (  Exception other) {
    fail("Wrong exception raised = " + other.getClass().getCanonicalName());
  }
}
