{
  TestWorkItemManager manager=new TestWorkItemManager();
  WorkItemImpl workItem=new WorkItemImpl();
  workItem.setName("Human Task");
  workItem.setParameter("TaskName","TaskName");
  workItem.setParameter("Comment","Comment");
  workItem.setParameter("Priority","10");
  workItem.setParameter("ActorId","Darth Vader");
  workItem.setParameter("Content","This is the content");
  handler.executeWorkItem(workItem,manager);
  Thread.sleep(500);
  BlockingTaskSummaryMessageResponseHandler responseHandler=new BlockingTaskSummaryMessageResponseHandler();
  humanTaskClient.getTasksAssignedAsPotentialOwner("Darth Vader","en-UK",responseHandler);
  List<TaskSummary> tasks=responseHandler.getResults();
  assertEquals(1,tasks.size());
  TaskSummary taskSummary=tasks.get(0);
  assertEquals("TaskName",taskSummary.getName());
  assertEquals(10,taskSummary.getPriority());
  assertEquals("Comment",taskSummary.getDescription());
  assertEquals(Status.Reserved,taskSummary.getStatus());
  assertEquals("Darth Vader",taskSummary.getActualOwner().getId());
  BlockingGetTaskMessageResponseHandler getTaskResponseHandler=new BlockingGetTaskMessageResponseHandler();
  humanTaskClient.getTask(taskSummary.getId(),getTaskResponseHandler);
  Task task=getTaskResponseHandler.getTask();
  assertEquals(AccessType.Inline,task.getTaskData().getDocumentAccessType());
  long contentId=task.getTaskData().getDocumentContentId();
  assertTrue(contentId != -1);
  BlockingGetContentMessageResponseHandler getContentResponseHandler=new BlockingGetContentMessageResponseHandler();
  humanTaskClient.getContent(contentId,getContentResponseHandler);
  ByteArrayInputStream bis=new ByteArrayInputStream(getContentResponseHandler.getContent().getContent());
  ObjectInputStream in=new ObjectInputStream(bis);
  Object data=in.readObject();
  in.close();
  assertEquals("This is the content",data);
  System.out.println("Starting task " + task.getId());
  BlockingTaskOperationMessageResponseHandler operationResponseHandler=new BlockingTaskOperationMessageResponseHandler();
  humanTaskClient.start(task.getId(),"Darth Vader",operationResponseHandler);
  operationResponseHandler.waitTillDone(DEFAULT_WAIT_TIME);
  System.out.println("Started task " + task.getId());
  System.out.println("Completing task " + task.getId());
  operationResponseHandler=new BlockingTaskOperationMessageResponseHandler();
  ContentData result=new ContentData();
  result.setAccessType(AccessType.Inline);
  result.setType("java.lang.String");
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ObjectOutputStream out=new ObjectOutputStream(bos);
  out.writeObject("This is the result");
  out.close();
  result.setContent(bos.toByteArray());
  humanTaskClient.complete(task.getId(),"Darth Vader",result,operationResponseHandler);
  operationResponseHandler.waitTillDone(DEFAULT_WAIT_TIME);
  System.out.println("Completed task " + task.getId());
  assertTrue(manager.waitTillCompleted(MANAGER_COMPLETION_WAIT_TIME));
  Map<String,Object> results=manager.getResults();
  assertNotNull(results);
  assertEquals("Darth Vader",results.get("ActorId"));
  assertEquals("This is the result",results.get("Result"));
}
