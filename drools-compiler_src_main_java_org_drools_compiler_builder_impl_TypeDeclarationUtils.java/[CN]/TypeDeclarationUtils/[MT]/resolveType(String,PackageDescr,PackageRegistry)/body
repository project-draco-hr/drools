{
  String arraySuffix="";
  int arrayIndex=klass.indexOf("[");
  if (arrayIndex >= 0) {
    arraySuffix=klass.substring(arrayIndex);
    klass=klass.substring(0,arrayIndex);
  }
  for (  ImportDescr id : packageDescr.getImports()) {
    String fqKlass=id.getTarget();
    if (fqKlass.endsWith("." + klass)) {
      return arrayIndex < 0 ? fqKlass : fqKlass + arraySuffix;
    }
  }
  if (pkgRegistry != null) {
    for (    String declaredName : pkgRegistry.getPackage().getTypeDeclarations().keySet()) {
      if (declaredName.equals(klass)) {
        TypeDeclaration typeDeclaration=pkgRegistry.getPackage().getTypeDeclaration(declaredName);
        if (typeDeclaration.getTypeClass() != null) {
          klass=typeDeclaration.getTypeClass().getName();
        }
      }
    }
  }
  if ((klass != null) && (!klass.contains(".")) && (packageDescr.getNamespace() != null && !packageDescr.getNamespace().isEmpty())) {
    for (    AbstractClassTypeDeclarationDescr td : packageDescr.getClassAndEnumDeclarationDescrs()) {
      if (klass.equals(td.getTypeName())) {
        if (td.getType().getFullName().contains(".")) {
          klass=td.getType().getFullName();
        }
      }
    }
  }
  return arrayIndex < 0 ? klass : klass + arraySuffix;
}
