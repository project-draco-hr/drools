{
  StatelessSession session=getStatelessSession(this.getClass().getResourceAsStream("Possibilities.drl"));
  session.setAgendaFilter(new RuleNameMatchesAgendaFilter("Find subsumptant rule possibilities"));
  Collection<Object> data=new ArrayList<Object>();
  AnalyticsResult result=AnalyticsResultFactory.createAnalyticsResult();
  session.setGlobal("result",result);
  String ruleName1="Rule 1";
  String ruleName2="Rule 2";
  AnalyticsRule r1=new AnalyticsRule();
  r1.setRuleName(ruleName1);
  AnalyticsRule r2=new AnalyticsRule();
  r2.setRuleName(ruleName2);
  PatternPossibility pp1=new PatternPossibility();
  pp1.setRuleName(ruleName1);
  PatternPossibility pp2=new PatternPossibility();
  pp2.setRuleName(ruleName1);
  PatternPossibility pp3=new PatternPossibility();
  pp3.setRuleName(ruleName2);
  PatternPossibility pp4=new PatternPossibility();
  pp4.setRuleName(ruleName2);
  RulePossibility rp1=new RulePossibility();
  rp1.setRuleId(r1.getId());
  rp1.setRuleName(ruleName1);
  rp1.add(pp1);
  rp1.add(pp2);
  RulePossibility rp2=new RulePossibility();
  rp2.setRuleId(r2.getId());
  rp2.setRuleName(ruleName2);
  rp2.add(pp3);
  rp2.add(pp4);
  Redundancy possibilityredundancy=new Redundancy(RedundancyType.STRONG,pp1,pp3);
  Subsumption possibilitysubsupmtion=new Subsumption(pp2,pp4);
  Redundancy ruleRedundancy=new Redundancy(r1,r2);
  data.add(r1);
  data.add(r2);
  data.add(pp1);
  data.add(pp2);
  data.add(pp3);
  data.add(possibilityredundancy);
  data.add(possibilitysubsupmtion);
  data.add(ruleRedundancy);
  data.add(rp1);
  data.add(rp2);
  StatelessSessionResult sessionResult=session.executeWithResults(data);
  Map<Cause,Set<Cause>> map=createSubsumptionMap(sessionResult.iterateObjects());
  assertTrue(TestBase.causeMapContains(map,rp1,rp2));
  assertTrue(TestBase.causeMapContains(map,pp2,pp4));
  if (!map.isEmpty()) {
    fail("More redundancies than was expected.");
  }
}
