{
  modificationMask=originalMask;
  if (modificationMask == Long.MAX_VALUE || !(type instanceof ClassObjectType)) {
    return this;
  }
  ClassObjectType classObjectType=(ClassObjectType)type;
  Class<?> classType=classObjectType.getClassType();
  if (classType == modifiedClass || !(classType.isInterface() || modifiedClass.isInterface())) {
    return this;
  }
  Long cachedMask=classObjectType.getTransformedMask(modifiedClass,originalMask);
  if (cachedMask != null) {
    modificationMask=cachedMask;
    return this;
  }
  modificationMask=0L;
  Package rulePkg=workingMemory.getRuleBase().getPackage(rule.getPackage());
  List<String> typeClassProps=getSettableProperties(workingMemory,classType,rulePkg);
  List<String> modifiedClassProps=getSettableProperties(workingMemory,modifiedClass,rulePkg);
  for (int i=0; i < modifiedClassProps.size(); i++) {
    if (BitMaskUtil.isPositionSet(originalMask,i)) {
      int posInType=typeClassProps.indexOf(modifiedClassProps.get(i));
      if (posInType >= 0) {
        modificationMask=BitMaskUtil.set(modificationMask,posInType);
      }
    }
  }
  classObjectType.storeTransformedMask(modifiedClass,originalMask,modificationMask);
  return this;
}
